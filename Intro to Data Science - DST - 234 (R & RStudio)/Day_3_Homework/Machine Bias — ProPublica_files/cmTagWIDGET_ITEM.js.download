!function(){var t={2707:function(t,e,i){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,s=void 0,s=function(t,e){if("object"!==n(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===n(s)?s:String(s)),r)}var o,s}var o=i(9453),s=i(1999),a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.opions=e}var e,i,n;return e=t,(i=[{key:"getPreset",value:function(t){var e=t.key,i=t.value,n=t.unitType,r=t.platform;if(o[e]&&o[e][i]){var a=o[e],l=o[e].strength||1,c=o[e].atr||{};return c=s.extend(c,a[i].atr),a[i]&&a[i].units&&(c=this._getFromUnits(c,a[i].units,n,r)||c),{presetData:c,strength:l}}}},{key:"_getFromUnits",value:function(t,e,i,n){if(e[i]){var r=e[i].atr||{};return t=s.extend(t,r),e[i].platform&&(t=this._getByPlatform(t,e[i].platform,n)||t),t}}},{key:"_getByPlatform",value:function(t,e,i){if(e[i]){var n=e[i].atr||{};return t=s.extend(t,n)}}}])&&r(e.prototype,i),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=a},2227:function(t){t.exports={strength:101,atr:{},1:{atr:{originId:15,"preroll.pubId":133128,"preroll.pubTagId":779408,"midroll.pubId":133128,"midroll.pubTagId":779408,"postroll.pubId":133128,"postroll.pubTagId":779408,pubId:133128,pubTagId:779408,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1,mntmbtwfs:999,mintimwf:999e3,mxtmbtwfs:999,time_between_waterfall:999,frrst1aftrrst93:!1,rmvrvlwntwrk:!1}},onOutOfView:"pause",isPWOV:!1,noaop:1}},2:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":779408,"midroll.pubId":133128,"midroll.pubTagId":779408,"postroll.pubId":133128,"postroll.pubTagId":779408,pubId:133128,pubTagId:779408,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause"}},3:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":1184655,"midroll.pubId":133128,"midroll.pubTagId":1184655,"postroll.pubId":133128,"postroll.pubTagId":1184655,pubId:133128,pubTagId:1184655,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},isPWOV:!1}},4:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":1046821,"midroll.pubId":133128,"midroll.pubTagId":1046821,"postroll.pubId":133128,"postroll.pubTagId":1046821,pubId:133128,pubTagId:1046821,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause"}},5:{atr:{originId:15,"preroll.pubId":133128,"preroll.pubTagId":1633025,"midroll.pubId":133128,"midroll.pubTagId":1633025,"postroll.pubId":133128,"postroll.pubTagId":1633025,pubId:133128,pubTagId:1633025,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause",isPWOV:!1}}}},5413:function(t){t.exports={strength:102,1:{atr:{player:{settings:{encwfrs:!1}}}}}},3365:function(t){t.exports={strength:101,atr:{},1:{atr:{pixels:{startWithABT:{isFire:!0},getAdAny:{isFire:!0},getAdNoRV:{isFire:!0},getAd:{isFire:!0},secondsToCloseTimer:{isFire:!0},secondsToCloseGlobalTimer:{isFire:!0},midrollCollapseTimer:{isFire:!0}}}},2:{atr:{pixels:{getAdAny:{isFire:!0},getAdNoRV:{isFire:!0},getAd:{isFire:!0}}}}}},5650:function(t){var e={atr:{},platform:{Desktop:{atr:{}},Mobile:{atr:{secondsBW:20}}}},i={strength:1,atr:{},101:{atr:{pubId:165757,pubTagId:946347,preroll:{pubId:165757,pubTagId:946347},midroll:{pubId:165757,pubTagId:946347},postroll:{pubId:165757,pubTagId:946347}}},2:{atr:{secondsToClose:120,secondsBW:20}},3:{atr:{secondsToClose:120,pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},units:{FEED_MANAGER:e,INLINE_INSTREAM_OLD:e,INLINE_INSTREAM_VFORCE:e,SLIDER_INSTREAM:e,SLIDER_OUTSTREAM:e,WIDGET_ITEM:e}},4:{atr:{pubId:292045,pubTagId:1565025,preroll:{pubId:292045,pubTagId:1565025},midroll:{pubId:292045,pubTagId:1565025},postroll:{pubId:292045,pubTagId:1565025}}},5:{atr:{pubId:383725,pubTagId:2077655,preroll:{pubId:383725,pubTagId:2077655},midroll:{pubId:383725,pubTagId:2077655},postroll:{pubId:383725,pubTagId:2077655}}}};t.exports=i},2290:function(t){t.exports={strength:101,1:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}}}}},2:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q0"}}},playerReady:{isActive:!1},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}},firstScroll:{isActive:!0,predictPoints:[0,0]}}}},3:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q0"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},4:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},5:{atr:{predictors:{multiAd:{isActive:!1},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},99:{atr:{predictors:{autoKill:{isActive:!1},getAdFail:{isActive:!1},multiAd:{isActive:!1},playerReady:{isActive:!1},distancePercent:{isActive:!1},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},101:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}}}}}}},9453:function(t,e,i){var n={};n.demo=i(2227),n.level=i(5650),n.isFireAllPixels=i(3365),n.predictorsPresets=i(2290),n.isDebug=i(5413),t.exports=n},3474:function(t){t.exports={"AR-EG":"إعلان","AR-AE":"إعلان","AR-SA":"إعلان","CS-CZ":"Reklama","DA-DK":"Annonce","DE-DE":"Anzeige","DE-AT":"Anzeige","DE-CH":"Anzeige","EL-GR":"Ad","EN-AE":"Ad","EN-AU":"Ad","EN-CA":"Ad","EN-GB":"Ad","EN-IE":"Ad","EN-IN":"Ad","EN-SG":"Ad","EN-PH":"Ad","EN-MY":"Ad","EN-NZ":"Ad","EN-US":"Ad","EN-ZA":"Ad","EN-XL":"Ad","ES-ES":"Publicidad","ES-AR":"Patrocinado","ES-CO":"Patrocinado","ES-CL":"Patrocinado","ES-PE":"Patrocinado","ES-MX":"Patrocinado","ES-US":"Patrocinado","ES-XL":"Patrocinado","ES-VE":"Patrocinado","EN-ID":"Ad","FI-FI":"Mainos","FR-FR":"Sponsorisé","FR-BE":"Sponsorisé","FR-CA":"Pub","FR-CH":"Sponsorisé","HE-IL":"מודעה","HI-IN":"एड","HU-HU":"Hird.","ID-ID":"Ad","IT-IT":"Ann.","JA-JP":"PR","KO-KR":"AD","NB-NO":"Annonse","NL-NL":"Adv","NL-BE":"Adv","PL-PL":"Reklama","PT-BR":"Publicidade","PT-PT":"Pub","RU-RU":"Реклама","SV-SE":"Annons","TH-TH":"Ad","TR-TR":"R","VI-VN":"Ad","ZH-CN":"广告 ","ZH-TW":"廣告","ZH-HK":"廣告"}},2130:function(t){t.exports={UNIT_TYPES:{INLINE:0,INTERSTITIAL:1,SLIDER_OUTSTREAM:2,SLIDER_INSTREAM:3,EXPANDABLE:4,"300X600":5,INLINE_FEED:6,COFFEEBREAK:7,SLIDESHOW:8,INLINE_INSTREAM:9,COFFEEBREAK_MOBILE:10,"300X600_MOBILE":11,INLINE_MOBILE:12,INTERSTITIAL_MOBILE:14,SLIDER_OUTSTREAM_MOBILE:15,SLIDER_INSTREAM_MOBILE:16,EXPANDABLE_MOBILE:17,INLINE_INSTREAM_MOBILE:18,INLINE_OUT_OF_VIEW:19,INLINE_OUT_OF_VIEW_MOBILE:20,INLINE_VIEWABILITY_EXPAND:21,INLINE_VIEWABILITY_EXPAND_MOBILE:22,INLINE_INSTREAM_VIEWABILITY_EXPAND:23,INLINE_INSTREAM_VIEWABILITY_EXPAND_MOBILE:24,INLINE_FEED_MOBILE:25,WIDGET_ITEM:26,WIDGET_ITEM_MOBILE:27,NEW_INLINE:28,NEW_INLINE_MOBILE:29,NEW_INLINE_ADJACENT:30,NEW_INLINE_ADJACENT_MOBILE:31,FEED_MANAGER:32,FEED_MANAGER_MOBILE:33,MSN_WIDGET:34,SLIDER_INSTREAM_VFORCE:36,SLIDER_INSTREAM_MOBILE_VFORCE:37},STREAM_TYPES:{IN_STREAM:1,OUT_STREAM:0},UNITS_STREAM_TYPE:{INLINE:0,INTERSTITIAL:0,SLIDER_OUTSTREAM:0,SLIDER_INSTREAM:1,EXPANDABLE:1,"300X600":1,OMNI_TAG:0},APPEND_TYPE:{BEFORE_BEGIN:0,AFTER_BEGIN:1,BEFORE_END:2,AFTER_END:3,APPEND_IN_FIRST:4},INVALID_SELECTOR_TAG_NAMES:{IMG:0,UL:1,BUTTON:3,INPUT:4,LABEL:5},OMNI_TAG_UNIT_NAMES:{rightrail1:1,rightrail2:2,rightrail3:3,inlineTop:4,inlineMiddle:5,inlineBottom:6,interstitial:7,sliderOutstream1:8,sliderOutstream2:9,sliderInstream1:10,sliderInstream2:11,coffeeBreak:12,expandable1:13,expandable2:14,expandable3:15,invalidUnitName:1e3},ROLL_TYPE:{preroll:0,"pre-roll":0,midroll:-1,"mid-roll":-1,postroll:-2,"post-roll":-2},TAB_STATE:{focus:0,blur:1,tabOut:2},DFP_KEYWORDS:["google","dfp","gpt"],MIME_TYPES:{1:"video/mp4",5:"video/webm",7:"video/ogg",10:"video/mp4",11:"video/ogg",12:"video/webm"},SUB_UNIT_TYPE:{PLAIN:0,START_FROM_SLIDER:1,DETACH_TO_SLIDER:2,SUPER_SLIDER:3,INLINE_SINGLE_SELECTOR:4,INLINE_MULTI_SELECTOR:5,STICKY_BELOW:6,STICKY_ABOVE:7,STICKY_BELOW_ABOVE:8,WIDGET:9,MID_ARTICLE_AS_FEED:10},FEED_SELECTOR:"tbl-feed-container",RECO_REEL_SUB_UNIT_TYPE:{PLAIN:0,START_FROM_SLIDER_RBOX:1,DETACH_TO_SLIDER_RBOX:2},AD_CHOICE_TYPE:{TITLE:"title",VIDEO_AD:"videoAd",SLIDER:"slider"},REPLAY_AD_CLICK:{ALL:"all",RESTART_PLAYER:"restartPlayer"},DISPLAY_FILLER:{BEFORE_AD:{NONE:"none",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"},BETWEEN_ADS:{LOADING:"loading",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"},ON_TIMEOUT:{CLOSE:"close",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"}},TITLE_POSITION:{ABOVE:"above",BELOW:"below"},DEBUG_DATA:{pn:"pn",sqg:"sqg",sqv:"sqv",rv:"rv",sqp:"sqp",rvps:"rvps",rvvs:"rvvs",pps:"pps",ppsc:"ppsc",vms:"vms",gpps:"gpps",gppsc:"gppsc",ft:"ft",fsc:"fsc",fpc:"fpc",sa:"sa",pi:"pi",dt:"dt",vb:"vb",dur:"dur",ttv:"ttv",bovpg:"bovpg",bovpv:"bovpv",be:"be",pap:"pap",mty:"mty",esv:"esv",rot:"rot",roid:"roid",rom:"rom",tti:"tti"},DEBUG_DATA_PIXELS:{ft:"ft",fsc:"fsc",fpc:"fpc"},PREDICT_NAMES:{distancePercentPredict:0,distancePixelsPredict:1,getAdFailPredict:2,multiAdPredict:4,playerReadyPredict:5,autoKillPredict:7,firstScrollPredict:8,emptyQueuePredict:9,intersectionPredict:11,fullEligibilityPredict:12,mp4Predict:17,timePredict:19,msnFullEligibilityPredict:23,feedInViewPredict:24,recoReelPredict:25,postRepeatPredictor:26,adxPredict:27},ANIMATION_TYPE:{none:0,attaching:1,detaching:2,expanding:3,collapsing:4},ANIMATION_TIMER:{none:0,sliderClose:1e3},FLOATING_VIEW_TOP_COMPONENT:{video:0,loading:1,repeat:2,d2d:3,content:4},FRAME_TYPE:{plainPage:0,friendlyIframe:1,nonFriendlyIframe:2,amp:3,inApp:4},CHECK_FOR_RV_PRIORITY:{onEligibility:"hasReachedEligibility",pixelsFromSelector:"hasReachedPixelsFromSelector",intersectionPercent:"intersectionPercent",beforeLoaderEnd:"beforeLoaderEnd"},TIMER_NAMES:{viewability:"viewability",viewabilityOneS:"viewabilityOneS",viewability100:"viewability100",viewabilityAMP:"viewabilityAMP"},AD_STATUS:{new:0,adLoaded:1,startAd:2,adImpression:3,adPlay:4,adError:5,adComplete:6},GENERAL_ERROR:{1:"empty data from player"},CSS_PROPERTIES_FROM_RBOX:["font","@font-face","font-family","font-feature-settings","@font-feature-values","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","line-break","line-height","outline","outline-color","outline-offset","outline-style","outline-width","text-decoration-line","text-underline-position","padding","padding-bottom","padding-left","padding-right","padding-top","margin","margin-bottom","margin-left","margin-right","margin-top","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","text-transform","z-index","text-align","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-indent","text-justify","text-orientation","text-overflow","text-shadow","text-transform","text-underline-position","direction","color"],NATIVE_AD:{DESC_TITLE_FONT_RATIO:.8,FIT_TO_SIZE:{TITLE:"title",FULL:"full",NONE:"none"}},UNIT_QUERY_LANGUAGE:{SUPPORTED_CONFIG_FLAGS:["stickyCard"],MAPPING:[{search:"@Ad@",replaceWith:"activeAd"}]},ITEM_TYPE:{IMA:27},ADX:{ADVERTISER:"66216755",ITEM_TYPE:27,ADVTYPE:7},RV_TYPES:{NON_RV:0,RV:1,ANY:"any"},MEDIA_TYPE:{MP4:1,VPAID:2,ADX:5},MEDIA_TYPE_ID_TO_NAME:{1:"video",2:"vpaid",6:"omid"},VIDEO_READY_STATE:{HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},TRC_PERFORMANCE_ACTIONS:{START:"Start",STOP:"Stop"},OS:{IOS:"iOS"},BROWSER:{IE:"IE",EDGE:"Edge",FIREFOX:"Firefox"},WF_ACTION:{START:"start",STOP:"stop"},TIME_UNITS:{SECOND:1e3,HALF_MINUTE:3e4},MINUTELY_AD_STATUS:{PLAY:"play",CLOSE:"close"},DEFAULT_TIME_LIMITS:{REPEAT_SLIDER_TIMER_SECS:5e3},CANCEL_GET_AD_REASONS:{LOST_ELIGIBILITY:"cancelGetAdOnLostEligibility"},ARROW_KEYS_CODES:{LEFT:37,UP:38,RIGHT:39,DOWN:40},INSERT_OPTIONS:{BEFORE:"before",AFTER:"after"},PAUSE_REASONS:{UNKNOWN:"unknown",LOST_ELIGIBILITY:"lost eligibility",BLOCKED_BY_EXTERNAL_UNIT:"blocked by external unit",AD_SWAPPED:"ad swapped",UNIT_TERMINATED:"unit terminated",SLIDER_LOST_ELIGIBILITY:"slider lost eligibility",PERMANENT_CLOSE:"permanent close"},EXC_REASONS:{PUBVIDEO:"publisher video detection",DETACH_TO_SLIDER:"not attached to selector"},ADS_QUEUE_STATUS:{CHECKED:"checked",RV1_HUNT:"rv1Hunt"}}},5264:function(t){t.exports={player:void 0,oppsula:void 0,pms:void 0,serviceLoader:void 0,microServices:{base_url:"//vidstat.taboola.com/",async:!0,PMS:{version:"2.2.1"}}}},2167:function(t,e,i){var n=i(1999);function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,s=void 0,s=function(t,e){if("object"!==r(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===r(s)?s:String(s)),n)}var o,s}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.model=e.model,this.subModel=e.subModel?e.subModel:null,this.observerOptions={root:null,rootMargin:"0px",threshold:n.buildObserverThresholdList()},this.model.get("detachToSlider.isStartFromSlider")?this._createSliderObserver():this._createFeedObserver()}var e,i,r;return e=t,(i=[{key:"_createSliderObserver",value:function(){this.intersectionObserver=new IntersectionObserver(function(t){var e=this;t.map((function(t){e.updateModel("isViewableAMP",t.intersectionRect.height+5>=e.model.get("detachToSlider.height"))}))}.bind(this),this.observerOptions)}},{key:"_createFeedObserver",value:function(){this.intersectionObserver=new IntersectionObserver(function(t){var e=this;t.map((function(t){e.updateModel("isViewableAMP",t.intersectionRatio>.5)}))}.bind(this),this.observerOptions)}},{key:"startObserver",value:function(t){this.updateModel("isViewableAMP",!1),this.intersectionObserver.observe(t)}},{key:"stopObserver",value:function(t){this.intersectionObserver.unobserve(t),this.intersectionObserver.disconnect()}},{key:"updateModel",value:function(t,e){null!=this.subModel&&this.subModel.set(t,e),this.model.set(t,e)}}])&&o(e.prototype,i),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=s},5422:function(t){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function i(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,s=void 0,s=function(t,i){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,i||"default");if("object"!==e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(t)}(o,"string"),"symbol"===e(s)?s:String(s)),r)}var o,s}var n=null,r=function(t){return/\{\s*\[native code\]\s*\}/.test(""+t)},o=function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n||(n=this),n}var e,o,s;return e=t,(o=[{key:"set",value:function(t,e,i){r(window[t])&&r(window[t].prototype[e])||(this.iframe||this.createIframe(),this.iframe.contentWindow[t].prototype[e]&&(window[t].prototype||(window[t]=function(){}),window[t].prototype[e]=this.iframe.contentWindow[t].prototype[e],i&&(window[t]=this.iframe.contentWindow[t])))}},{key:"setWindowFunctions",value:function(t){t&&(this.iframe||this.createIframe(),t.split(",").forEach(function(t){var e=t.split(".");this.setWindowNestedFunctions(window,e)}.bind(this)))}},{key:"createIframe",value:function(){this.iframe=document.createElement("iframe"),this.iframe.style.width=0,this.iframe.style.height=0,this.iframe.style.visibility="hidden",this.iframe.style.display="none",document.body.appendChild(this.iframe)}},{key:"setWindowNestedFunctions",value:function(t,e){var i=e.shift();0==e.length?t[i]=this.iframe.contentWindow[i]:this.setWindowNestedFunctions(t[i],e)}}])&&i(e.prototype,o),s&&i(e,s),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=new o},9006:function(t){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function i(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,s=void 0,s=function(t,i){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,i||"default");if("object"!==e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(t)}(o,"string"),"symbol"===e(s)?s:String(s)),r)}var o,s}var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.arrayFrom()}var e,n,r;return e=t,n=[{key:"arrayFrom",value:function(){var t,e,i,n;Array.from||(Array.from=(t=Object.prototype.toString,e=function(e){return"function"==typeof e||"[object Function]"===t.call(e)},i=Math.pow(2,53)-1,n=function(t){var e=function(t){var e=Number(t);return isNaN(e)?0:0!==e&&isFinite(e)?(e>0?1:-1)*Math.floor(Math.abs(e)):e}(t);return Math.min(Math.max(e,0),i)},function(t){var i=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var r,o=arguments.length>1?arguments[1]:void 0;if(void 0!==o){if(!e(o))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(r=arguments[2])}for(var s,a=n(i.length),l=e(this)?Object(new this(a)):new Array(a),c=0;c<a;)s=i[c],l[c]=o?void 0===r?o(s,c):o.call(r,s,c):s,c+=1;return l.length=a,l}))}}],n&&i(e.prototype,n),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=n},3629:function(t,e,i){var n=i(1999),r=i(2130),o=i(5422),s=i(9006),a=function(t){n.trcPerformanceMeasurement(t.trcPerformanceMeasurementEnabled,"videoBeforeCMTagNativeCode",r.TRC_PERFORMANCE_ACTIONS.START),o.set("Function","bind"),o.set("Event","constructor",!0),o.set("Array","forEach",!1),o.set("Array","every",!1),o.setWindowFunctions(t.nativeFunctions),n.trcPerformanceMeasurement(t.trcPerformanceMeasurementEnabled,"videoBeforeCMTagNativeCode",r.TRC_PERFORMANCE_ACTIONS.STOP),new s,window.cmTag.customDataForTest={startWithABT:!1},!!t.gaFactor&&n.isFactor(parseInt(t.gaFactor))&&window.addEventListener("error",(function(e){try{if(-1==e.filename.indexOf("infra/cmTag"))return;var i={timestamp:(new Date).toISOString(),message:e.message,lineNum:e.lineno,fullUrl:window.location.href,userAgent:window.navigator.userAgent,firedStartWithABT:window.cmTag.customDataForTest.startWithABT,unitType:t.unitType};e.error&&(i.callStack=e.error.stack);var n=new XMLHttpRequest;n.open("POST","//vidanalytics.taboola.com/putes/cm_units_error_logs",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded");var r=JSON.stringify(i);n.send(r)}catch(e){}}))};t.exports=a},7904:function(t,e,i){t.exports={beforeCMTag:i(3629)}},5545:function(t,e,i){"use strict";i.d(e,{Z:function(){return s}});var n=i(4187);function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,s=void 0,s=function(t,e){if("object"!==r(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===r(s)?s:String(s)),n)}var o,s}var s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.unitType,r=e.className,o=e.version,s=e.isDebug,a=void 0===s||s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.unitType=i,this.className=r,this.version=o,this.isDebug=a,this._logger=n.Z.getInstance({isDebug:this.isDebug,version:this.version})}var e,i,r;return e=t,(i=[{key:"info",value:function(t,e){this._logger.info("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(t),e)}},{key:"success",value:function(t,e){this._logger.success("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(t),e)}},{key:"important",value:function(t,e){this._logger.important("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(t),e)}},{key:"warning",value:function(t,e){this._logger.warning("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(t),e)}},{key:"pixel",value:function(t,e){this._logger.pixel("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(t),e)}},{key:"debug",value:function(t,e){this.isDebug&&this._logger.debug("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(t),e)}},{key:"error",value:function(t,e){this.isDebug&&this._logger.error("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(t),e)}},{key:"predict",value:function(t){this._logger.predict("unit type: ".concat(this.unitType,", predictor: ").concat(this.className,", predictlog: ").concat(t))}}])&&o(e.prototype,i),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()},4187:function(t,e,i){"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e,i){return r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct.bind():function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&o(r,i.prototype),r},r.apply(null,arguments)}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,s=void 0,s=function(t,e){if("object"!==n(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===n(s)?s:String(s)),r)}var o,s}i.d(e,{Z:function(){return g}});var a=function(){function t(){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"instance"in this.constructor)throw new Error("Cannot instantiate more than one '".concat(this.constructor.name,"'"));if("Singleton"==this.constructor.name)throw new Error("Cannot instantiate abstract class 'Singleton'");this.constructor.instance=this}var e,i,n;return e=t,n=[{key:"getInstance",value:function(){return"instance"in this||this.create.apply(this,arguments),this.instance}},{key:"create",value:function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return r(t,i)}}],(i=null)&&s(e.prototype,i),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),l=i(9057);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function u(t,e,i){return u=p()?Reflect.construct.bind():function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&h(r,i.prototype),r},u.apply(null,arguments)}function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==c(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===c(o)?o:String(o)),n)}var r,o}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function f(t){var e=p();return function(){var i,n=m(t);if(e){var r=m(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}var y=i(1999),g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(o,t);var e,i,n,r=f(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.addTrace,n=void 0!==i&&i,s=e.isDebug,a=void 0!==s&&s,l=e.isConsole,c=void 0===l?a:l,u=e.isSaveLog,d=void 0===u?a:u,h=e.extraLogGA,f=void 0!==h&&h,p=(e.version,e.isGA);return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).addTrace=n,t.isDebug=y.parseBool(a),t.isConsole=y.parseBool(c),t.isSaveLog=y.parseBool(d),t.isGA=y.parseBool(p),t.extraLogGA=f,t.dataIndexName="units_debug_logs",t.isDebug&&(window.cmLogs=window.cmLogs||[]),t.initModel={},t}return e=o,n=[{key:"create",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return u(o,e)}}],(i=[{key:"pushLog",value:function(t,e){this.isDebug&&this._hasConsoleMethod("log")&&(window.cmLogs.push({ts:(new Date).getTime(),message:t,obj:e}),"cmTag: init"===t&&(this.initModel=e,console.log("cmTag: init obj:",JSON.stringify(e)),this.sessionID=this.getUniqSessionId(),this.showSessionID()))}},{key:"info",value:function(t,e){this.isDebug&&this._hasConsoleMethod("info")&&(console.info("cmTag: ".concat(t),e),this.pushLog("cmTag: ".concat(t),e),this.addTrace&&this._hasConsoleMethod("trace")&&console.trace())}},{key:"debug",value:function(t,e){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(t),"color: RoyalBlue",e),this.pushLog("cmTag: ".concat(t),e))}},{key:"error",value:function(t,e){this._hasConsoleMethod("error")&&(console.error("cmTag: ".concat(t),e),this.pushLog("cmTag: ".concat(t),e))}},{key:"ga",value:function(t,e,i){return this.extraLogGA&&this.info("GA extra log",{unitType:t,action:e,version:i}),this._ga.send(t,e,i)}},{key:"success",value:function(t,e){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(t),"color: green",e),this.pushLog("cmTag: ".concat(t),e))}},{key:"important",value:function(t,e){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(t),"color: purple",e),this.pushLog("cmTag: ".concat(t),e))}},{key:"warning",value:function(t,e){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(t),"color: orange",e),this.pushLog("cmTag: ".concat(t),e))}},{key:"pixel",value:function(t,e){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(t),"color: #00A0B2",e),this.pushLog("cmTag: ".concat(t),e))}},{key:"sendToServer",value:function(t,e){var i="no data";try{var n=JSON.stringify(e);e&&(i=n)}catch(t){}var r="".concat(this.initModel["player.settings.kbnul"],"/putes/").concat(this.dataIndexName);l.default.ajax({type:"POST",url:r,data:JSON.stringify({message:t,dataObject:i,timestamp:(new Date).toISOString(),sessionID:this.sessionID}),contentType:"text/plain"})}},{key:"getUniqSessionId",value:function(){return"".concat(this.getRandomNumber()).concat(this.getRandomNumber()).concat(this.getRandomNumber())}},{key:"showSessionID",value:function(){var t=document.createElement("div");t.setAttribute("id","_cm-session-id-div"),t.setAttribute("style","background: black; color: wheat; position: fixed; top: 0; left: 0;z-index:999999999");var e=document.createTextNode("SessionID: ".concat(this.sessionID)),i=document.createElement("button");i.innerHTML="X",i.addEventListener("click",(function(){document.querySelector("#_cm-session-id-div").remove()})),t.appendChild(e),t.appendChild(i),document.querySelector("body").appendChild(t)}},{key:"getRandomNumber",value:function(){return Math.floor(10*Math.random())}},{key:"_hasConsoleMethod",value:function(t){return console&&console[t]&&"function"==typeof console[t]}},{key:"predict",value:function(t){this.info("%c ".concat(t),"color: #bada55")}}])&&d(e.prototype,i),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(a)},9245:function(t,e,i){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,s=void 0,s=function(t,e){if("object"!==n(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===n(s)?s:String(s)),r)}var o,s}var o=i(9288),s=i(1999),a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.callBacks={},this.model=e,this._mapCallbackNames(),this._setCallbacks()}var e,i,n;return e=t,(i=[{key:"_setCallbacks",value:function(){this._isValidCallback(this.callbackNames.conversion)&&(this.callBacks.onConversion=this._getCallbackFromModel("onConversion"),o.on("global:creativeEvent",this._onGlobalCreativeEvent.bind(this,this.callbackNames.conversion))),this._isValidCallback(this.callbackNames.fill)&&(this.callBacks.onFilledImpression=this._getCallbackFromModel("onFilledImpression"),o.on("filledImpression",this._onGlobalCreativeEvent.bind(this,this.callbackNames.fill))),this._isValidCallback(this.callbackNames.impression)&&(this.callBacks.onImpression=this._getCallbackFromModel("onImpression"),o.on("onImpression",this._onGlobalCreativeEvent.bind(this,this.callbackNames.impression))),this._isValidCallback(this.callbackNames.play)&&(this.callBacks.onPlay=this._getCallbackFromModel("onPlay"),o.on("global:adState:playing",this._onGlobalCreativeEvent.bind(this,this.callbackNames.play))),this._isValidCallback(this.callbackNames.terminate)&&(this.callBacks.onTerminate=this._getCallbackFromModel("onTerminate"),o.once("global:closeState:changed",this._onGlobalCreativeEvent.bind(this,this.callbackNames.terminate))),this._isValidCallback(this.callbackNames.passback)&&(this.callBacks.onPassback=this._getCallbackFromModel("onPassback"),o.once("global:passback",this._onGlobalCreativeEvent.bind(this,this.callbackNames.passback)))}},{key:"_getCallbackFromModel",value:function(t){return this.model[t]||this.model.get(t)}},{key:"_onGlobalCreativeEvent",value:function(t,e){t=t||{},this.callBacks[t.type]&&this.callBacks[t.type](e),t.name&&s.dispatchTRC("api::video."+t.name,this.model)}},{key:"_isValidCallback",value:function(t){var e=this._getCallbackFromModel(t.type);if("string"==typeof e){var i=this._getCallbackFunction(e);e=new Function("additionalData",i),delete this.model[t.type],delete this.model.attributes[t.type],Object.defineProperty(this.model,t.type,{value:e})}return!(!s.isFunction(e)&&!this._isApiCallbackExist(t.name))}},{key:"_getCallbackFunction",value:function(t){var e=t.substr(t.indexOf("{")+1);return e.substr(0,e.lastIndexOf("}"))}},{key:"_isApiCallbackExist",value:function(t){if(TRC&&TRC._taboolaClone)for(var e=0;e<TRC._taboolaClone.length;e++)if(TRC._taboolaClone[e].listenTo=="video."+t)return!0;return!1}},{key:"_mapCallbackNames",value:function(){this.callbackNames={conversion:{type:"onConversion",name:"conversion"},fill:{type:"onFilledImpression",name:"fill"},impression:{type:"onImpression",name:"impression"},play:{type:"onPlay",name:"play"},terminate:{type:"onTerminate",name:"terminate"},passback:{type:"onPassback",name:"passback"}}}}])&&r(e.prototype,i),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=a},9791:function(t,e,i){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,s=void 0,s=function(t,e){if("object"!==n(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===n(s)?s:String(s)),r)}var o,s}var o=i(1999),s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,n;return e=t,(i=[{key:"addUnit",value:function(t,e){o.isEmpty(window.TRC.videoUnitList)&&(window.TRC.videoUnitList={}),this.unitsList=window.TRC.videoUnitList||{},this.unitsList[t]=e,window.TRC.videoUnitList=this.unitsList,this._listenUnitsEvents(t)}},{key:"_listenUnitsEvents",value:function(t){this.unitsList[t].on("change:isUnitEligible",this._onUnitEligibilityChange.bind(this,t))}},{key:"_onUnitEligibilityChange",value:function(t,e,i){o.size(this.unitsList)>1&&(!0===i||!1===i)&&this._decidePlayOrPause()}},{key:"_decidePlayOrPause",value:function(){var t=this,e=[];o.each(this.unitsList,(function(i){var n=i.get("redId"),r="CUSTOM"==t._getUnitType(n);t._isUnitEligibleToPlay(n)?e.push({redId:n,viewPercent:i.get("unitViewablePercent"),isCustomVideo:r}):r&&t._pauseUnit(n)})),e.length>0&&(e=this._sortViewableUnits(e),o.each(e,(function(e,i){0===i?t._playUnit(e.redId):e.isCustomVideo&&t._pauseUnit(e.redId)})))}},{key:"_sortViewableUnits",value:function(t){return t.sort((function(t,e){return t.isCustomVideo===e.isCustomVideo?e.viewPercent-t.viewPercent:!t.isCustomVideo&&e.isCustomVideo?-1:1}))}},{key:"_pauseUnit",value:function(t){this.unitsList[t].set("multiUnitManager.state","pause")}},{key:"_playUnit",value:function(t){this.unitsList[t].set("multiUnitManager.state","play")}},{key:"_isUnitEligibleToPlay",value:function(t){return this.unitsList[t].get("isEligibleToPlay")||this.unitsList[t].get("isUnitEligible")||this.unitsList[t].get("isUnitViewable")}},{key:"_isUnitAllowToPlay",value:function(t){return"pause"!=this.unitsList[t].get("multiUnitManager.state")&&this._isUnitEligibleToPlay(t)}},{key:"_isUnitPlaying",value:function(t){return this.unitsList[t].get("generalPlayingUnitState")}},{key:"_getUnitType",value:function(t){return this.unitsList[t].get("unitType")}}])&&r(e.prototype,i),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();cmTag.multiUnitManager=cmTag.multiUnitManager||new s,t.exports=cmTag.multiUnitManager},2384:function(t){t.exports={JP:!0}},9831:function(t){t.exports={readyState:"ready",adManagerState:{empty:"empty",hasAds:"hasAds",stopped:"stopped",paused:"paused"},adState:{failed:"failed",playing:"playing",paused:"paused",continueAd:"continueAd",completed:"completed",autoKill:"autoKill",repeating:"repeating",skipped:"skipped"},adQState:{impression:"impression",q0:"q0",q1:"q1",q2:"q2",q3:"q3",completed:"completed",repeating:"repeating"},getAdState:{notCalled:"notCalled",gettingAd:"gettingAd",gotAd:"gotAd",waiting:"waiting",failed:"failed",stopped:"stopped",finished:"finished"},playerState:{error:"error",stopped:"stopped",closed:"closed",restarted:"restarted"},containerViewState:{rendered:"rendered",eligible:"eligible",playing:"playing",collapsed:"collapsed",attached:"attached",detached:"detached"},videoViewState:{rendered:"rendered",attached:"attached",detached:"detached"},repeatState:{hiding:"hiding",showing:"showing",spinning:"spinning",clicked:"clicked"},loadingViewState:{hiding:"hiding",showing:"showing",clicked:"clicked"},clickThruState:{clicked:"clicked",waiting:"waiting"},timerState:{working:"started",paused:"paused",stopped:"stopped",done:"done"},closeState:{terminate:"terminate",containerViewClosed:"containerViewClosed",videoViewClosed:"videoViewClosed",adManagerStop:"adManagerStop",playerClosed:"playerClosed"},tabState:{focus:"focus",blur:"blur",tabOut:"tabOut"},floatingView:{detach:"detach",attach:"attach",postAttach:"postAttach",permanentClosed:"permanentClosed"},externalUnit:{playing:"playing",stopped:"stopped"},brandingDisplayState:{show:"show",hide:"hide"},storiesUnitState:{videoImpression:"videoImpression",videoPause:"videoPause",videoResume:"videoResume",videoEnd:"videoEnd",videoViewable:"videoViewable"},storiesRboxState:{onVideoCardDisplayed:"onVideoCardDisplayed",categoriesHidden:"categoriesHidden",categoriesDisplay:"categoriesDisplay",videoSkipped:"videoSkipped"}}},9861:function(t,e,i){"use strict";i.r(e);var n=i(2130),r=i.n(n),o=i(9057),s=i(5545);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t,e,i){return(e=function(t){var e=function(t,e){if("object"!==a(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===a(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var u,d=i(1999),h=null,f=d.flatten;d.mixin({setConfig:function(t){h=t,u=new s.Z({unitType:h.unitType,className:"utils",version:h.version,isDebug:h.isDebug})},parseBool:function(t){return"true"===t||!0===t||1===t||"1"===t},el:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement(t);for(var n in e)null!=e[n]&&(i[n]=e[n]);return i},loadJs:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return document.head.appendChild(d.el("script",function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){c(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({src:t,onload:e,async:!0},i)))},loadCss:function(t,e){return document.head.appendChild(d.el("link",{href:t,onload:e,rel:"stylesheet",type:"text/css"}))},loadJsArr:function(t,e){var i;e&&(i=t.length);for(var n=0;n<t.length;n++)t[n].indexOf(".css")>-1?d.loadCss(t[n],r):d.loadJs(t[n],r);function r(){0===--i&&d.defer(e.bind(this))}},getUrlVars:function(t){for(var e,i=[],n=(t=t||window).location.href.slice(t.location.href.indexOf("?")+1).split("&"),r=0;r<n.length;r++)e=n[r].split("="),i.push(e[0]),i[e[0]]=e[1];return i},firePixelConditional:function(t,e,i,n){t&&d.firePixel(e,i,n)},firePixel:function(t,e,i){t&&(i&&(t=d.addParametersToUrl(t,i,-1===t.indexOf("?"))),d.log("pixel","firing pixel: "+e+" url: "+t),document.createElement("IMG").src=t)},fireIframePixel:function(t,e){if(t){d.log("pixel","firing pixel: "+e+" url: "+t);var i=document.createElement("iframe");i.src=t,i.style.display="none";var n=document.getElementsByTagName("body")[0];n||(n=document.getElementsByTagName("html")[0]),n||(n=document.getElementsByTagName("div")[0]),n?n.appendChild(i):d.log("debug","fireIframePixel - Failed to fire iframe pixel.")}else d.log("pixel","fireIframePixel","Url empty.")},getViewabilityPercent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.offsetHeight,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.offsetWidth,n=t.getBoundingClientRect(),r=Math.max(0,n.top),o=Math.min(d.viewport().height,n.bottom),s=Math.max(0,n.left);return 100*(o-r)*(Math.min(d.viewport().width,n.right)-s)/(e*i)},isVisible:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.offsetHeight,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.offsetWidth,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;return d.getViewabilityPercent(t,e,i)>=n},viewport:function(){return{get height(){return d.viewport().object.document.documentElement.clientHeight},get width(){return d.viewport().object.document.documentElement.clientWidth},get object(){return top}}},getVideoHeight:function(t){var e=parseInt(9/16*t);return isNaN(e)?0:e},getVideoWidth:function(t){var e=parseInt(16/9*t);return isNaN(e)?0:e},getVideoBestSize:function(t,e){var i=this.getVideoHeight(t);return e>=i?e=i:t=this.getVideoWidth(e),{width:t,height:e}},getVideoHeightByRatio:function(t,e){var i=parseInt(1/e*t);return isNaN(i)?0:i},getVideoWidthByRatio:function(t,e){var i=parseInt(e*t);return isNaN(i)?0:i},isElementInHead:function(t){if(!t)return!1;for(;t!==document.body&&t!==document.head;)t=t.parentNode;return t===document.head},getViewPercent:function(t,e,i,n,r){var s,a=d.isEmpty(n)?(0,o.default)(this.getTopWindow()):(0,o.default)(n);s=window.taboolaBridge&&window.taboolaBridge.active?this.calcViewportPositionInApp(n):{top:0,left:0,right:a.width(),bottom:a.height()};var l=Number(i)||0,c=Number(e)||0,u=r?t.getClientRects()[0]:t.getBoundingClientRect(),h={top:u.top,left:u.left};if(h.right=h.left+c,h.bottom=h.top+l,s.right<h.left||s.left>h.right||s.bottom<h.top||s.top>h.bottom)return 0;var f=Math.min(1,(h.bottom-s.top)/l),p=Math.min(1,(s.bottom-h.top)/l);return Math.min(1,(h.right-s.left)/c)*Math.min(1,(s.right-h.left)/c)*f*p*100},isViewable:function(t,e,i,n){var r=d.getViewPercent(t,e,i);return!(r<=0)&&r>=(n=n||100)},getViewPercentageDeltas:function(t,e,i){var n=(0,o.default)(window),r={top:n.scrollTop(),left:n.scrollLeft()};r.right=r.left+n.width(),r.bottom=r.top+n.height();var s=Number(i)||0,a=Number(e)||0,l=(0,o.default)(t).offset();return l.right=l.left+a,l.bottom=l.top+s,{top:Math.min(1,(l.bottom-r.top)/s),bottom:Math.min(1,(r.bottom-l.top)/s),left:Math.min(1,(l.right-r.left)/a),right:Math.min(1,(r.right-l.left)/a)}},getValidSelectorElements:function(t,e,i){var n=[];return e=e||100,i=i||0,t&&d.isArray(t)&&(n=d.filter(t,(function(t){var n=t.getBoundingClientRect();return n.width>=e&&n.height>=i&&!d.has(r().INVALID_SELECTOR_TAG_NAMES,t.tagName)}))),n},filterObject:function(t,e){if(t){for(var i={},n=0;n<e.length;n++){var r=t[e[n]];void 0!==r&&(i[e[n]]=r)}return i}},assignWithoutUndefinedValues:function(t,e){for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t},stripObject:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;if(t){var s={};for(var a in t)if(!(a in e)){var l=t[a];n&&d.isElement(l)||i&&d.isFunction(l)||(r&&!d.isFunction(l)&&d.isObject(l)&&(l=o>0?this.stripObject(l,[],i,n,r,o--):"{stripElements} - value is Object, but max depth reached."),s[a]=l)}return s}},arrayToObj:function(t){if(t){for(var e={},i=0;i<t.length;i++)void 0!==t[i]&&(e[i]=t[i]);return e}},getTopOfEl:function(t){if(t){var e=t,i=0;if(document.getElementById||document.all)do{for(t.offsetLeft-t.scrollLeft,i+=t.offsetTop-t.scrollTop,t=t.offsetParent,e=d.getParentNode(e);e!=t;)e.scrollLeft,i-=e.scrollTop,e=d.getParentNode(e)}while(t&&t.offsetParent);else document.layers&&(i+=t.y,t.x);return i}},getParentNode:function(t){return t.parentNode&&t.parentNode.host?t.parentNode.host:t.parentNode},getLeftOfEl:function(t){return window.pageXOffset+t.getBoundingClientRect().left},PrefixedEvent:function(t,e,i,n){i=i.toLowerCase(),d.each(["webkit","moz","MS","o",""],(function(r){t[e](r+i,n)}))},oneAnimationEnd:function(t,e){var i=d.debounce(e,200);this.PrefixedEvent(t,"one","transitionend",i),this.PrefixedEvent(t,"one","animationend",i)},addParametersToUrl:function(t,e,i){var n=t;return n+=i?"?":"&",o.default.each(e,(function(t,e){void 0!==e&&""!==e&&(n+=t+"="+e+"&")})),n},skipTransitionCss:function(t,e){t.addClass("none-transition"),t.css(e),this.flushCss(t[0]),t.removeClass("none-transition")},flushCss:function(t){t.offsetHeight},getTopWindow:function(){var t=window;try{for(;t.document!==t.top.document;)t=t.top;return t}catch(t){return window}},isInIframe:function(t){return!!t&&(t.inIframe||t.inDFP)},isInFriendlyIframe:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cmTag.config.iframeData;return!!t&&(this.isInIframe(t)&&t.isFriendlyIframe)},hideDFPIframe:function(t){if(this.isInFriendlyIframe(t)){t.iframe.style.display="none";for(var e=t.iframe.parentNode;d.some(r().DFP_KEYWORDS,(function(t){return-1!==e.id.indexOf(t)}));)e.style.display="none",e=e.parentNode}},onceDocReady:function(t){return/complete|loaded|interactive/.test(document.readyState)&&document.body?t():(0,o.default)("document").one("DOMContentLoaded",t),this},crc32:function(t){if(!t||"string"!=typeof t)return 0;var e;void 0===e&&(e=0);var i=0;e^=-1;for(var n=0,r=(t=this.utf8Encode(t)).length;n<r;n++)i=255&(e^t.charCodeAt(n)),e=e>>>8^"0x"+"00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".substr(9*i,8);return-1^e},utf8Encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var n=t.charCodeAt(i);n<128?e+=String.fromCharCode(n):n>127&&n<2048?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e},isMouseOver:function(t){return 0!==t.filter(":hover").length},rollNumbers:function(t){return!!t&&100*Math.random()<t},isFactor:function(t){return d.isNumber(t)&&t===d.random(1,t)},sendMail:function(t,e,i){function n(){emailjs.init("user_kHlYxxusLRTxC6yr3PjQl"),emailjs.send("gmail","units_support",t).then(e,i)}e=e||function(){},i=i||function(){},window.emailjs?n():d.loadJs("//cdn.emailjs.com/dist/email.min.js",n)},isValidEmail:function(t){return!0},toCssObj:function(t){return"string"==typeof t?JSON.parse(t):t},isLayerVisible:function(t){function e(t,e){return window.getComputedStyle?document.defaultView.getComputedStyle(t,null)[e]:t.currentStyle?t.currentStyle[e]:void 0}return function t(i,n,r,o,s,a,l){var c=i.parentNode;return!!function(t){for(;t=t.parentNode;)if(t===document)return!0;return!1}(i)&&(9===c.nodeType||"0"!==e(i,"opacity")&&"none"!==e(i,"display")&&"hidden"!==e(i,"visibility")&&(void 0!==n&&void 0!==r&&void 0!==o&&void 0!==s&&void 0!==a&&void 0!==l||(n=i.offsetTop,s=i.offsetLeft,o=n+i.offsetHeight,r=s+i.offsetWidth,a=i.offsetWidth,l=i.offsetHeight),!c||("hidden"!==e(c,"overflow")&&"scroll"!==e(c,"overflow")||!(s+2>c.offsetWidth+c.scrollLeft||s+a-2<c.scrollLeft||n+2>c.offsetHeight+c.scrollTop||n+l-2<c.scrollTop))&&(i.offsetParent===c&&(s+=c.offsetLeft,n+=c.offsetTop),t(c,n,r,o,s,a,l))))}(t)},getOffset:function(t,e){if(t&&Array.isArray(t)&&t[0]&&(t=t[0]),t){if(1===e)return(0,o.default)(t).offset();var i=t,n=t,r=0,s=0;if(document.getElementById||document.all)do{for(s+=t.offsetLeft-t.scrollLeft,r+=t.offsetTop-t.scrollTop,t=t.offsetParent,n=d.getParentNode(n);n&&n!=t;)s-=n.scrollLeft,r-=n.scrollTop,n=d.getParentNode(n)}while(t&&t.offsetParent);else document.layers&&(r+=t.y,s+=t.x);return{top:r,left:(0,o.default)(i).offset().left||s}}},flatten:function(t){var e={};for(var i in t)e[i]=t[i];return e},cssObjToString:function(t){var e=!!document.documentMode,i=!e&&!!window.StyleMedia,n=window.navigator.userAgent.indexOf("Firefox")>-1;return(e||i||n)&&(t=this.flatten(t)),JSON.stringify(t)},isModel:function(t,e,i){return i?i.model.get(t)===e:this.model.get(t)===e},generateGuid:function(t,e){var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),n=[],r=0;for(e=e||i.length,t=t||22,r=0;r<t;r++)n[r]=i[0|Math.random()*e];return n.join("")},isObserverSupported:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=window[t],n=void 0!==i,r=!1;return n&&(r=-1!==i.toString().indexOf("[native code]")),r||e&&n},isHeightValid:function(t){var e=!0;return t||(e=!1),e},isWidthValid:function(t){var e=!0;return t||(e=!1),e},setTrcObserver:function(t){a(TRC.intersections)&&TRC.intersections.observe&&TRC.intersections.observe(t)},dispatchTRC:function(t,e){d.dispatchTRCWithPayload(t,void 0,e)},dispatchTRCWithPayload:function(t,e,i){if(window.TRC&&window.TRC.dispatch)try{window.TRC.dispatch(t,e),d.log("info","dispatched TRC event: ".concat(t))}catch(e){i&&i.set("TRCDispatchFailed",!0),d.log("error","dispatched TRC event: ".concat(t," is failed, error: ").concat(e))}},getOffsetWithContainer:function(t,e,i){if(!i)return this.getOffset(t,e);var n=this.getOffset(t,e),r=this.getOffset((0,o.default)(i));return{top:n.top-r.top,left:n.left-r.left}},getIframeDocument:function(t){try{if(t.tagName&&"iframe"==t.tagName.toLowerCase())return t.contentWindow.console.error&&(t.contentWindow.console.error=function(){}),t.contentDocument}catch(t){return null}},DOMIterator:function(t,e,i,n){var r=this;try{var o=this.getIframeDocument(t)||t;if(!o)return;o.querySelectorAll(e).forEach((function(t){r.DOMIterator(t,e,i,n)})),i(o.querySelectorAll(n))}catch(t){}},isBrowserIE11:function(t){return-1!==t.name.indexOf("ie")&&11===t.version},forceElementRedrawWithBorderChange:function(t,e,i){if(this.isBrowserIE11(t)&&!i){var n=(0,o.default)(e);n&&n.css&&(n.css("border","1px solid transparent"),setTimeout(function(){n&&n.css&&n.css("border","none")}.bind(n)))}},hasPassedPixelFromSelector:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;if(t){var r,s;if(t.nodeType)r=[t];else{var a=t.toString();r=s=(0,o.default)(a)}n&&(r=this.getValidSelectorElements(s));var l=r[0];if(e=(0,o.default)(e)[0],window.taboolaBridge){var c=taboolaBridge.data;if(c&&c.boundingClientRect){var u=c.boundingClientRect.top-c.rootBounds.bottom,h=u<i;return d.log("info","###hasPassedPixelsFromSelector"+h+" - "+u+"/"+i),h}}var f=void 0!==e,p=f?e.clientHeight:window.innerHeight,m=f?p+e.scrollTop:p+window.pageYOffset,y=i;return this.getTopOfEl(l)-y<=m}},getViewportHeight:function(t){return void 0!==(t=(0,o.default)(t)[0])?t.clientHeight:window.innerHeight},calcViewportPositionInApp:function(t){var e=window.taboolaBridge.data,i=e.boundingClientRect;return{top:i.y<0?0-i.y:0,left:0,right:i.width,bottom:i.y>e.rootBounds.height?0:Math.abs(i.y-e.rootBounds.height)}},getOrganicCard:function(){var t=TRCImpl.boxes||{};for(var e in t){var i=t[e]||{},n=i.isFeedCard,r=!1;if(i.itemsTypes&&i.itemsTypes["is-organic"]&&(r=i.itemsTypes["is-organic"]),r&&n&&i.boxes.length)return i.mode}},getRootElementFontSize:function(){return parseFloat(getComputedStyle(document.documentElement).fontSize)},convertRem:function(t){return t*this.getRootElementFontSize()},flattenArray:function(t,e){return f(t,e,!1)},offsetFromBottomOfViewPort:function(t){return t.getBoundingClientRect().top-(window.innerHeight||document.documentElement.clientHeight)},sendingEventToTaboolaBridge:function(t,e){window.taboolaBridge&&window.taboolaBridge.emit("videoEvent",{type:t,value:e})},setAnimationPlayState:function(t,e){t.style.webkitAnimationPlayState=e,t.style.animationPlayState=e},recoReelPlayStateAnimation:function(t,e,i){var n=e+1,r=(0,o.default)('[data-progress-bar-index="'.concat(e,'"] .tbl-progress-runner'),t)[0],s=(0,o.default)(".videoCube_".concat(n,"_child .thumbBlock"),t)[0];r&&this.setAnimationPlayState(r,i),s&&this.setAnimationPlayState(s,i);var a=(0,o.default)(".videoCube_".concat(n,"_child .tbl-vrl-video-wrapper video"),t)[0];if(a){this.toggleRecoReelVideo(a,i);var l=(0,o.default)(".vrl-cta",t.parentElement)[0];l&&this.setAnimationPlayState(l,i)}},toggleRecoReelVideo:function(t,e){"paused"===e?t.pause():t.play()},getRandomFromList:function(t){return!(t.length<1)&&t[Math.floor(Math.random()*t.length)]},isSendBeaconSupported:function(){return!(!navigator||!d.isFunction(navigator.sendBeacon))},getSubUnitType:function(t){var e=t.isMidArticle,i=t.isSticky,n=t.isDetachBelow,o=t.isDetachAbove,s=t.isStartFromSlider,a=t.isDetachToSlider;return e?r().SUB_UNIT_TYPE.MID_ARTICLE_AS_FEED:i||!s||a?i||s||!a?!i&&s&&a?r().SUB_UNIT_TYPE.SUPER_SLIDER:i&&n&&!o?r().SUB_UNIT_TYPE.STICKY_BELOW:i&&!n&&o?r().SUB_UNIT_TYPE.STICKY_ABOVE:i&&n&&o?r().SUB_UNIT_TYPE.STICKY_BELOW_ABOVE:void 0:r().SUB_UNIT_TYPE.DETACH_TO_SLIDER:r().SUB_UNIT_TYPE.START_FROM_SLIDER},getRecoReelSubUnitType:function(t){var e=t.isRecoReelEnableRboxSlider||!1,i=t.isRecoReelStartFromRboxSlider||!1;return e&&i?r().RECO_REEL_SUB_UNIT_TYPE.START_FROM_SLIDER_RBOX:e&&!i?r().RECO_REEL_SUB_UNIT_TYPE.DETACH_TO_SLIDER_RBOX:r().RECO_REEL_SUB_UNIT_TYPE.PLAIN},isReadMoreOnPage:function(){return window.TRC&&void 0!==window.TRC.readMoreVisible},isMidArticleOnReadMorePage:function(t){return this.isReadMoreOnPage()&&t},isReadMoreObserverNeededOnPage:function(t,e){return t&&e&&window.TRC&&window.TRC.readMoreVisible&&d.isObserverSupported("IntersectionObserver")},trcPerformanceMeasurement:function(t,e,i){try{if(t&&d.isTRCPerformanceEnabled()){var n="".concat(e).concat(i);window.TRC.performance.mark(n,null,"","",e,window.TRC.PerfEvenType[i.toUpperCase()])}}catch(t){}},isTRCPerformanceEnabled:function(){return window.TRC&&window.TRC.performance&&window.TRC.performance.mark},copyCSSFromPlaceholder:function(t,e,i){if(t&&e&&i&&0!==i.length){var n=window.getComputedStyle(e),r={};d.forEach(i,(function(t){r[t]=n[t]})),t.css(r)}},getDeltaBetweenRects:function(t,e){if(!t)return e||{};if(!e)return t||{};var i={};for(var n in t)if(void 0!==e[n]){var r=t[n]-e[n];r&&(i[n]=r)}return i},buildObserverThresholdList:function(){for(var t=[],e=1;e<=20;e++){var i=e/20;t.push(i)}return t.push(0),t},getRequiredHeight:function(t,e){var i=e.get("width"),n=document.querySelector("[".concat(t,"]"));if(n){var r=n.getBoundingClientRect().width;return d.getVideoHeight(r)}return d.getVideoHeight(i)},getFeedTitleHeight:function(){var t=document.querySelector(".tbl-feed-header");return t?(0,o.default)(t).height():0},getPlacement:function(t){var e=t.get("placement");return e=(e=e.replace("Feed - ","")).split(" |")[0]},getMarginToStartCard:function(t,e,i){if(this.isPlacementWithScAdjacency(t)){var n=document.querySelector(e);if(n)return(0,o.default)(n).offset().top-(0,o.default)(i).offset().top}return 0},isPlacementWithScAdjacency:function(t){return t.get("placementWithScAdjacency")===d.getPlacement(t)},isLanguageRTL:function(t){var e=t.get("language");return t.get("rtlLanguagesArray").includes(e)},loadFromTRC:function(t,e,i,n){this.isServiceValid(t,e)&&this.isServiceLoadedOnTRC(t,e)&&this.onServiceLoaded(t,e,i,n)},isServiceValid:function(t,e){return t&&e},isServiceLoadedOnTRC:function(t,e){return window.TRC&&window.TRC[t]&&window.TRC[t][e]},onServiceLoaded:function(t,e,i,n){if(i)try{i(window.TRC[t][e])}catch(t){n&&n()}},isSliderCutOffEnabled:function(t,e){return t.get("isSliderCutOff")&&e&&!e.alwsldr},clickThru:function(t){this.model.get("isInAppBridgeOn")&&window.taboolaBridge&&window.taboolaMobile&&window.taboolaMobile.getSupportedFeatures&&window.taboolaMobile.getSupportedFeatures().VideoClick?window.taboolaBridge.emit("videoClick",t):window.open(t)},defer:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h.deferTasks&&h.deferTasks.isActive?setTimeout(t.bind(e),0):t.apply(e)},log:function(t,e){u&&u[t](e)}})},9288:function(t,e,i){"use strict";var n,r,o;function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}(o=this)||(o={}),o.Backbone||(o.Backbone={}),n=[i(1999),i(9057),e],r=function(t,e,i){o.Backbone=function(t,e,i,n){var r=t.Backbone,o=[],a=(o.push,o.slice);o.splice,e.VERSION="1.1.2",e.$=n,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var l=e.Events={on:function(t,e,i){return u(this,"on",t,[e,i])&&e?(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this}),this):this},once:function(t,e,n){if(!u(this,"once",t,[e,n])||!e)return this;var r=this,o=i.once((function(){r.off(t,o),e.apply(this,arguments)}));return o._callback=e,this.on(t,o,n)},off:function(t,e,n){var r,o,s,a,l,c,d,h;if(!this._events||!u(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events=void 0,this;for(l=0,c=(a=t?[t]:i.keys(this._events)).length;l<c;l++)if(t=a[l],s=this._events[t]){if(this._events[t]=r=[],e||n)for(d=0,h=s.length;d<h;d++)o=s[d],(e&&e!==o.callback&&e!==o.callback._callback||n&&n!==o.context)&&r.push(o);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!u(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&d(i,e),n&&d(n,arguments),this},stopListening:function(t,e,n){var r=this._listeningTo;if(!r)return this;var o=!e&&!n;for(var a in n||"object"!==s(e)||(n=this),t&&((r={})[t._listenId]=t),r)(t=r[a]).off(e,n,this),(o||i.isEmpty(t._events))&&delete this._listeningTo[a];return this}},c=/\s+/,u=function(t,e,i,n){if(!i)return!0;if("object"===s(i)){for(var r in i)t[e].apply(t,[r,i[r]].concat(n));return!1}if(c.test(i)){for(var o=i.split(c),a=0,l=o.length;a<l;a++)t[e].apply(t,[o[a]].concat(n));return!1}return!0},d=function(t,e){var i,n=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++n<r;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o);return;case 2:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s);return;case 3:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s,a);return;default:for(;++n<r;)(i=t[n]).callback.apply(i.ctx,e);return}},h={listenTo:"on",listenToOnce:"once"};i.each(h,(function(t,e){l[e]=function(e,n,r){return(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=i.uniqueId("l"))]=e,r||"object"!==s(n)||(r=this),e[t](n,r,this),this}})),l.bind=l.on,l.unbind=l.off,i.extend(e,l);var f=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(f.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var r,o,a,l,c,u,d,h;if(null==t)return this;if("object"===s(t)?(o=t,n=e):(o={})[t]=e,n||(n={}),!this._validate(o,n))return!1;for(r in a=n.unset,c=n.silent,l=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=i.clone(this.attributes),this.changed={}),h=this.attributes,d=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]),o)e=o[r],i.isEqual(h[r],e)||l.push(r),i.isEqual(d[r],e)?delete this.changed[r]:this.changed[r]=e,a?delete h[r]:h[r]=e;if(!c){l.length&&(this._pending=n);for(var f=0,p=l.length;f<p;f++)this.trigger("change:"+l[f],this,h[l[f]],n)}if(u)return this;if(!c)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&i.clone(this.changed);var e,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var o in t)i.isEqual(r[o],e=t[o])||((n||(n={}))[o]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){void 0===(t=t?i.clone(t):{}).parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(i){if(!e.set(e.parse(i,t),t))return!1;n&&n(e,i,t),e.trigger("sync",e,i,t)},L(this,t),this.sync("read",this,t)},save:function(t,e,n){var r,o,a,l=this.attributes;if(null==t||"object"===s(t)?(r=t,n=e):(r={})[t]=e,n=i.extend({validate:!0},n),r&&!n.wait){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=i.extend({},l,r)),void 0===n.parse&&(n.parse=!0);var c=this,u=n.success;return n.success=function(t){c.attributes=l;var e=c.parse(t,n);if(n.wait&&(e=i.extend(r||{},e)),i.isObject(e)&&!c.set(e,n))return!1;u&&u(c,t,n),c.trigger("sync",c,t,n)},L(this,n),"patch"==(o=this.isNew()?"create":n.patch?"patch":"update")&&(n.attrs=r),a=this.sync(o,this,n),r&&n.wait&&(this.attributes=l),a},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(i){(t.wait||e.isNew())&&r(),n&&n(e,i,t),e.isNew()||e.trigger("sync",e,i,t)},this.isNew())return t.success(),!1;L(this,t);var o=this.sync("delete",this,t);return t.wait||r(),o},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||M();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1)}});var p=["keys","values","pairs","invert","pick","omit"];i.each(p,(function(t){f.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),i[t].apply(i,e)}}));var m=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},y={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};i.extend(m.prototype,l,{model:f,initialize:function(){},toJSON:function(t){return this.map((function(e){return e.toJSON(t)}))},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,g))},remove:function(t,e){var n,r,o,s,a=!i.isArray(t);for(e||(e={}),n=0,r=(t=a?[t]:i.clone(t)).length;n<r;n++)(s=t[n]=this.get(t[n]))&&(delete this._byId[s.id],delete this._byId[s.cid],o=this.indexOf(s),this.models.splice(o,1),this.length--,e.silent||(e.index=o,s.trigger("remove",s,this,e)),this._removeReference(s,e));return a?t[0]:t},set:function(t,e){(e=i.defaults({},e,y)).parse&&(t=this.parse(t,e));var n,r,o,s,a,l,c,u=!i.isArray(t);t=u?t?[t]:[]:i.clone(t);var d=e.at,h=this.model,p=this.comparator&&null==d&&!1!==e.sort,m=i.isString(this.comparator)?this.comparator:null,g=[],v=[],b={},_=e.add,S=e.merge,w=e.remove,T=!(p||!_||!w)&&[];for(n=0,r=t.length;n<r;n++){if(o=(a=t[n]||{})instanceof f?s=a:a[h.prototype.idAttribute||"id"],l=this.get(o))w&&(b[l.cid]=!0),S&&(a=a===s?s.attributes:a,e.parse&&(a=l.parse(a,e)),l.set(a,e),p&&!c&&l.hasChanged(m)&&(c=!0)),t[n]=l;else if(_){if(!(s=t[n]=this._prepareModel(a,e)))continue;g.push(s),this._addReference(s,e)}s=l||s,!T||!s.isNew()&&b[s.id]||T.push(s),b[s.id]=!0}if(w){for(n=0,r=this.length;n<r;++n)b[(s=this.models[n]).cid]||v.push(s);v.length&&this.remove(v,e)}if(g.length||T&&T.length)if(p&&(c=!0),this.length+=g.length,null!=d)for(n=0,r=g.length;n<r;n++)this.models.splice(d+n,0,g[n]);else{T&&(this.models.length=0);var P=T||g;for(n=0,r=P.length;n<r;n++)this.models.push(P[n])}if(c&&this.sort({silent:!0}),!e.silent){for(n=0,r=g.length;n<r;n++)(s=g[n]).trigger("add",s,this,e);(c||T&&T.length)&&this.trigger("sort",this,e)}return u?t[0]:t},reset:function(t,e){e||(e={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return i.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"]((function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0}))},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return i.invoke(this.models,"get",t)},fetch:function(t){void 0===(t=t?i.clone(t):{}).parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(i){var r=t.reset?"reset":"set";n[r](i,t),e&&e(n,i,t),n.trigger("sync",n,i,t)},L(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?i.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,r=e.success;return e.success=function(t,i){e.wait&&n.add(t,e),r&&r(t,i,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof f)return t;(e=e?i.clone(e):{}).collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_addReference:function(t,e){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(v,(function(t){m.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),i[t].apply(i,e)}}));var b=["groupBy","countBy","sortBy","indexBy"];i.each(b,(function(t){m.prototype[t]=function(e,n){var r=i.isFunction(e)?e:function(t){return t.get(e)};return i[t](this.models,r,n)}}));var _=e.View=function(t){this.cid=i.uniqueId("view"),t||(t={}),i.extend(this,i.pick(t,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];i.extend(_.prototype,l,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],!1!==i&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=i.result(this,"events")))return this;for(var e in this.undelegateEvents(),t){var n=t[e];if(i.isFunction(n)||(n=this[t[e]]),n){var r=e.match(S),o=r[1],s=r[2];n=i.bind(n,this),o+=".delegateEvents"+this.cid,""===s?this.$el.on(o,n):this.$el.on(o,s,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t.class=i.result(this,"className"));var n=e.$("<"+i.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}}),e.sync=function(t,n,r){var o=P[t];i.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:o,dataType:"json"};if(r.url||(s.url=i.result(n,"url")||M()),null!=r.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",r.emulateJSON&&(s.data._method=o);var a=r.beforeSend;r.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||r.emulateJSON||(s.processData=!1),"PATCH"===s.type&&T&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=r.xhr=e.ajax(i.extend(s,r));return n.trigger("request",n,l,r),l};var T=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),P={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var A=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},E=/\((.*?)\)/g,O=/(\(\?)?:\w+/g,C=/\*\w+/g,k=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(A.prototype,l,{initialize:function(){},route:function(t,n,r){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var o=this;return e.history.route(t,(function(i){var s=o._extractParameters(t,i);o.execute(r,s),o.trigger.apply(o,["route:"+n].concat(s)),o.trigger("route",n,s),e.history.trigger("route",o,n,s)})),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(k,"\\$&").replace(E,"(?:$1)?").replace(O,(function(t,e){return e?t:"([^/?]+)"})).replace(C,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,(function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null}))}});var I=e.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},R=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,V=/msie [\w.]+/,N=/\/$/,x=/#.*$/;I.started=!1,i.extend(I.prototype,l,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(N,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace(R,"")},start:function(t){if(I.started)throw new Error("Backbone.history has already been started");I.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),r=document.documentMode,o=V.exec(navigator.userAgent.toLowerCase())&&(!r||r<=7);if(this.root=("/"+this.root+"/").replace(D,"/"),o&&this._wantsHashChange){var s=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=s.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(R,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),I.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return t=this.fragment=this.getFragment(t),i.any(this.handlers,(function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!I.started)return!1;e&&!0!==e||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(x,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new I;var j=function(t,e){var n,r=this;n=t&&i.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,e);var o=function(){this.constructor=n};return o.prototype=r.prototype,n.prototype=new o,t&&i.extend(n.prototype,t),n.__super__=r.prototype,n};f.extend=m.extend=A.extend=_.extend=I.extend=j;var M=function(){throw new Error('A "url" property or function must be specified')},L=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}};return e}(o,i,t,e)}.apply(e,n),void 0===r||(t.exports=r)},2782:function(t,e,i){var n,r,o;function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}var a=i(1999),l=i(9288);(function(){var t,e,i,n,r,o,s,c=[].slice;i=function(t){var e,n;return!a.isObject(t)||a.isFunction(t)||t instanceof l.Collection||t instanceof l.Model?t:a.isDate(t)?new Date(t.getTime()):a.isRegExp(t)?new RegExp(t.source,t.toString().replace(/.*\//,"")):t instanceof HTMLElement||t.nodeType&&1===t.nodeType?t:t instanceof CSSStyleDeclaration?JSON.stringify(s(t)):(n=a.isArray(t||a.isArguments(t)),e=function(t,e,r){return n?t.push(i(e)):t[r]=i(e),t},a.reduce(t,e,n?[]:{}))},s=function(t){var e=!!document.documentMode,i=!e&&!!window.StyleMedia;if(!e&&!i)return t;var n={};for(var r in t)n[r]=t[r];return n},o=function(t){return null!=t&&((t.prototype==={}.prototype||t.prototype===Object.prototype)&&a.isObject(t)&&!a.isArray(t)&&!a.isFunction(t)&&!a.isDate(t)&&!a.isRegExp(t)&&!a.isArguments(t))},e=function(t){return a.filter(a.keys(t),(function(e){return o(t[e])}))},t=function(t){return a.filter(a.keys(t),(function(e){return a.isArray(t[e])}))},r=function(i,n,o){var s,l,c,u,d,h,f,p;if(null==o&&(o=20),o<=0)return console.warn("_.deepExtend(): Maximum depth of recursion hit."),a.extend(i,n);for(l=function(t){return n[t]=r(i[t],n[t],o-1)},d=0,f=(u=a.intersection(e(i),e(n))).length;d<f;d++)l(u[d]);for(s=function(t){return n[t]=a.union(i[t],n[t])},h=0,p=(c=a.intersection(t(i),t(n))).length;h<p;h++)s(c[h]);return a.extend(i,n)},n=function(){var t,e,n,o;if(n=2<=arguments.length?c.call(arguments,0,o=arguments.length-1):(o=0,[]),e=arguments[o++],a.isNumber(e)||(n.push(e),e=20),n.length<=1)return n[0];if(e<=0)return a.extend.apply(this,n);for(t=n.shift();n.length>0;)t=r(t,i(n.shift()),e);return t},a.mixin({deepClone:i,isBasicObject:o,basicObjects:e,arrays:t,deepExtend:n})}).call(this),r=[i(1999),i(9288)],n=function(e,i){function n(t){var i={},r=u.keyPathSeparator;for(var o in t){var s=t[o];if(s&&s.constructor===Object&&!e.isEmpty(s)){var a=n(s);for(var l in a){var c=a[l];i[o+r+l]=c}}else i[o]=s}return i}function r(t,i,n){for(var r=u.keyPathSeparator,o=i.split(r),s=t,a=0,l=o.length;a<l;a++){if(n&&!e.has(s,o[a]))return!1;if(null==(s=s[o[a]])&&a<l-1&&(s={}),void 0===s)return!!n||s}return!!n||s}function o(t,i,n,r){r=r||{};for(var o=u.keyPathSeparator,s=i.split(o),a=t,l=0,c=s.length;l<c&&void 0!==a;l++){var d=s[l];l===c-1?r.unset?delete a[d]:a[d]=n:(void 0!==a[d]&&e.isObject(a[d])||(a[d]={}),a=a[d])}}function a(t){var i={};return"object"!==s(t)?t:(e.each(t,(function(t,e,n){i[e]=l(t)})),i)}function l(t){if(t&&"["===t[0]&&"]"===t[t.length-1]){var i;try{i=JSON.parse(t)}catch(e){i=t}t=i}if(e.isArray(t)){var n=[];return e.each(t,(function(t){n.push(l(t))})),n}return"object"!==s(t)||e.isElement(t)?"true"===t||!0===t||"false"!==t&&!1!==t&&(""===t||isNaN(t)?t:Number(t)):a(t)}function c(t,e){o(t,e,null,{unset:!0})}var u=i.Model.extend({constructor:function(t,i){var n,r=t||{};this.cid=e.uniqueId("c"),this.attributes={},i&&i.collection&&(this.collection=i.collection),i&&i.parse&&(r=this.parse(r,i)||{}),(n=e.result(this,"defaults"))&&(r=e.deepExtend({},n,r)),this.set(r,i),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(t){return e.deepClone(this.attributes)},get:function(t){return r(this.attributes,t)},set:function(t,i,l){var d=this,h=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return function(t){var f,p,m,y,g,v,b,_;if(null==t)return d;if("object"===s(t)?(p=t,l=i||{}):(p={})[t]=i,h&&(p=a(p)),l||(l={}),!d._validate(p,l))return!1;for(f in m=l.unset,g=l.silent,y=[],v=d._changing,d._changing=!0,v||(d._previousAttributes=e.deepClone(d.attributes),d.changed={}),_=d.attributes,b=d._previousAttributes,d.idAttribute in p&&(d.id=p[d.idAttribute]),p=n(p))i=p[f],e.isEqual(r(_,f),i)||y.push(f),e.isEqual(r(b,f),i)?c(d.changed,f):o(d.changed,f,i),m?c(_,f):o(_,f,i);if(!g){y.length&&(d._pending=!0);for(var S=u.keyPathSeparator,w=0,T=y.length;w<T;w++){t=y[w],d.trigger("change:"+t,d,r(_,t),l);for(var P=t.split(S),A=P.length-1;A>0;A--){var E=e.first(P,A).join(S),O=E+S+"*";d.trigger("change:"+O,d,r(_,E),l),d.trigger("change:"+E,d,r(_,t),l)}}}if(v)return d;if(!g)for(;d._pending;)d._pending=!1,d.trigger("change",d,l);return d._pending=!1,d._changing=!1,d}(t)},clear:function(t){var i={},r=n(this.attributes);for(var o in r)i[o]=void 0;return this.set(i,e.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!e.isEmpty(this.changed):void 0!==r(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&n(this.changed);var i=this._changing?this._previousAttributes:this.attributes;t=n(t),i=n(i);var r,o=!1;for(var s in t)e.isEqual(i[s],r=t[s])||((o||(o={}))[s]=r);return o},previous:function(t){return null!=t&&this._previousAttributes?r(this._previousAttributes,t):null},previousAttributes:function(){return e.deepClone(this._previousAttributes)}});return u.keyPathSeparator=".",i.DeepModel=u,t.exports=u,i},void 0===(o="function"==typeof n?n.apply(e,r):n)||(t.exports=o)},2447:function(t,e,i){"use strict";i.d(e,{O:function(){return s},s:function(){return m}});var n=i(1231);function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,s=void 0,s=function(t,e){if("object"!==r(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===r(s)?s:String(s)),n)}var o,s}i(1999);var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,r;return e=t,(i=[{key:"createStateHandlers",value:function(t){(0,n.L)(this,t)}}])&&o(e.prototype,i),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),a=i(9288),l=i.n(a);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function u(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==c(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===c(o)?o:String(o)),n)}var r,o}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=f(t);if(e){var r=f(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}var p=i(1999),m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(s,t);var e,i,r,o=h(s);function s(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),o.call(this,t)}return e=s,(i=[{key:"renderTemplate",value:function(){if(this.template&&this.model&&(this.template=p.template(this.template),this.$el.append(this.template(this.model.attributes)),this.ui)){var t={};for(var e in this.ui)t[e]=this.$el.find(this.ui[e]);this.ui=t}}},{key:"createStateHandlers",value:function(t){(0,n.L)(this,t)}}])&&u(e.prototype,i),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),s}(l().View)},1231:function(t,e,i){"use strict";function n(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}i.d(e,{L:function(){return s}});var o=i(1999),s=function(t,e){if(t.model&&o.isArray(e)){var i=function(t){var e,i=t.self,r=t.funcName,s=t.withBind,a=t.args;o.isString(r)&&o.isFunction(i[r])&&(s?(e=i[r]).bind.apply(e,[i].concat(n(a)))():i[r].apply(i,n(a)))};o.each(e,function(e){var n=e.event,r=e.funcName,s=e.isListenOnce,a=void 0!==s&&s,l=e.withBind,c=void 0===l||l;if(o.isArray(n)&&function(e){var n=e.event,r=e.funcName,s=e.isListenOnce,a=e.withBind,l=s?"listenToOnce":"listenTo",c=!0,u=!1,d=[];o.forEach(n,function(t){var e=t.split(":")[0],i=t.split(":")[1];d.push({eventName:e,stateName:i})}.bind(t));var h=function(e){if(!s||!u){var n=!0;o.forEach(d,(function(e){(void 0!==t.model.get(e.eventName)?t.model.get(e.eventName).toString():void 0)!==e.stateName&&(n=!1)})),n&&c?(c=!1,u=!0,i({self:t,funcName:r,withBind:a,args:arguments})):n||e()}};o.forEach(n,function(e){!function(t){var e=t.self,i=t.event,n=t.func,r=t.listen,o=t.isListenOnce,s=t.onEventNotEqual,a=i.split(":")[0],l=i.split(":")[1],c=function(){var t=function(){};o&&(t=function(){e.model.listenToOnce(e.model,"change:".concat(a),c)}),e.model.get(a).toString()===l?n.call(e,t):o?(s(),t()):s()}.bind(e);e.model[r](e.model,"change:".concat(a),c)}({self:t,func:h,event:e,withBind:a,listen:l,isListenOnce:s,onEventNotEqual:function(){c=!0}.bind(t)})}.bind(t))}({event:n,funcName:r,isListenOnce:a,withBind:c}),o.isString(n)&&o.isString(r)){var u=a?"listenToOnce":"listenTo";n.match(":")?function(t){var e=t.self,n=t.funcName,r=t.event,o=t.withBind,s=t.listen,a=t.isListenOnce,l=r.split(":")[0],c=r.split(":")[1],u=function(){e.model.get(l).toString()==c?i({self:e,funcName:n,withBind:o,args:arguments}):a&&e.model.listenToOnce(e.model,"change:".concat(l),u)}.bind(e);e.model[s](e.model,"change:".concat(l),u)}({self:t,funcName:r,event:n,withBind:c,listen:u,isListenOnce:a}):t.model[u](t.model,"change:".concat(n),function(){i({self:t,funcName:r,withBind:c,args:arguments})}.bind(t))}}.bind(t))}}},9057:function(t,e,i){"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}i.r(e);var r=function(){var t,e=function(){var t,e,i,r,o,s,a=[],l=a.slice,c=a.filter,u=window.document,d={},h={},f={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},p=/^\s*<(\w+|!)[^>]*>/,m=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,g=/^(?:body|html)$/i,v=/([A-Z])/g,b=["val","css","html","text","data","width","height","offset"],_=u.createElement("table"),S=u.createElement("tr"),w={tr:u.createElement("tbody"),tbody:_,thead:_,tfoot:_,td:S,th:S,"*":u.createElement("div")},T=/complete|loaded|interactive/,P=/^[\w-]*$/,A={},E=A.toString,O={},C=u.createElement("div"),k={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},I=Array.isArray||function(t){return t instanceof Array};function R(t){return null==t?String(t):A[E.call(t)]||"object"}function D(t){return"function"==R(t)}function V(t){return null!=t&&t==t.window}function N(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function x(t){return"object"==R(t)}function j(t){return x(t)&&!V(t)&&Object.getPrototypeOf(t)==Object.prototype}function M(t){return"number"==typeof t.length}function L(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function B(t){return t in h?h[t]:h[t]=RegExp("(^|\\s)"+t+"(\\s|$)")}function F(t,e){return"number"!=typeof e||f[L(t)]?e:e+"px"}function U(t){return"children"in t?l.call(t.children):i.map(t.childNodes,(function(t){if(1==t.nodeType)return t}))}function W(t,e){return null==e?i(t):i(t).filter(e)}function H(t,e,i,n){return D(e)?e.call(t,i,n):e}function $(t,e,i){null==i?t.removeAttribute(e):t.setAttribute(e,i)}function z(e,i){var n=e.className||"",r=n&&t!==n.baseVal;if(i===t)return r?n.baseVal:n;r?n.baseVal=i:e.className=i}function q(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?i.parseJSON(t):t):t}catch(e){return t}}return O.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var i=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(i)return i.call(t,e);var n,r=t.parentNode,o=!r;return o&&(r=C).appendChild(t),n=~O.qsa(r,e).indexOf(t),o&&C.removeChild(t),n},o=function(t){return t.replace(/-+(.)?/g,(function(t,e){return e?e.toUpperCase():""}))},s=function(t){return c.call(t,(function(e,i){return t.indexOf(e)==i}))},O.fragment=function(e,n,r){var o,s,a;return m.test(e)&&(o=i(u.createElement(RegExp.$1))),o||(e.replace&&(e=e.replace(y,"<$1></$2>")),n===t&&(n=p.test(e)&&RegExp.$1),n in w||(n="*"),(a=w[n]).innerHTML=""+e,o=i.each(l.call(a.childNodes),(function(){a.removeChild(this)}))),j(r)&&(s=i(o),i.each(r,(function(t,e){b.indexOf(t)>-1?s[t](e):s.attr(t,e)}))),o},O.Z=function(t,e){return(t=t||[]).__proto__=i.fn,t.selector=e||"",t},O.isZ=function(t){return t instanceof O.Z},O.init=function(e,n){var r,o;if(!e)return O.Z();if("string"==typeof e)if("<"==(e=e.trim())[0]&&p.test(e))r=O.fragment(e,RegExp.$1,n),e=null;else{if(n!==t)return i(n).find(e);r=O.qsa(u,e)}else{if(D(e))return i(u).ready(e);if(O.isZ(e))return e;if(I(e))o=e,r=c.call(o,(function(t){return null!=t}));else if(x(e))r=[e],e=null;else if(p.test(e))r=O.fragment(e.trim(),RegExp.$1,n),e=null;else{if(n!==t)return i(n).find(e);r=O.qsa(u,e)}}return O.Z(r,e)},i=function(t,e){return O.init(t,e)},i.extend=function(i){var n,r=l.call(arguments,1);return"boolean"==typeof i&&(n=i,i=r.shift()),r.forEach((function(r){!function i(n,r,o){for(e in r)o&&(j(r[e])||I(r[e]))?(j(r[e])&&!j(n[e])&&(n[e]={}),I(r[e])&&!I(n[e])&&(n[e]=[]),i(n[e],r[e],o)):t!==r[e]&&(n[e]=r[e])}(i,r,n)})),i},O.qsa=function(t,e){var i,n="#"==e[0],r=!n&&"."==e[0],o=n||r?e.slice(1):e,s=P.test(o);return N(t)&&s&&n?(i=t.getElementById(o))?[i]:[]:1!==t.nodeType&&9!==t.nodeType?[]:l.call(s&&!n?r?t.getElementsByClassName(o):t.getElementsByTagName(e):t.querySelectorAll(e))},i.contains=u.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1},i.type=R,i.isFunction=D,i.isWindow=V,i.isArray=I,i.isPlainObject=j,i.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},i.inArray=function(t,e,i){return a.indexOf.call(e,t,i)},i.camelCase=o,i.trim=function(t){return null==t?"":String.prototype.trim.call(t)},i.uuid=0,i.support={},i.expr={},i.map=function(t,e){var n,r,o,s,a=[];if(M(t))for(o=0;o<t.length;o++)null!=(r=e(t[o],o))&&a.push(r);else for(s in t)null!=(r=e(t[s],s))&&a.push(r);return(n=a).length>0?i.fn.concat.apply([],n):n},i.each=function(t,e){var i,n;if(M(t))for(i=0;i<t.length&&!1!==e.call(t[i],i,t[i]);i++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},i.grep=function(t,e){return c.call(t,e)},window.JSON&&(i.parseJSON=JSON.parse),i.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),(function(t,e){A["[object "+e+"]"]=e.toLowerCase()})),i.fn={forEach:a.forEach,reduce:a.reduce,push:a.push,sort:a.sort,indexOf:a.indexOf,concat:a.concat,map:function(t){return i(i.map(this,(function(e,i){return t.call(e,i,e)})))},slice:function(){return i(l.apply(this,arguments))},ready:function(t){return T.test(u.readyState)&&u.body?t(i):u.addEventListener("DOMContentLoaded",(function(){t(i)}),!1),this},get:function(e){return e===t?l.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each((function(){null!=this.parentNode&&this.parentNode.removeChild(this)}))},each:function(t){return a.every.call(this,(function(e,i){return!1!==t.call(e,i,e)})),this},filter:function(t){return D(t)?this.not(this.not(t)):i(c.call(this,(function(e){return O.matches(e,t)})))},add:function(t,e){return i(s(this.concat(i(t,e))))},is:function(t){return this.length>0&&O.matches(this[0],t)},not:function(e){var n=[];if(D(e)&&t!==e.call)this.each((function(t){e.call(this,t)||n.push(this)}));else{var r="string"==typeof e?this.filter(e):M(e)&&D(e.item)?l.call(e):i(e);this.forEach((function(t){0>r.indexOf(t)&&n.push(t)}))}return i(n)},has:function(t){return this.filter((function(){return x(t)?i.contains(this,t):i(this).find(t).size()}))},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!x(t)?t:i(t)},last:function(){var t=this[this.length-1];return t&&!x(t)?t:i(t)},find:function(t){var e=this;return t?"object"==n(t)?i(t).filter((function(){var t=this;return a.some.call(e,(function(e){return i.contains(e,t)}))})):1==this.length?i(O.qsa(this[0],t)):this.map((function(){return O.qsa(this,t)})):i()},closest:function(t,e){var r=this[0],o=!1;for("object"==n(t)&&(o=i(t));r&&!(o?o.indexOf(r)>=0:O.matches(r,t));)r=r!==e&&!N(r)&&r.parentNode;return i(r)},parents:function(t){for(var e=[],n=this;n.length>0;)n=i.map(n,(function(t){if((t=t.parentNode)&&!N(t)&&0>e.indexOf(t))return e.push(t),t}));return W(e,t)},parent:function(t){return W(s(this.pluck("parentNode")),t)},children:function(t){return W(this.map((function(){return U(this)})),t)},contents:function(){return this.map((function(){return l.call(this.childNodes)}))},siblings:function(t){return W(this.map((function(t,e){return c.call(U(e.parentNode),(function(t){return t!==e}))})),t)},empty:function(){return this.each((function(){this.innerHTML=""}))},pluck:function(t){return i.map(this,(function(e){return e[t]}))},show:function(){return this.each((function(){var t,e,i;("none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display"))&&(this.style.display=(d[t=this.nodeName]||(e=u.createElement(t),u.body.appendChild(e),i=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==i&&(i="block"),d[t]=i),d[t]))}))},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var e=D(t);if(this[0]&&!e)var n=i(t).get(0),r=n.parentNode||this.length>1;return this.each((function(o){i(this).wrapAll(e?t.call(this,o):r?n.cloneNode(!0):n)}))},wrapAll:function(t){if(this[0]){var e;for(i(this[0]).before(t=i(t));(e=t.children()).length;)t=e.first();i(t).append(this)}return this},wrapInner:function(t){var e=D(t);return this.each((function(n){var r=i(this),o=r.contents(),s=e?t.call(this,n):t;o.length?o.wrapAll(s):r.append(s)}))},unwrap:function(){return this.parent().each((function(){i(this).replaceWith(i(this).children())})),this},clone:function(){return this.map((function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(e){return this.each((function(){var n=i(this);(e===t?"none"==n.css("display"):e)?n.show():n.hide()}))},prev:function(t){return i(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return i(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0 in arguments?this.each((function(e){var n=this.innerHTML;i(this).empty().append(H(this,t,e,n))})):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each((function(e){var i=H(this,t,e,this.textContent);this.textContent=null==i?"":""+i})):0 in this?this[0].textContent:null},attr:function(i,n){var r;return"string"!=typeof i||1 in arguments?this.each((function(t){if(1===this.nodeType)if(x(i))for(e in i)$(this,e,i[e]);else $(this,i,H(this,n,t,this.getAttribute(i)))})):this.length&&1===this[0].nodeType?!(r=this[0].getAttribute(i))&&i in this[0]?this[0][i]:r:t},removeAttr:function(t){return this.each((function(){1===this.nodeType&&t.split(" ").forEach((function(t){$(this,t)}),this)}))},prop:function(t,e){return t=k[t]||t,1 in arguments?this.each((function(i){this[t]=H(this,e,i,this[t])})):this[0]&&this[0][t]},data:function(e,i){var n="data-"+e.replace(v,"-$1").toLowerCase(),r=1 in arguments?this.attr(n,i):this.attr(n);return null!==r?q(r):t},val:function(t){return 0 in arguments?this.each((function(e){this.value=H(this,t,e,this.value)})):this[0]&&(this[0].multiple?i(this[0]).find("option").filter((function(){return this.selected})).pluck("value"):this[0].value)},offset:function(t){if(t)return this.each((function(e){var n=i(this),r=H(this,t,e,n.offset()),o=n.offsetParent().offset(),s={top:r.top-o.top,left:r.left-o.left};"static"==n.css("position")&&(s.position="relative"),n.css(s)}));if(!this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(t,n){if(arguments.length<2){var r,s=this[0];if(!s)return;if(r=getComputedStyle(s,""),"string"==typeof t)return s.style[o(t)]||r.getPropertyValue(t);if(I(t)){var a={};return i.each(t,(function(t,e){a[e]=s.style[o(e)]||r.getPropertyValue(e)})),a}}var l="";if("string"==R(t))n||0===n?l=L(t)+":"+F(t,n):this.each((function(){this.style.removeProperty(L(t))}));else for(e in t)t[e]||0===t[e]?l+=L(e)+":"+F(e,t[e])+";":this.each((function(){this.style.removeProperty(L(e))}));return this.each((function(){this.style.cssText+=";"+l}))},index:function(t){return t?this.indexOf(i(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return!!t&&a.some.call(this,(function(t){return this.test(z(t))}),B(t))},addClass:function(t){return t?this.each((function(e){if("className"in this){r=[];var n=z(this);H(this,t,e,n).split(/\s+/g).forEach((function(t){i(this).hasClass(t)||r.push(t)}),this),r.length&&z(this,n+(n?" ":"")+r.join(" "))}})):this},removeClass:function(e){return this.each((function(i){if("className"in this){if(e===t)return z(this,"");H(this,e,i,r=z(this)).split(/\s+/g).forEach((function(t){r=r.replace(B(t)," ")})),z(this,r.trim())}}))},toggleClass:function(e,n){return e?this.each((function(r){var o=i(this);H(this,e,r,z(this)).split(/\s+/g).forEach((function(e){(n===t?!o.hasClass(e):n)?o.addClass(e):o.removeClass(e)}))})):this},scrollTop:function(e){if(this.length){var i="scrollTop"in this[0];return e===t?i?this[0].scrollTop:this[0].pageYOffset:this.each(i?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var i="scrollLeft"in this[0];return e===t?i?this[0].scrollLeft:this[0].pageXOffset:this.each(i?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),n=this.offset(),r=g.test(e[0].nodeName)?{top:0,left:0}:e.offset();return n.top-=parseFloat(i(t).css("margin-top"))||0,n.left-=parseFloat(i(t).css("margin-left"))||0,r.top+=parseFloat(i(e[0]).css("border-top-width"))||0,r.left+=parseFloat(i(e[0]).css("border-left-width"))||0,{top:n.top-r.top,left:n.left-r.left}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent||u.body;t&&!g.test(t.nodeName)&&"static"==i(t).css("position");)t=t.offsetParent;return t}))}},i.fn.detach=i.fn.remove,["width","height"].forEach((function(e){var n=e.replace(/./,(function(t){return t[0].toUpperCase()}));i.fn[e]=function(r){var o,s=this[0];return r===t?V(s)?s["inner"+n]:N(s)?s.documentElement["scroll"+n]:(o=this.offset())&&o[e]:this.each((function(t){(s=i(this)).css(e,H(this,r,t,s[e]()))}))}})),["after","prepend","before","append"].forEach((function(t,e){var n=e%2;i.fn[t]=function(){var t,r,o=i.map(arguments,(function(e){return"object"==(t=R(e))||"array"==t||null==e?e:O.fragment(e)})),s=this.length>1;return o.length<1?this:this.each((function(t,a){r=n?a:a.parentNode,a=0==e?a.nextSibling:1==e?a.firstChild:2==e?a:null;var l=i.contains(u.documentElement,r);o.forEach((function(t){if(s)t=t.cloneNode(!0);else if(!r)return i(t).remove();r.insertBefore(t,a),l&&function t(e,i){i(e);for(var n=0,r=e.childNodes.length;n<r;n++)t(e.childNodes[n],i)}(t,(function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)}))}))}))},i.fn[n?t+"To":"insert"+(e?"Before":"After")]=function(e){return i(e)[t](this),this}})),O.Z.prototype=i.fn,O.uniq=s,O.deserializeValue=q,i.zepto=O,i}();return function(t){var e,i=1,n=Array.prototype.slice,r=t.isFunction,o=function(t){return"string"==typeof t},s={},a={},l="onfocusin"in window,c={focus:"focusin",blur:"focusout"},u={mouseenter:"mouseover",mouseleave:"mouseout"};function d(t){return t._zid||(t._zid=i++)}function h(t,e,i,n){if((e=f(e)).ns)var r,o=(r=e.ns,RegExp("(?:^| )"+r.replace(" "," .* ?")+"(?: |$)"));return(s[d(t)]||[]).filter((function(t){return t&&(!e.e||t.e==e.e)&&(!e.ns||o.test(t.ns))&&(!i||d(t.fn)===d(i))&&(!n||t.sel==n)}))}function f(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function p(t,e){return t.del&&!l&&t.e in c||!!e}function m(t){return u[t]||l&&c[t]||t}function y(i,n,r,o,a,l,c){var h=d(i),y=s[h]||(s[h]=[]);n.split(/\s/).forEach((function(n){if("ready"==n)return t(document).ready(r);var s=f(n);s.fn=r,s.sel=a,s.e in u&&(r=function(e){var i=e.relatedTarget;if(!i||i!==this&&!t.contains(this,i))return s.fn.apply(this,arguments)}),s.del=l;var d=l||r;s.proxy=function(t){if(!(t=w(t)).isImmediatePropagationStopped()){t.data=o;var n=d.apply(i,e==t._args?[t]:[t].concat(t._args));return!1===n&&(t.preventDefault(),t.stopPropagation()),n}},s.i=y.length,y.push(s),"addEventListener"in i&&i.addEventListener(m(s.e),s.proxy,p(s,c))}))}function g(t,e,i,n,r){var o=d(t);(e||"").split(/\s/).forEach((function(e){h(t,e,i,n).forEach((function(e){delete s[o][e.i],"removeEventListener"in t&&t.removeEventListener(m(e.e),e.proxy,p(e,r))}))}))}a.click=a.mousedown=a.mouseup=a.mousemove="MouseEvents",t.event={add:y,remove:g},t.proxy=function(e,i){var s=2 in arguments&&n.call(arguments,2);if(r(e)){var a=function(){return e.apply(i,s?s.concat(n.call(arguments)):arguments)};return a._zid=d(e),a}if(o(i))return s?(s.unshift(e[i],e),t.proxy.apply(null,s)):t.proxy(e[i],e);throw TypeError("expected function")},t.fn.bind=function(t,e,i){return this.on(t,e,i)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.one=function(t,e,i,n){return this.on(t,e,i,n,1)};var v=function(){return!0},b=function(){return!1},_=/^([A-Z]|returnValue$|layer[XY]$)/,S={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function w(i,n){return(n||!i.isDefaultPrevented)&&(n||(n=i),t.each(S,(function(t,e){var r=n[t];i[t]=function(){return this[e]=v,r&&r.apply(n,arguments)},i[e]=b})),(e!==n.defaultPrevented?n.defaultPrevented:"returnValue"in n?!1===n.returnValue:n.getPreventDefault&&n.getPreventDefault())&&(i.isDefaultPrevented=v)),i}function T(t){var i,n={originalEvent:t};for(i in t)_.test(i)||e===t[i]||(n[i]=t[i]);return w(n,t)}t.fn.delegate=function(t,e,i){return this.on(e,t,i)},t.fn.undelegate=function(t,e,i){return this.off(e,t,i)},t.fn.live=function(e,i){return t(document.body).delegate(this.selector,e,i),this},t.fn.die=function(e,i){return t(document.body).undelegate(this.selector,e,i),this},t.fn.on=function(i,s,a,l,c){var u,d,h=this;return i&&!o(i)?(t.each(i,(function(t,e){h.on(t,s,a,e,c)})),h):(o(s)||r(l)||!1===l||(l=a,a=s,s=e),(r(a)||!1===a)&&(l=a,a=e),!1===l&&(l=b),h.each((function(e,r){c&&(u=function(t){return g(r,t.type,l),l.apply(this,arguments)}),s&&(d=function(e){var i,o=t(e.target).closest(s,r).get(0);if(o&&o!==r)return i=t.extend(T(e),{currentTarget:o,liveFired:r}),(u||l).apply(o,[i].concat(n.call(arguments,1)))}),y(r,i,l,a,s,d||u)})))},t.fn.off=function(i,n,s){var a=this;return i&&!o(i)?(t.each(i,(function(t,e){a.off(t,n,e)})),a):(o(n)||r(s)||!1===s||(s=n,n=e),!1===s&&(s=b),a.each((function(){g(this,i,s,n)})))},t.fn.trigger=function(e,i){return(e=o(e)||t.isPlainObject(e)?t.Event(e):w(e))._args=i,this.each((function(){e.type in c&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,i)}))},t.fn.triggerHandler=function(e,i){var n,r;return this.each((function(s,a){(n=T(o(e)?t.Event(e):e))._args=i,n.target=a,t.each(h(a,e.type||e),(function(t,e){if(r=e.proxy(n),n.isImmediatePropagationStopped())return!1}))})),r},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach((function(e){t.fn[e]=function(t){return 0 in arguments?this.bind(e,t):this.trigger(e)}})),t.Event=function(t,e){o(t)||(t=(e=t).type);var i=document.createEvent(a[t]||"Events"),n=!0;if(e)for(var r in e)"bubbles"==r?n=!!e[r]:i[r]=e[r];return i.initEvent(t,n,!0),w(i)}}(e),function(t){var e,i,n=0,r=window.document,o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,s=/^(?:text|application)\/javascript/i,a=/^(?:text|application)\/xml/i,l="application/json",c="text/html",u=/^\s*$/,d=r.createElement("a");function h(e,i,n,o){var s,a,l,c;if(e.global)return s=i||r,a=n,l=o,c=t.Event(a),t(s).trigger(c,l),!c.isDefaultPrevented()}function f(t,e){var i=e.context;if(!1===e.beforeSend.call(i,t,e)||!1===h(e,i,"ajaxBeforeSend",[t,e]))return!1;h(e,i,"ajaxSend",[t,e])}function p(t,e,i,n){var r=i.context,o="success";i.success.call(r,t,o,e),n&&n.resolveWith(r,[t,o,e]),h(i,r,"ajaxSuccess",[e,i,t]),y(o,e,i)}function m(t,e,i,n,r){var o=n.context;n.error.call(o,i,e,t),r&&r.rejectWith(o,[i,e,t]),h(n,o,"ajaxError",[i,n,t||e]),y(e,i,n)}function y(e,i,n){var r,o=n.context;n.complete.call(o,i,e),h(n,o,"ajaxComplete",[i,n]),!(r=n).global||--t.active||h(r,null,"ajaxStop")}function g(){}function v(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function b(e,i,n,r){return t.isFunction(i)&&(r=n,n=i,i=void 0),t.isFunction(n)||(r=n,n=void 0),{url:e,data:i,success:n,dataType:r}}d.href=window.location.href,t.active=0,t.ajaxJSONP=function(e,i){if(!("type"in e))return t.ajax(e);var o,s,a=e.jsonpCallback,l=(t.isFunction(a)?a():a)||"jsonp"+ ++n,c=r.createElement("script"),u=window[l],d=function(e){t(c).triggerHandler("error",e||"abort")},h={abort:d};return i&&i.promise(h),t(c).on("load error",(function(n,r){clearTimeout(s),t(c).off().remove(),"error"!=n.type&&o?p(o[0],h,e,i):m(null,r||"error",h,e,i),window[l]=u,o&&t.isFunction(u)&&u(o[0]),u=o=void 0})),!1===f(h,e)?(d("abort"),h):(window[l]=function(){o=arguments},c.src=e.url.replace(/\?(.+)=\?/,"?$1="+l),r.head.appendChild(c),e.timeout>0&&(s=setTimeout((function(){d("timeout")}),e.timeout)),h)},t.ajaxSettings={type:"GET",beforeSend:g,success:g,error:g,complete:g,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:l,xml:"application/xml, text/xml",html:c,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},t.ajax=function(n){var o,y=t.extend({},n||{}),b=t.Deferred&&t.Deferred();for(e in t.ajaxSettings)void 0===y[e]&&(y[e]=t.ajaxSettings[e]);y.global&&0==t.active++&&h(y,null,"ajaxStart"),y.crossDomain||((o=r.createElement("a")).href=y.url,o.href=o.href,y.crossDomain=d.protocol+"//"+d.host!=o.protocol+"//"+o.host),y.url||(y.url=window.location.toString()),(n=y).processData&&n.data&&"string"!=t.type(n.data)&&(n.data=t.param(n.data,n.traditional)),n.data&&(!n.type||"GET"==n.type.toUpperCase())&&(n.url=v(n.url,n.data),n.data=void 0);var _=y.dataType,S=/\?.+=\?/.test(y.url);if(S&&(_="jsonp"),!1!==y.cache&&(n&&!0===n.cache||"script"!=_&&"jsonp"!=_)||(y.url=v(y.url,"_="+Date.now())),"jsonp"==_)return S||(y.url=v(y.url,y.jsonp?y.jsonp+"=?":!1===y.jsonp?"":"callback=?")),t.ajaxJSONP(y,b);var w,T=y.accepts[_],P={},A=function(t,e){P[t.toLowerCase()]=[t,e]},E=/^([\w-]+:)\/\//.test(y.url)?RegExp.$1:window.location.protocol,O=y.xhr(),C=O.setRequestHeader;if(b&&b.promise(O),y.crossDomain||A("X-Requested-With","XMLHttpRequest"),A("Accept",T||"*/*"),(T=y.mimeType||T)&&(T.indexOf(",")>-1&&(T=T.split(",",2)[0]),O.overrideMimeType&&O.overrideMimeType(T)),(y.contentType||!1!==y.contentType&&y.data&&"GET"!=y.type.toUpperCase())&&A("Content-Type",y.contentType||"application/x-www-form-urlencoded"),y.headers)for(i in y.headers)A(i,y.headers[i]);if(O.setRequestHeader=A,O.onreadystatechange=function(){if(4==O.readyState){O.onreadystatechange=g,clearTimeout(w);var e,i,n=!1;if(O.status>=200&&O.status<300||304==O.status||0==O.status&&"file:"==E){_=_||((e=y.mimeType||O.getResponseHeader("content-type"))&&(e=e.split(";",2)[0]),e&&(e==c?"html":e==l?"json":s.test(e)?"script":a.test(e)&&"xml")||"text"),i=O.responseText;try{"script"==_?(0,eval)(i):"xml"==_?i=O.responseXML:"json"==_&&(i=u.test(i)?null:t.parseJSON(i))}catch(t){n=t}n?m(n,"parsererror",O,y,b):p(i,O,y,b)}else m(O.statusText||null,O.status?"error":"abort",O,y,b)}},!1===f(O,y))return O.abort(),m(null,"abort",O,y,b),O;if(y.xhrFields)for(i in y.xhrFields)O[i]=y.xhrFields[i];var k=!("async"in y)||y.async;for(i in O.open(y.type,y.url,k,y.username,y.password),P)C.apply(O,P[i]);return y.timeout>0&&(w=setTimeout((function(){O.onreadystatechange=g,O.abort(),m(null,"timeout",O,y,b)}),y.timeout)),O.send(y.data?y.data:null),O},t.get=function(){return t.ajax(b.apply(null,arguments))},t.post=function(){var e=b.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=b.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,i,n){if(!this.length)return this;var r,s=this,a=e.split(/\s/),l=b(e,i,n),c=l.success;return a.length>1&&(l.url=a[0],r=a[1]),l.success=function(e){s.html(r?t("<div>").html(e.replace(o,"")).find(r):e),c&&c.apply(s,arguments)},t.ajax(l),this};var _=encodeURIComponent;t.param=function(e,i){var n=[];return n.add=function(e,i){t.isFunction(i)&&(i=i()),null==i&&(i=""),this.push(_(e)+"="+_(i))},function e(i,n,r,o){var s,a=t.isArray(n),l=t.isPlainObject(n);t.each(n,(function(n,c){s=t.type(c),o&&(n=r?o:o+"["+(l||"object"==s||"array"==s?n:"")+"]"),!o&&a?i.add(c.name,c.value):"array"==s||!r&&"object"==s?e(i,c,r,n):i.add(n,c)}))}(n,e,i),n.join("&").replace(/%20/g,"+")}}(e),(t=e).fn.serializeArray=function(){var e,i,n=[],r=function t(i){if(i.forEach)return i.forEach(t);n.push({name:e,value:i})};return this[0]&&t.each(this[0].elements,(function(n,o){i=o.type,(e=o.name)&&"fieldset"!=o.nodeName.toLowerCase()&&!o.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||o.checked)&&r(t(o).val())})),n},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach((function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))})),t.join("&")},t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var i=t.Event("submit");this.eq(0).trigger(i),i.isDefaultPrevented()||this.get(0).submit()}return this},function(t){"__proto__"in{}||t.extend(t.zepto,{Z:function(e,i){return e=e||[],t.extend(e,t.fn),e.selector=i||"",e.__Z=!0,e},isZ:function(e){return"array"===t.type(e)&&"__Z"in e}});try{getComputedStyle(void 0)}catch(t){var e=getComputedStyle;window.getComputedStyle=function(t){try{return e(t)}catch(t){return null}}}}(e),e}();e.default=r},701:function(t){var e;function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===i(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r={singleAd:{name:"singleAd",playerType:"singleAd",priority:1,defaultConfigFile:"./SingleAd/DefaultSingleAdConfig",unitsConfigFiles:(e={FEED_MANAGER:"./SingleAd/units/SingleAdFeedManagerConfig",FEED_MANAGER_MOBILE:"./SingleAd/units/SingleAdFeedManagerConfig",WIDGET_ITEM:"./SingleAd/units/SingleAdWidgetItemConfig",WIDGET_ITEM_MOBILE:"./SingleAd/units/SingleAdWidgetItemConfig",INLINE_INSTREAM:"./SingleAd/units/SingleAdInlineConfig",INLINE_MOBILE:"./SingleAd/units/SingleAdInlineConfig"},n(e,"WIDGET_ITEM_MOBILE","./SingleAd/units/SingleAdWidgetItemConfig"),n(e,"SLIDER_INSTREAM","./SingleAd/units/SingleAdSliderConfig"),n(e,"SLIDER_MOBILE","./SingleAd/units/SingleAdSliderConfig"),e)},rv:{name:"rv",priority:3},adjacency:{name:"adjacency",playerType:"adjacencyAd",priority:2,defaultConfigFile:"./Adjacency/DefaultAdjacencyConfig.js",unitsConfigFiles:{FEED_MANAGER:"./Adjacency/units/AdjacFeedManagerConfig.js",FEED_MANAGER_MOBILE:"./Adjacency/units/AdjacFeedManagerConfig.js",WIDGET_ITEM:"./Adjacency/units/AdjacencyWidgetItemConfig",WIDGET_ITEM_MOBILE:"./Adjacency/units/AdjacencyWidgetItemConfig",RECO_REEL_WIDGET:"./Adjacency/units/AdjacencyRecoReelWidgetConfig.js"}},hip:{name:"hip",playerType:"hipAd",defaultConfigFile:"./Hip/DefaultHipConfig.js",unitsConfigFiles:{FEED_MANAGER:"./Hip/units/HipFeedManagerConfig.js",FEED_MANAGER_MOBILE:"./Hip/units/HipFeedManagerConfig.js"}},replayable:{name:"replayable",defaultConfigFile:"./Replayable/DefaultReplayableConfig.js",unitsConfigFiles:{FEED_MANAGER:"./Replayable/units/ReplayableAdFeedManagerConfig.js",FEED_MANAGER_MOBILE:"./Replayable/units/ReplayableAdFeedManagerConfig.js",INLINE_INSTREAM:"./Replayable/units/ReplayableAdInlineConfig.js",INLINE_MOBILE:"./Replayable/units/ReplayableAdInlineConfig.js",WIDGET_ITEM:"./Replayable/units/ReplayableAdWidgetItemConfig.js",WIDGET_ITEM_MOBILE:"./Replayable/units/ReplayableAdWidgetItemConfig.js"},priority:4}};t.exports=r},914:function(t,e,i){"use strict";i.r(e);var n=i(5545),r=i(2447),o=i(701),s=i.n(o);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==a(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===a(o)?o:String(o)),n)}var r,o}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=d(t);if(e){var r=d(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}var h,f=i(1999),p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(d,t);var e,r,o,a=u(d);function d(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(e=a.call(this)).model=t.model||{},e.log=new n.Z({unitType:e.model.get("unitType"),className:constructor.name,version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.configHierarchy=e._getConfigHierarchy(),e}return e=d,(r=[{key:"_getConfigHierarchy",value:function(){return f.sortBy(s(),(function(t){return t.priority})).reverse()}},{key:"getConfig",value:function(t){var e={};for(var i in this.configHierarchy){var n=this.configHierarchy[i].name,r=t[n],o=s()[n];r&&o&&(this.log.info("creating config for",n),f.extend(e,this._getDefaultConfig(n)),f.extend(e,this._getUnitConfig(n)))}return e}},{key:"getConfigForKey",value:function(t){var e={},i=s()[t]&&s()[t].name;return i&&(this.log.info("creating config for",i),f.extend(e,this._getDefaultConfig(i)),f.extend(e,this._getUnitConfig(i))),e}},{key:"_getDefaultConfig",value:function(t){var e=s()[t].defaultConfigFile;return this.loadFile(e)}},{key:"_getUnitConfig",value:function(t){var e=this.model.get("unitType"),i=s()[t]&&s()[t].unitsConfigFiles,n=i&&i[e];return this.loadFile(n)}},{key:"loadFile",value:function(t){if(t)return i(7418)("./".concat(t.replace("./","").replace(".js",""))).default}}])&&l(e.prototype,r),o&&l(e,o),Object.defineProperty(e,"prototype",{writable:!1}),d}(r.O),m=function(t){return h||(h=new p(t)),h};e.default=m},5449:function(t,e,i){"use strict";i.r(e);e.default={"stickyCard.isActive":!1,"stickyCard.restrictions.adTypeNotAllowed":!0}},8699:function(t,e,i){"use strict";i.r(e);e.default={setAdConfigAfter:"onAdSetToUnits",revertAfter:"_adVideoEnd",isNeedAdjacCard:!0,adjacCardPlacement:1}},256:function(t,e,i){"use strict";i.r(e);e.default={isReplayAd:!0,isMultiAd:!1}},1152:function(t,e,i){"use strict";i.r(e);e.default={setAdConfigAfter:"onAdSetToUnits",isTakeoverWidget:!0,isForceDontDie:!0,"detachToSlider.isDetachToSlider":!1,isMultiAd:!1,isReplayAd:!0,isKeepViewOnMidroll:!0}},3912:function(t,e,i){"use strict";i.r(e);e.default={}},4279:function(t,e,i){"use strict";i.r(e);e.default={setAdConfigAfter:"onAdSetToUnits",revertAfter:"_adVideoEnd","stickyCard.isActive":!1,"stickyCard.restrictions.adTypeNotAllowed":!0,hipCardPlacement:1,isNeedHipCard:!0,isNeedAdjacCard:!0,adjacCardPlacement:1}},7613:function(t,e,i){"use strict";i.r(e);e.default={}},7723:function(t,e,i){"use strict";i.r(e);e.default={setAdConfigAfter:"setSubModel",isReplayable:!0}},3353:function(t,e,i){"use strict";i.r(e);e.default={isReplayable:!0}},6333:function(t,e,i){"use strict";i.r(e);e.default={isReplayable:!0}},7507:function(t,e,i){"use strict";i.r(e);e.default={isMultiAd:!1}},9579:function(t,e,i){"use strict";i.r(e);e.default={setAdConfigAfter:"setSubModel",isPlacementSingleAd:!0,"continueToPlayInNexCard.isActive":!1}},3205:function(t,e,i){"use strict";i.r(e);e.default={isMultiAd:!1,isReplayAd:!0}},7642:function(t,e,i){"use strict";i.r(e);e.default={isReplayAd:!0}},6505:function(t,e,i){"use strict";i.r(e);e.default={setAdConfigAfter:"onAdSetToUnits",stopPredicts:!0,isKeepViewOnMidroll:!0,isKeepUnitOnMidroll:!0,isPlacementSingleAd:!0,isReplayAd:!0,isPreventNextAd:!0}},3879:function(t,e,i){"use strict";var n=i(9288),r=i.n(n),o=(i(2782),i(5545)),s=i(5264),a=i.n(s),l=i(2130),c=i.n(l),u=i(9831),d=i.n(u),h=(i(9861),i(1999));e.Z=r().DeepModel.extend({STATE:{READY:0,GOT_AD:1,PLAYING:2,PAUSED:3,PAUSED_BY_USER:4,STOPPED_BY_USER:5,DETACHED:6,ATTACHED:7,DONE:8,PLAYER_READY:9,PLAYER_CLOSE:10,PLAYER_STOP:11,AD_STOPPED:12,OPT_OUT:13,OPEN_WITH_PAUSE:14,WAITING_FOR_EXPAND:15,REPEAT_STAND_BY:16,REPEAT_SPINNING:17,SKIPPED_BY_USER:18},defaults:{isDebug:!1},storage:{},initialize:function(){this.log=new o.Z({unitType:this.get("unitType"),className:"BaseUnitModel",version:this.get("version"),isDebug:this.get("isDebug")}),this._parseFrameType();var t=this.get("demo");t&&this.set("preset.demo",t),this.get("isDebug")&&this.set("preset.isDebug",1);var e=this.get("isFireAllPixels");e&&this.set("preset.isFireAllPixels",e);var i=this.get("predictorsPresets");i&&this.set("preset.predictorsPresets",i);var n=this._getSettingsByConditions();this.set(n.preset);var r=this._getPresets(a().pms);for(var s in this.log.info("Presets Settings: ",[r.weakerThenSetByCon,r.strongerThenSetByCon]),r.weakerThenSetByCon)this.set(r.weakerThenSetByCon[s].presetData);for(var l in this.set(n.settings),r.strongerThenSetByCon)this.set(r.strongerThenSetByCon[l].presetData);this._setUrlParameters(),this._processPushArray(),this.get("baseReport")&&this.get("oppsBasePath)")&&this.set("oppsBasePath",this.get("baseReport")),this.set("isUseObserverChanged",!1),this.get("isUseObserver")&&!h.isObserverSupported("IntersectionObserver",this.get("isUseNonNativeObserver"))&&(this.set("isUseObserver",!1),this.set("isUseObserverChanged",!0)),this.get("isUseObserverForCardLocator")&&!h.isObserverSupported("IntersectionObserver",this.get("isUseNonNativeObserver"))&&this.set("isUseObserverForCardLocator",!1),this.volume=this.get("volume"),this.set("volume","off"),this._bindEvents(),this.log.info("unit model created:",this.attributes),this._handleABTest(),this._handleLiteUnitPixels(),(this.get("isApiPassbackExist")||this.get("onPassback"))&&(this.set("dlywf",!1),this.set("player.settings.rvfrquesttsemttr","any")),"body"===String(this.get("videoContainerSelector")).toLowerCase()&&this.set("videoContainerSelector",!1),this._setQueriesFunctions(),this._setCrossUnitCommunication(),this.get("isChangePredictPointsWithAny")&&this._changeAnyToZeroInPredictors(),this.get("disableAttachWhenStartFromSlider")&&this._decideSuperSlider(),!0===this.get("isGetRv1OnlyForEligible")&&(this.set("isGetRv1OnlyForEligible.isActive",!0),this.set("isGetRv1OnlyForEligible.delayPrediction",!0))},get:function(t){var e=r().DeepModel.prototype.get.call(this,t);if(!e||"string"!=typeof e)return e;for(var i=e.match(/\{\{(.*?)\}\}/g);i;){for(var n=0;n<i.length;n++){var o=i[n].substr(2,i[n].length-4),s=r().DeepModel.prototype.get.call(this,o);s||(s=""),e=e.replace(i[n],s)}i=e.match(/\{\{(.*?)\}\}/g)}return e},_setQueriesFunctions:function(){var t=this;h.forEach(c().UNIT_QUERY_LANGUAGE.SUPPORTED_CONFIG_FLAGS,(function(e){var i=t.get("".concat(e,".restrictions"));h.forEach(i,(function(i,n,r){var o="".concat(e,".restrictions.").concat(n),s=t.get("".concat(o,".queries"));if(s){var a=t.get("".concat(o,".default"));a=h.isBoolean(a)?a:'"'.concat(a,'"');var l=t._getQueryFunction(s,a);t.set("".concat(o,".decisionFunction"),l)}}))}))},_getQueryFunction:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n="";h.forEach(t,(function(t){n+=e._getQueryIfStatment(t)})),i=void 0!==i?"return ".concat(i,";"):"";var r="".concat(n,"\n").concat(i);return new Function("model","activeAd",r)},_getQueryIfStatment:function(t){var e=t.rule,i=t.valueIfTrue;return i=h.isBoolean(i)?i:'"'.concat(i,'"'),h.forEach(c().UNIT_QUERY_LANGUAGE.MAPPING,(function(t){e=e.split(t.search).join(t.replaceWith)}),this),"if(".concat(e,"){return ").concat(i,"};\n")},getPixel:function(t){!this.pixel&&this._createPixel();var e=this.get(t);if("pixels.conversion"===t&&r().trigger("global:creativeEvent",{type:"conversion"}),e&&e.isFire)return this.pixel({type:e.type||"",pixelId:e.id,timestamp:Date.now(),subUnit:this.get("subUnitType")})},_createPixel:function(){var t=this.get("pixels.url")+"?cijs=convusmp&ttype={{type}}&cisd=convusmp&cipid="+this.get("cipid")+"&crid="+this.get("creativeId")+"&dast="+this.get("dast")+"&cmcv=&pix={{pixelId}}&cb={{timestamp}}&uv="+this.get("unitVersion")+"&tms={{timestamp}}&su={{subUnit}}";this.get("abTest")&&(t+="&abt="+this.get("abTest")),this.get("referrerUrl")&&(t+="&ru="+this.get("referrerUrl")),t+="&ft="+this.get("frameType"),t=this._addPixelParameter("tagCpmFloor","cft",t),t=this._addPixelParameter("unitId","blid",t),t=this._addPixelParameter("unitName","unm",t),t=this._addPixelParameter("debugKey1","dk1",t),t=this._addPixelParameter("debugKey2","dk2",t),t=this._addPixelParameter("order","order",t),this.pixel=h.template(t)},_addPixelParameter:function(t,e,i){return(this.get(t)||0===this.get(t)||!1===this.get(t))&&(i+="&"+e+"="+this.get(t)),i},getImpressionPixel:function(){this.get("player.isFire99")},_getSchedule:function(t,e,i){return{roll_type:t,url:this.get("player.urls.vpaidLocation"),volume:"on"===this.get("volume")?100:0,mute:"on"!==this.get("volume"),oid:this.get("originId"),mfp:this.get("mfp"),sortOrderType:this.get("sortOrderType"),ad_parameters:JSON.stringify(this.get("demandConfig")),pubid:e,tagid:i,defaultTagTimeout:this.get("defaultTagTimeout"),totaltimeout:this.get("totalTimeout"),noaop:this.get("noaop"),skip_vast:!0}},_handleABTest:function(){if(this.get("abTest")&&this.get("pixels.startWithABT.isFire")){window.cmTag.customDataForTest.startWithABT=!0;var t={debug:"pn:!sqg:!torgn:"+(window.performance.timeOrigin?window.performance.timeOrigin:"")+"!ts:"+Date.now()};h.firePixel(this.getPixel("pixels.startWithABT"),"AB Test started",t)}},_handleLiteUnitPixels:function(){this.get("isFirePixel")&&(h.firePixel(this.getPixel("pixels.unitLoaded"),"Unit loaded from lite unit",{mntl:this.get("preset.level")}),h.firePixel(this.getPixel("pixels.unitLoadedWithFill"),"Unit loaded from lite unit with fill"))},_processPushArray:function(){var t=this.get("pushedArr")||[];"FEED_MANAGER"!==this.get("unitType")&&"INLINE_FEED"!==this.get("unitType")&&"MSN_WIDGET"!==this.get("unitType")&&"WIDGET_ITEM"!==this.get("unitType")||this._setFeedManagerSubType(t);var e={};if(t)for(var i in t.forEach((function(t){var i=Object.keys(t)[0];e[i]||(e[i]=[]),e[i].push(t[i])})),e){var n=e[i],r=this.get(i);r&&n.push(r);var o=n.sort().join("!");this.set(i,o)}},_setFeedManagerSubType:function(t){var e=this.get("stickyCard.isActive"),i=this.get("detachToSlider.isDetachBelow"),n=this.get("detachToSlider.isDetachAbove"),r=this.get("detachToSlider.isStartFromSlider"),o=this.get("detachToSlider.isDetachToSlider"),s="ufm";e||r||o?e||!r||o?e||r||!o?!e&&r&&o?s+="_vD":e&&i&&!n?s+="_vE":e&&!i&&n?s+="_vF":e&&i&&n&&(s+="_vG"):s+="_vC":s+="_vB":s+="_vA",t.push({abTest:s})},_removeSoundOnHover:function(){var t,e=this.get("wurfl.browser.name").toLowerCase(),i=this.get("wurfl.browser.version"),n=this.get("noSoundBrowsers");n&&n[e]&&(t=n[e].minVersion),i>=t&&this.set("volume","off")},setStorage:function(t,e){this.storage[t]=e},getStorage:function(t){return this.storage[t]},setNextAd:function(t){this.setStorage("nextAd",t)},setNextSliderCutOffAd:function(t){this.setStorage("nextSliderCutOffAd",t)},getNextSliderCutOffAd:function(){var t=this.getStorage("nextSliderCutOffAd");return this.setNextSliderCutOffAd(void 0),t},peekNextSliderCutOffAd:function(){return this.getStorage("nextSliderCutOffAd")},getNextAd:function(){var t=this.getStorage("nextAd");return t&&(this.log.info("NEXT AD TYPE = "+parseInt(t.adData.requiredViewability?"1":"0"),t),t.isUsed=!0),this.setStorage("nextAd",void 0),setTimeout(this.set.bind(this,"hasReadyAd",!1),0),t},getNextAdRv:function(){var t=this.getStorage("nextAd");if(t)return t.adData.requiredViewability},peekNextAd:function(){return this.getStorage("nextAd")},_bindEvents:function(){this.on("change:getAdState",this._onAdImpression)},_onAdImpression:function(){"gotAd"!==this.get("getAdState")||this._gotAd||(this.log.info("Triggering filledImpression event."),r().trigger("filledImpression",{lineItemId:this.get("lineItemId"),placement:this.get("placement"),redId:this.get("redId")}),this._gotAd=!0)},_setUrlParameters:function(){for(var t,e,i,n=this._getWindow(),r=n.location.href.slice(n.location.href.indexOf("?")+1).split("&"),o=0;o<r.length;o++)0===(e=(t=r[o].split("="))[0]).indexOf("cm_")&&(e=e.slice(3),i=decodeURIComponent(t[1]),this.set(e,i))},_getWindow:function(){var t=this.get("isStayInIframe"),e=this.get("iframeData");return!0===t&&h.isInFriendlyIframe(e)||!h.getTopWindow?window:h.getTopWindow()},_getPresets:function(t){var e={strongerThenSetByCon:[],weakerThenSetByCon:[]},i=this.get("isMobile")?"Mobile":"Desktop";for(var n in this.get("preset")){var r=t.getPreset({key:n,value:this.get("preset.".concat(n)),unitType:this.get("unitName"),platform:i});r&&(r.strength>100?e.strongerThenSetByCon.push(r):e.weakerThenSetByCon.push(r))}return e.strongerThenSetByCon=h.sortBy(e.strongerThenSetByCon,"strength"),e.weakerThenSetByCon=h.sortBy(e.weakerThenSetByCon,"strength"),e},increaseCounter:function(t){var e=this.get(t);e?e++:e=1,this.set(t,e)},decreaseCounter:function(t){var e=this.get(t);!e||e<=0||(e--,this.set(t,e))},_parseFrameType:function(){var t=c().FRAME_TYPE.plainPage;void 0!==window.taboolaMobile?t=c().FRAME_TYPE.inApp:window.TRC&&window.TRC.isAMP?t=c().FRAME_TYPE.amp:h.isInIframe(this.get("iframeData"))&&(t=h.isInFriendlyIframe(this.get("iframeData"))?c().FRAME_TYPE.friendlyIframe:c().FRAME_TYPE.nonFriendlyIframe),this.set("frameType",t),this.set("player.settings.frameType",t)},_getSettingsByConditions:function(){var t={preset:{},settings:{}},e=this.get("settingsByConditions");if(e&&e.length>0)for(var i=0;i<e.length;i++){var n=e[i].conditions,r=e[i].settings;if(this._checkConditions(n))for(var o in r)-1!==o.indexOf("preset")?t.preset[o]=r[o]:t.settings[o]=r[o]}return t},_checkConditions:function(t){for(var e=!0,i=0;i<t.length;i++)if(t[i].func)t[i].func(this)||(e=!1);else if(t[i].val&&"function"==typeof t[i].val){var n=t[i].val(this);this.get(t[i].key)!==n&&(e=!1)}else this.get(t[i].key)!==t[i].val&&(e=!1);return e},fireUnitDelayedPixel:function(){h.firePixel(this.getPixel("pixels.unitDelayed"),"unit delayed")},fireUnitLoadAfterDelayPixel:function(){h.firePixel(this.getPixel("pixels.unitLoadAfterDelay"),"unit delayed")},isLoadcomponent:function(t,e){return this.get("displayFiller."+e)===t},appendArray:function(t,e,i){var n=this.get(t);h.isArray(n)||(n=[]),i&&n.includes(e)||(n.push(e),this.set(t,n))},handleAutoPlayData:function(t){this.log.info("autoplayDetector returned",t),this.set("AutoPlayDetectorData",t),t&&t.unmuted&&t.unmuted.supported?(this.set("volume",this.volume),this.set("autoplaySoundOn",!0)):(this.set("volume","off"),this.set("autoplaySoundOn",!1)),this.log.info("Unit set volume to: ",this.get("volume"))},_setStickyCardParams:function(){this.set("detachToSlider.isDetachAbove",!1),this.set("detachToSlider.isDetachBelow",!0),this.set("detachToSlider.isDetachToSlider",!0),this.set("detachToSlider.isStartFromSlider",!1),this.set("animation.detach",this.get("stickyCard.detachAnimationTime"))},_setCrossUnitCommunication:function(){if(this.get("isUseCrossUnitCommunication")){if(0===document.querySelectorAll("._cm-communication-input").length){var t=document.createElement("div");t.className="_cm-communication-input",t.setAttribute("data-unit-info",""),document.querySelector("body").appendChild(t)}this._observeCrossUnitCommunication()}},_observeCrossUnitCommunication:function(){if(this.get("isObserveCrossUnitCommunication")){var t=document.querySelector("._cm-communication-input");this.crossUnitCommunicatioObserver=new MutationObserver(this._updateCrossUnitData.bind(this)),this.crossUnitCommunicatioObserver.observe(t,{attributes:!0,childList:!1,subtree:!1}),this.on("closeState:".concat(d().closeState.terminate),this._stopCrossUnitCommunicationObserver),this._updateCrossUnitData()}},_updateCrossUnitCommunication:function(t){this.get("isUseCrossUnitCommunication")&&this.get("isUpdateCrossUnitCommunication")&&document.querySelector("._cm-communication-input").setAttribute("data-cross-unit-info",JSON.stringify(t))},_updateCrossUnitData:function(t,e){var i=document.querySelector("._cm-communication-input").dataset.crossUnitInfo;i&&i.unit!==this.get("unitType")&&this.set("crossUnitInfo",JSON.parse(i))},_stopCrossUnitCommunicationObserver:function(){this.crossUnitCommunicatioObserver.disconnect()},fireCancelGetAdOnEligibilityLost:function(){h.firePixel(this.getPixel("pixels.cancelGetAdOnEligibilityLost"),"cancel GetAd on EligibilityLost")},_changeAnyToZeroInPredictors:function(){var t=this,e=this.get("predictors");e&&(Object.keys(e).forEach((function(i){var n=e[i].predictPoints,r=e[i].predictPoint,o=e[i].allowedPredictPoints;n&&(e[i].predictPoints=t._validateAndChangePredictPointsIfAny(n)),o&&(e[i].allowedPredictPoints=t._validateAndChangePredictPointsIfAny(o)),r&&(e[i].predictPoint=t._validateAndChangePredictPointsIfAny(r))})),this.set("predictors",{}),this.set("predictors",e))},_validateAndChangePredictPointsIfAny:function(t){return"string"==typeof t&&"any"===t.toLowerCase()?0:t},_decideSuperSlider:function(){this.get("detachToSlider.isStartFromSlider")&&this.set("detachToSlider.isDetachToSlider",!0)}})},9836:function(t,e,i){var n=i(9288);i(1999);t.exports=n.View.extend({className:"_cm-detach",events:{"click ":"_onClick"},initialize:function(t){this.container=t.container,this._rendered=!1},render:function(){if(!this._rendered){var t=this.model.get("components.DetachButtonView.imageLocation");this.$el.css("background-image",'url("'+t+'") !important'),this.container.appendChild(this.el)}},_onClick:function(){this.$el.trigger("cm:detach:click")},hide:function(){this.$el.hide()}})},6042:function(t,e,i){"use strict";var n=i(9288),r=i(9306);t.exports=n.Collection.extend({model:r})},9306:function(t,e,i){"use strict";var n=i(9288);t.exports=n.DeepModel.extend({defaults:{id:0,filename:"",image:"",title:"",vidlength:"",active:!1,clicked:!1}})},2348:function(t,e,i){"use strict";var n=i(9477);e.Z=n.Z.extend({initialize:function(){n.Z.prototype.initialize.call(this),this.isHipMode()?(this.set("tempPredictors",this.get("predictors")),this.set("predictors",{}),this.set("predictors",this.get("hipPredictors")),this.set("isHipMode",!0)):this.set("isHipMode",!1)},isHipMode:function(){return(!TRC.trcHipContainersShowing||!TRC.trcHipContainersShowing[this.get("rboxContainerId")])&&(this.get("isHip")&&this.get("isAdjacInFirstWF"))},setPredictorsToNonHIP:function(){this.set("predictors",{}),this.set("predictors",this.get("tempPredictors"))}})},9477:function(t,e,i){"use strict";var n=i(3879),r=(i(9831),i(2130)),o=i.n(r);e.Z=n.Z.extend({initialize:function(){n.Z.prototype.initialize.call(this),this.set("player.playlist",[{url:this.get("player.urls.blankLocation"),name:"Blank",title:"Blank",type:"video/mp4"}]),this.get("frameType")!==o().FRAME_TYPE.plainPage&&(window.taboolaBridge||(this.set("predictors.distancePixels.isActive",!1),this.set("predictors.distancePixels.isStartWF",!1)),this.set("predictors.distancePercent.isActive",!1),this.set("predictors.distancePercent.isStartWF",!1)),window.category=this.get("category")},getScheduleArr:function(){var t=[];return t.push(this._getSchedule("pre-roll",this.get("pubId"),this.get("pubTagId"))),t},_onContentLoad:function(){window.playlist.forEach((function(t,e,i){i[e].image=this.get("player.urls.contentImagesLocation")+"/"+t.image,i[e].title=t.title.replace(/([A-Z])/g,"$1").replace(/^./,(function(t){return t.toUpperCase()})),i[e].url=this.get("player.urls.organicContentVideosLocation")+"/"+i[e].filename,i[e].name=i[e].filename,i[e].type="video/mp4"}),this),this.set("player.playlist",window.playlist)},isVerticalVideoEnabled:function(t){return(t||this.get("videoPlaceholderSize.width"))<=this.get("verticalWidthThreshold")}})},2363:function(t,e,i){"use strict";var n=i(2130),r=i.n(n),o=i(2348);e.Z=o.Z.extend({initialize:function(){o.Z.prototype.initialize.call(this),this.get("frameType")!==r().FRAME_TYPE.plainPage&&(this.set("predictors.isUseWidgetSelector",!0),this.set("detachToSlider.isDetachToSlider",!1));var t=this.get("frameType")===r().FRAME_TYPE.plainPage;this.get("stickyCard.isActive")&&t?(this.set("detachToSlider.isDetachAbove",!1),this.set("detachToSlider.isDetachBelow",!0),this.set("detachToSlider.isDetachToSlider",!0),this.set("detachToSlider.isStartFromSlider",!1)):this.set("stickyCard.isActive",!1),this.get("width")&&0!==this.get("width")||!this.get("isOverrideWidthOnZero")||(this.set("width",300),this.set("isFitToSize",!0)),this.get("isForceStopObserver")&&this.get("frameType")===r().FRAME_TYPE.plainPage&&this.set("isUseObserver",!1)}})},5867:function(t,e,i){"use strict";var n=i(2130),r=i.n(n),o=i(2348);e.Z=o.Z.extend({initialize:function(){o.Z.prototype.initialize.call(this),this.get("frameType")!==r().FRAME_TYPE.plainPage&&(this.set("predictors.isUseWidgetSelector",!0),this.set("detachToSlider.isDetachToSlider",!1)),this.get("width")&&0!==this.get("width")||!this.get("isOverrideWidthOnZero")||(this.set("width",300),this.set("isFitToSize",!0)),this.set("stickyCard.isActive",!1),this.get("isForceStopObserver")&&this.get("frameType")===r().FRAME_TYPE.plainPage&&this.set("isUseObserver",!1)}})},2023:function(t,e,i){"use strict";i.r(e);e.default='<div class="_cm-timer-circle"> <div class="_cm-timer-mask _cm-timer-full"> <div class="_cm-timer-fill"></div> </div> <div class="_cm-timer-mask _cm-timer-half"> <div class="_cm-timer-fill"></div> <div class="_cm-timer-fill _cm-timer-fix"></div> </div> </div> <div class="_cm-timer-inset"> <span></span> </div> '},6609:function(t,e,i){"use strict";function n(t){var e=arguments.length,i=void 0,n=void 0;for(i=1;i<e;i++)for(n in arguments[i])t[n]=arguments[i][n];return t}function r(t,e){var i,r,o=arguments.length,s=void 0;for(t.prototype=(i=e.prototype,(r=function(){}).prototype=i,new r),t.prototype.constructor=t,s=2;s<o;s++)n(t.prototype,arguments[s]);return t}t=i.hmd(t);var o=["<nothing>"],s="end",a="value",l="error",c="any";function u(t,e){var i=void 0,n=void 0,r=void 0,o=void 0;if(0===t.length)return e;if(0===e.length)return t;for(o=0,i=new Array(t.length+e.length),n=t.length,r=0;r<n;r++,o++)i[o]=t[r];for(n=e.length,r=0;r<n;r++,o++)i[o]=e[r];return i}function d(t,e){var i=t.length,n=void 0;for(n=0;n<i;n++)if(t[n]===e)return n;return-1}function h(t,e){var i=t.length,n=void 0;for(n=0;n<i;n++)if(e(t[n]))return n;return-1}function f(t){var e=t.length,i=new Array(e),n=void 0;for(n=0;n<e;n++)i[n]=t[n];return i}function p(t,e){var i=t.length,n=void 0,r=void 0,o=void 0;if(e>=0&&e<i){if(1===i)return[];for(n=new Array(i-1),r=0,o=0;r<i;r++)r!==e&&(n[o]=t[r],o++);return n}return t}function m(t,e){var i=t.length,n=new Array(i),r=void 0;for(r=0;r<i;r++)n[r]=e(t[r]);return n}function y(t,e,i){t===c?e(i):t===i.type&&(t===a||t===l?e(i.value):e())}function g(){this._items=[],this._spies=[],this._inLoop=0,this._removedItems=null}function v(){this._dispatcher=new g,this._active=!1,this._alive=!0,this._activating=!1,this._logHandlers=null,this._spyHandlers=null}function b(){v.call(this)}function _(){v.call(this),this._currentEvent=null}n(g.prototype,{add:function(t,e){return this._items=u(this._items,[{type:t,fn:e}]),this._items.length},remove:function(t,e){var i=h(this._items,(function(i){return i.type===t&&i.fn===e}));return 0!==this._inLoop&&-1!==i&&(null===this._removedItems&&(this._removedItems=[]),this._removedItems.push(this._items[i])),this._items=p(this._items,i),this._items.length},addSpy:function(t){return this._spies=u(this._spies,[t]),this._spies.length},removeSpy:function(t){return this._spies=p(this._spies,this._spies.indexOf(t)),this._spies.length},dispatch:function(t){this._inLoop++;for(var e=0,i=this._spies;null!==this._spies&&e<i.length;e++)i[e](t);for(var n=0,r=this._items;n<r.length&&null!==this._items;n++)null!==this._removedItems&&(o=this._removedItems,s=r[n],-1!==d(o,s))||y(r[n].type,r[n].fn,t);var o,s;this._inLoop--,0===this._inLoop&&(this._removedItems=null)},cleanup:function(){this._items=null,this._spies=null}}),n(v.prototype,{_name:"observable",_onActivation:function(){},_onDeactivation:function(){},_setActive:function(t){this._active!==t&&(this._active=t,t?(this._activating=!0,this._onActivation(),this._activating=!1):this._onDeactivation())},_clear:function(){this._setActive(!1),this._dispatcher.cleanup(),this._dispatcher=null,this._logHandlers=null},_emit:function(t,e){switch(t){case a:return this._emitValue(e);case l:return this._emitError(e);case s:return this._emitEnd()}},_emitValue:function(t){this._alive&&this._dispatcher.dispatch({type:a,value:t})},_emitError:function(t){this._alive&&this._dispatcher.dispatch({type:l,value:t})},_emitEnd:function(){this._alive&&(this._alive=!1,this._dispatcher.dispatch({type:s}),this._clear())},_on:function(t,e){return this._alive?(this._dispatcher.add(t,e),this._setActive(!0)):y(t,e,{type:s}),this},_off:function(t,e){this._alive&&(0===this._dispatcher.remove(t,e)&&this._setActive(!1));return this},onValue:function(t){return this._on(a,t)},onError:function(t){return this._on(l,t)},onEnd:function(t){return this._on(s,t)},onAny:function(t){return this._on(c,t)},offValue:function(t){return this._off(a,t)},offError:function(t){return this._off(l,t)},offEnd:function(t){return this._off(s,t)},offAny:function(t){return this._off(c,t)},observe:function(t,e,i){var n=this,r=!1,o=t&&"function"!=typeof t?t:{value:t,error:e,end:i},c=function(t){t.type===s&&(r=!0),t.type===a&&o.value?o.value(t.value):t.type===l&&o.error?o.error(t.value):t.type===s&&o.end&&o.end(t.value)};return this.onAny(c),{unsubscribe:function(){r||(n.offAny(c),r=!0)},get closed(){return r}}},_ofSameType:function(t,e){return t.prototype.getType()===this.getType()?t:e},setName:function(t,e){return this._name=e?t._name+"."+e:t,this},log:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.toString(),e=void 0,i=function(i){var n="<"+i.type+(e?":current":"")+">";i.type===s?console.log(t,n):console.log(t,n,i.value)};return this._alive&&(this._logHandlers||(this._logHandlers=[]),this._logHandlers.push({name:t,handler:i})),e=!0,this.onAny(i),e=!1,this},offLog:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.toString();if(this._logHandlers){var e=h(this._logHandlers,(function(e){return e.name===t}));-1!==e&&(this.offAny(this._logHandlers[e].handler),this._logHandlers.splice(e,1))}return this},spy:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.toString(),e=function(e){var i="<"+e.type+">";e.type===s?console.log(t,i):console.log(t,i,e.value)};return this._alive&&(this._spyHandlers||(this._spyHandlers=[]),this._spyHandlers.push({name:t,handler:e}),this._dispatcher.addSpy(e)),this},offSpy:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.toString();if(this._spyHandlers){var e=h(this._spyHandlers,(function(e){return e.name===t}));-1!==e&&(this._dispatcher.removeSpy(this._spyHandlers[e].handler),this._spyHandlers.splice(e,1))}return this}}),v.prototype.toString=function(){return"["+this._name+"]"},r(b,v,{_name:"stream",getType:function(){return"stream"}}),r(_,v,{_name:"property",_emitValue:function(t){this._alive&&(this._currentEvent={type:a,value:t},this._activating||this._dispatcher.dispatch({type:a,value:t}))},_emitError:function(t){this._alive&&(this._currentEvent={type:l,value:t},this._activating||this._dispatcher.dispatch({type:l,value:t}))},_emitEnd:function(){this._alive&&(this._alive=!1,this._activating||this._dispatcher.dispatch({type:s}),this._clear())},_on:function(t,e){return this._alive&&(this._dispatcher.add(t,e),this._setActive(!0)),null!==this._currentEvent&&y(t,e,this._currentEvent),this._alive||y(t,e,{type:s}),this},getType:function(){return"property"}});var S=new b;function w(){return S}function T(t){function e(t,e){var i=this;b.call(this),this._wait=t,this._intervalId=null,this._$onTick=function(){return i._onTick()},this._init(e)}return r(e,b,{_init:function(){},_free:function(){},_onTick:function(){},_onActivation:function(){this._intervalId=setInterval(this._$onTick,this._wait)},_onDeactivation:function(){null!==this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null)},_clear:function(){b.prototype._clear.call(this),this._$onTick=null,this._free()}},t),e}S._emitEnd(),S._name="never";var P=T({_name:"later",_init:function(t){var e=t.x;this._x=e},_free:function(){this._x=null},_onTick:function(){this._emitValue(this._x),this._emitEnd()}});var A=T({_name:"interval",_init:function(t){var e=t.x;this._x=e},_free:function(){this._x=null},_onTick:function(){this._emitValue(this._x)}});var E=T({_name:"sequentially",_init:function(t){var e=t.xs;this._xs=f(e)},_free:function(){this._xs=null},_onTick:function(){1===this._xs.length?(this._emitValue(this._xs[0]),this._emitEnd()):this._emitValue(this._xs.shift())}});var O=T({_name:"fromPoll",_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_onTick:function(){var t=this._fn;this._emitValue(t())}});function C(t){function e(e){return t._emitValue(e),t._active}function i(e){return t._emit(e.type,e.value),t._active}return{value:e,error:function(e){return t._emitError(e),t._active},end:function(){return t._emitEnd(),t._active},event:i,emit:e,emitEvent:i}}var k=T({_name:"withInterval",_init:function(t){var e=t.fn;this._fn=e,this._emitter=C(this)},_free:function(){this._fn=null,this._emitter=null},_onTick:function(){(0,this._fn)(this._emitter)}});function I(t){b.call(this),this._fn=t,this._unsubscribe=null}function R(t){return new I(t)}function D(t,e){switch(e){case 0:return function(){return t()};case 1:return function(e){return t(e[0])};case 2:return function(e){return t(e[0],e[1])};case 3:return function(e){return t(e[0],e[1],e[2])};case 4:return function(e){return t(e[0],e[1],e[2],e[3])};default:return function(e){return t.apply(null,e)}}}r(I,b,{_name:"stream",_onActivation:function(){var t=(0,this._fn)(C(this));this._unsubscribe="function"==typeof t?t:null,this._active||this._callUnsubscribe()},_callUnsubscribe:function(){null!==this._unsubscribe&&(this._unsubscribe(),this._unsubscribe=null)},_onDeactivation:function(){this._callUnsubscribe()},_clear:function(){b.prototype._clear.call(this),this._fn=null}});var V=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"]];function N(t){this._currentEvent={type:"value",value:t,current:!0}}function x(t){return new N(t)}function j(t){this._currentEvent={type:"error",value:t,current:!0}}function M(t,e){return function(i,n){var r=this;t.call(this),this._source=i,this._name=i._name+"."+e,this._init(n),this._$handleAny=function(t){return r._handleAny(t)}}}function L(t){return{_init:function(){},_free:function(){},_handleValue:function(t){this._emitValue(t)},_handleError:function(t){this._emitError(t)},_handleEnd:function(){this._emitEnd()},_handleAny:function(t){switch(t.type){case a:return this._handleValue(t.value);case l:return this._handleError(t.value);case s:return this._handleEnd()}},_onActivation:function(){this._source.onAny(this._$handleAny)},_onDeactivation:function(){this._source.offAny(this._$handleAny)},_clear:function(){t.prototype._clear.call(this),this._source=null,this._$handleAny=null,this._free()}}}function B(t,e){var i=M(b,t);return r(i,b,L(b),e),i}function F(t,e){var i=M(_,t);return r(i,_,L(_),e),i}r(N,_,{_name:"constant",_active:!1,_activating:!1,_alive:!1,_dispatcher:null,_logHandlers:null}),r(j,_,{_name:"constantError",_active:!1,_activating:!1,_alive:!1,_dispatcher:null,_logHandlers:null});var U=F("toProperty",{_init:function(t){var e=t.fn;this._getInitialCurrent=e},_onActivation:function(){if(null!==this._getInitialCurrent){var t=this._getInitialCurrent;this._emitValue(t())}this._source.onAny(this._$handleAny)}});function W(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!==e&&"function"!=typeof e)throw new Error("You should call toProperty() with a function or no arguments.");return new U(t,{fn:e})}var H=B("changes",{_handleValue:function(t){this._activating||this._emitValue(t)},_handleError:function(t){this._activating||this._emitError(t)}});function $(){if("function"==typeof Promise)return Promise;throw new Error("There isn't default Promise, use shim or parameter")}var z=function(t){var e,i=t.Symbol;return"function"==typeof i?i.observable?e=i.observable:(e=i("observable"),i.observable=e):e="@@observable",e}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==i.g?i.g:t),q=z.default?z.default:z;function G(t){this._observable=t.takeErrors(1)}function Y(){return new G(this)}function K(t,e,i){for(var n in t)t.hasOwnProperty(n)&&(e.push(n),i.push(t[n]))}function Q(t,e,i){var n=this;b.call(this),this._activeCount=t.length,this._sources=u(t,e),this._combinator=i,this._aliveCount=0,this._latestValues=new Array(this._sources.length),this._latestErrors=new Array(this._sources.length),function(t,e){var i=t.length,n=void 0;for(n=0;n<i;n++)t[n]=e}(this._latestValues,o),this._emitAfterActivation=!1,this._endAfterActivation=!1,this._latestErrorIndex=0,this._$handlers=[];for(var r=function(t){n._$handlers.push((function(e){return n._handleAny(t,e)}))},s=0;s<this._sources.length;s++)r(s)}function Z(t,e,i){return"function"==typeof e&&(i=e,e=void 0),Array.isArray(t)?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments[2];if(!Array.isArray(e))throw new Error("Combine can only combine active and passive collections of the same type.");return i=i?D(i,t.length+e.length):function(t){return t},0===t.length?w():new Q(t,e,i)}(t,e,i):function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2];if("object"!=typeof e||Array.isArray(e))throw new Error("Combine can only combine active and passive collections of the same type.");var n=[],r=[],o=[];return K(t,n,r),K(e,n,o),0===r.length?w():new Q(r,o,(function(t){for(var e={},r=t.length-1;0<=r;r--)e[n[r]]=t[r];return i?i(e):e}))}(t,e,i)}n(G.prototype,{subscribe:function(t,e,i){var n=this,r="function"==typeof t?{next:t,error:e,complete:i}:t,o=function(t){t.type===s&&(c=!0),t.type===a&&r.next?r.next(t.value):t.type===l&&r.error?r.error(t.value):t.type===s&&r.complete&&r.complete(t.value)};this._observable.onAny(o);var c=!1;return{unsubscribe:function(){c=!0,n._observable.offAny(o)},get closed(){return c}}}}),G.prototype[q]=function(){return this},r(Q,b,{_name:"combine",_onActivation:function(){this._aliveCount=this._activeCount;for(var t=this._activeCount;t<this._sources.length;t++)this._sources[t].onAny(this._$handlers[t]);for(var e=0;e<this._activeCount;e++)this._sources[e].onAny(this._$handlers[e]);this._emitAfterActivation&&(this._emitAfterActivation=!1,this._emitIfFull()),this._endAfterActivation&&this._emitEnd()},_onDeactivation:function(){var t=this._sources.length,e=void 0;for(e=0;e<t;e++)this._sources[e].offAny(this._$handlers[e])},_emitIfFull:function(){for(var t=!0,e=!1,i=this._latestValues.length,n=new Array(i),r=new Array(i),s=0;s<i;s++)n[s]=this._latestValues[s],r[s]=this._latestErrors[s],n[s]===o&&(t=!1),void 0!==r[s]&&(e=!0);if(t){var a=this._combinator;this._emitValue(a(n))}e&&this._emitError(function(t){for(var e=void 0,i=0;i<t.length;i++)void 0!==t[i]&&(void 0===e||e.index<t[i].index)&&(e=t[i]);return e.error}(r))},_handleAny:function(t,e){e.type===a||e.type===l?(e.type===a&&(this._latestValues[t]=e.value,this._latestErrors[t]=void 0),e.type===l&&(this._latestValues[t]=o,this._latestErrors[t]={index:this._latestErrorIndex++,error:e.value}),t<this._activeCount&&(this._activating?this._emitAfterActivation=!0:this._emitIfFull())):t<this._activeCount&&(this._aliveCount--,0===this._aliveCount&&(this._activating?this._endAfterActivation=!0:this._emitEnd()))},_clear:function(){b.prototype._clear.call(this),this._sources=null,this._latestValues=null,this._latestErrors=null,this._combinator=null,this._$handlers=null}});var X={empty:function(){return w()},concat:function(t,e){return t.merge(e)},of:function(t){return x(t)},map:function(t,e){return e.map(t)},bimap:function(t,e,i){return i.mapErrors(t).map(e)},ap:function(t,e){return Z([t,e],(function(t,e){return t(e)}))},chain:function(t,e){return e.flatMap(t)}},J=Object.freeze({Observable:X}),tt={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){var e=this._fn;this._emitValue(e(t))}},et=B("map",tt),it=F("map",tt),nt=function(t){return t};function rt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nt;return new(t._ofSameType(et,it))(t,{fn:e})}var ot={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){(0,this._fn)(t)&&this._emitValue(t)}},st=B("filter",ot),at=F("filter",ot),lt=function(t){return t};var ct={_init:function(t){var e=t.n;this._n=e,e<=0&&this._emitEnd()},_handleValue:function(t){0!==this._n&&(this._n--,this._emitValue(t),0===this._n&&this._emitEnd())}},ut=B("take",ct),dt=F("take",ct);var ht={_init:function(t){var e=t.n;this._n=e,e<=0&&this._emitEnd()},_handleError:function(t){0!==this._n&&(this._n--,this._emitError(t),0===this._n&&this._emitEnd())}},ft=B("takeErrors",ht),pt=F("takeErrors",ht);var mt={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){(0,this._fn)(t)?this._emitValue(t):this._emitEnd()}},yt=B("takeWhile",mt),gt=F("takeWhile",mt),vt=function(t){return t};var bt={_init:function(){this._lastValue=o},_free:function(){this._lastValue=null},_handleValue:function(t){this._lastValue=t},_handleEnd:function(){this._lastValue!==o&&this._emitValue(this._lastValue),this._emitEnd()}},_t=B("last",bt),St=F("last",bt);var wt={_init:function(t){var e=t.n;this._n=Math.max(0,e)},_handleValue:function(t){0===this._n?this._emitValue(t):this._n--}},Tt=B("skip",wt),Pt=F("skip",wt);var At={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){var e=this._fn;null===this._fn||e(t)||(this._fn=null),null===this._fn&&this._emitValue(t)}},Et=B("skipWhile",At),Ot=F("skipWhile",At),Ct=function(t){return t};var kt={_init:function(t){var e=t.fn;this._fn=e,this._prev=o},_free:function(){this._fn=null,this._prev=null},_handleValue:function(t){var e=this._fn;this._prev!==o&&e(this._prev,t)||(this._prev=t,this._emitValue(t))}},It=B("skipDuplicates",kt),Rt=F("skipDuplicates",kt),Dt=function(t,e){return t===e};function Vt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dt;return new(t._ofSameType(It,Rt))(t,{fn:e})}var Nt={_init:function(t){var e=t.fn,i=t.seed;this._fn=e,this._prev=i},_free:function(){this._prev=null,this._fn=null},_handleValue:function(t){if(this._prev!==o){var e=this._fn;this._emitValue(e(this._prev,t))}this._prev=t}},xt=B("diff",Nt),jt=F("diff",Nt);function Mt(t,e){return[t,e]}var Lt=F("scan",{_init:function(t){var e=t.fn,i=t.seed;this._fn=e,this._seed=i,i!==o&&this._emitValue(i)},_free:function(){this._fn=null,this._seed=null},_handleValue:function(t){var e=this._fn;null===this._currentEvent||this._currentEvent.type===l?this._emitValue(this._seed===o?t:e(this._seed,t)):this._emitValue(e(this._currentEvent.value,t))}});var Bt=B("flatten",{_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){for(var e=(0,this._fn)(t),i=0;i<e.length;i++)this._emitValue(e[i])}}),Ft=function(t){return t};var Ut={},Wt={_init:function(t){var e=this,i=t.wait;this._wait=Math.max(0,i),this._buff=[],this._$shiftBuff=function(){var t=e._buff.shift();t===Ut?e._emitEnd():e._emitValue(t)}},_free:function(){this._buff=null,this._$shiftBuff=null},_handleValue:function(t){this._activating?this._emitValue(t):(this._buff.push(t),setTimeout(this._$shiftBuff,this._wait))},_handleEnd:function(){this._activating?this._emitEnd():(this._buff.push(Ut),setTimeout(this._$shiftBuff,this._wait))}},Ht=B("delay",Wt),$t=F("delay",Wt);var zt=Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},qt={_init:function(t){var e=this,i=t.wait,n=t.leading,r=t.trailing;this._wait=Math.max(0,i),this._leading=n,this._trailing=r,this._trailingValue=null,this._timeoutId=null,this._endLater=!1,this._lastCallTime=0,this._$trailingCall=function(){return e._trailingCall()}},_free:function(){this._trailingValue=null,this._$trailingCall=null},_handleValue:function(t){if(this._activating)this._emitValue(t);else{var e=zt();0!==this._lastCallTime||this._leading||(this._lastCallTime=e);var i=this._wait-(e-this._lastCallTime);i<=0?(this._cancelTrailing(),this._lastCallTime=e,this._emitValue(t)):this._trailing&&(this._cancelTrailing(),this._trailingValue=t,this._timeoutId=setTimeout(this._$trailingCall,i))}},_handleEnd:function(){this._activating?this._emitEnd():this._timeoutId?this._endLater=!0:this._emitEnd()},_cancelTrailing:function(){null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)},_trailingCall:function(){this._emitValue(this._trailingValue),this._timeoutId=null,this._trailingValue=null,this._lastCallTime=this._leading?zt():0,this._endLater&&this._emitEnd()}},Gt=B("throttle",qt),Yt=F("throttle",qt);var Kt={_init:function(t){var e=this,i=t.wait,n=t.immediate;this._wait=Math.max(0,i),this._immediate=n,this._lastAttempt=0,this._timeoutId=null,this._laterValue=null,this._endLater=!1,this._$later=function(){return e._later()}},_free:function(){this._laterValue=null,this._$later=null},_handleValue:function(t){this._activating?this._emitValue(t):(this._lastAttempt=zt(),this._immediate&&!this._timeoutId&&this._emitValue(t),this._timeoutId||(this._timeoutId=setTimeout(this._$later,this._wait)),this._immediate||(this._laterValue=t))},_handleEnd:function(){this._activating?this._emitEnd():this._timeoutId&&!this._immediate?this._endLater=!0:this._emitEnd()},_later:function(){var t=zt()-this._lastAttempt;if(t<this._wait&&t>=0)this._timeoutId=setTimeout(this._$later,this._wait-t);else{if(this._timeoutId=null,!this._immediate){var e=this._laterValue;this._laterValue=null,this._emitValue(e)}this._endLater&&this._emitEnd()}}},Qt=B("debounce",Kt),Zt=F("debounce",Kt);var Xt={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleError:function(t){var e=this._fn;this._emitError(e(t))}},Jt=B("mapErrors",Xt),te=F("mapErrors",Xt),ee=function(t){return t};var ie={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleError:function(t){(0,this._fn)(t)&&this._emitError(t)}},ne=B("filterErrors",ie),re=F("filterErrors",ie),oe=function(t){return t};var se={_handleValue:function(){}},ae=B("ignoreValues",se),le=F("ignoreValues",se);var ce={_handleError:function(){}},ue=B("ignoreErrors",ce),de=F("ignoreErrors",ce);var he={_handleEnd:function(){}},fe=B("ignoreEnd",he),pe=F("ignoreEnd",he);var me={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleEnd:function(){var t=this._fn;this._emitValue(t()),this._emitEnd()}},ye=B("beforeEnd",me),ge=F("beforeEnd",me);var ve={_init:function(t){var e=t.min,i=t.max;this._max=i,this._min=e,this._buff=[]},_free:function(){this._buff=null},_handleValue:function(t){this._buff=function(t,e,i){var n=Math.min(i,t.length+1),r=t.length-n+1,o=new Array(n),s=void 0;for(s=r;s<n;s++)o[s-r]=t[s];return o[n-1]=e,o}(this._buff,t,this._max),this._buff.length>=this._min&&this._emitValue(this._buff)}},be=B("slidingWindow",ve),_e=F("slidingWindow",ve);var Se={_init:function(t){var e=t.fn,i=t.flushOnEnd;this._fn=e,this._flushOnEnd=i,this._buff=[]},_free:function(){this._buff=null},_flush:function(){null!==this._buff&&0!==this._buff.length&&(this._emitValue(this._buff),this._buff=[])},_handleValue:function(t){this._buff.push(t),(0,this._fn)(t)||this._flush()},_handleEnd:function(){this._flushOnEnd&&this._flush(),this._emitEnd()}},we=B("bufferWhile",Se),Te=F("bufferWhile",Se),Pe=function(t){return t};var Ae={_init:function(t){var e=t.count,i=t.flushOnEnd;this._count=e,this._flushOnEnd=i,this._buff=[]},_free:function(){this._buff=null},_flush:function(){null!==this._buff&&0!==this._buff.length&&(this._emitValue(this._buff),this._buff=[])},_handleValue:function(t){this._buff.push(t),this._buff.length>=this._count&&this._flush()},_handleEnd:function(){this._flushOnEnd&&this._flush(),this._emitEnd()}},Ee=B("bufferWithCount",Ae),Oe=F("bufferWithCount",Ae);var Ce={_init:function(t){var e=this,i=t.wait,n=t.count,r=t.flushOnEnd;this._wait=i,this._count=n,this._flushOnEnd=r,this._intervalId=null,this._$onTick=function(){return e._flush()},this._buff=[]},_free:function(){this._$onTick=null,this._buff=null},_flush:function(){null!==this._buff&&(this._emitValue(this._buff),this._buff=[])},_handleValue:function(t){this._buff.push(t),this._buff.length>=this._count&&(clearInterval(this._intervalId),this._flush(),this._intervalId=setInterval(this._$onTick,this._wait))},_handleEnd:function(){this._flushOnEnd&&0!==this._buff.length&&this._flush(),this._emitEnd()},_onActivation:function(){this._intervalId=setInterval(this._$onTick,this._wait),this._source.onAny(this._$handleAny)},_onDeactivation:function(){null!==this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null),this._source.offAny(this._$handleAny)}},ke=B("bufferWithTimeOrCount",Ce),Ie=F("bufferWithTimeOrCount",Ce);var Re={_init:function(t){var e,i=t.transducer;this._xform=i((e=this,{"@@transducer/step":function(t,i){return e._emitValue(i),null},"@@transducer/result":function(){return e._emitEnd(),null}}))},_free:function(){this._xform=null},_handleValue:function(t){null!==this._xform["@@transducer/step"](null,t)&&this._xform["@@transducer/result"](null)},_handleEnd:function(){this._xform["@@transducer/result"](null)}},De=B("transduce",Re),Ve=F("transduce",Re);var Ne={_init:function(t){var e=t.fn;this._handler=e,this._emitter=C(this)},_free:function(){this._handler=null,this._emitter=null},_handleAny:function(t){this._handler(this._emitter,t)}},xe=B("withHandler",Ne),je=F("withHandler",Ne);var Me=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function Le(t,e){var i=this;b.call(this),this._buffers=m(t,(function(t){return Me(t)?f(t):[]})),this._sources=m(t,(function(t){return Me(t)?w():t})),this._combinator=e?D(e,this._sources.length):function(t){return t},this._aliveCount=0,this._$handlers=[];for(var n=function(t){i._$handlers.push((function(e){return i._handleAny(t,e)}))},r=0;r<this._sources.length;r++)n(r)}function Be(t,e){return 0===t.length?w():new Le(t,e)}r(Le,b,{_name:"zip",_onActivation:function(){for(;this._isFull();)this._emit();var t=this._sources.length;this._aliveCount=t;for(var e=0;e<t&&this._active;e++)this._sources[e].onAny(this._$handlers[e])},_onDeactivation:function(){for(var t=0;t<this._sources.length;t++)this._sources[t].offAny(this._$handlers[t])},_emit:function(){for(var t=new Array(this._buffers.length),e=0;e<this._buffers.length;e++)t[e]=this._buffers[e].shift();var i=this._combinator;this._emitValue(i(t))},_isFull:function(){for(var t=0;t<this._buffers.length;t++)if(0===this._buffers[t].length)return!1;return!0},_handleAny:function(t,e){e.type===a&&(this._buffers[t].push(e.value),this._isFull()&&this._emit()),e.type===l&&this._emitError(e.value),e.type===s&&(this._aliveCount--,0===this._aliveCount&&this._emitEnd())},_clear:function(){b.prototype._clear.call(this),this._sources=null,this._buffers=null,this._combinator=null,this._$handlers=null}});var Fe=function(t){return t};function Ue(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.queueLim,n=void 0===i?0:i,r=e.concurLim,o=void 0===r?-1:r,s=e.drop,a=void 0===s?"new":s;b.call(this),this._queueLim=n<0?-1:n,this._concurLim=o<0?-1:o,this._drop=a,this._queue=[],this._curSources=[],this._$handleSubAny=function(e){return t._handleSubAny(e)},this._$endHandlers=[],this._currentlyAdding=null,0===this._concurLim&&this._emitEnd()}function We(t){Ue.call(this),this._addAll(t),this._initialised=!0}function He(t){return 0===t.length?w():new We(t)}function $e(t){var e=this;b.call(this),this._generator=t,this._source=null,this._inLoop=!1,this._iteration=0,this._$handleAny=function(t){return e._handleAny(t)}}r(Ue,b,{_name:"abstractPool",_add:function(t,e){e=e||Fe,-1===this._concurLim||this._curSources.length<this._concurLim?this._addToCur(e(t)):-1===this._queueLim||this._queue.length<this._queueLim?this._addToQueue(e(t)):"old"===this._drop&&(this._removeOldest(),this._add(t,e))},_addAll:function(t){var e=this;!function(t,e){var i=t.length,n=void 0;for(n=0;n<i;n++)e(t[n])}(t,(function(t){return e._add(t)}))},_remove:function(t){-1===this._removeCur(t)&&this._removeQueue(t)},_addToQueue:function(t){this._queue=u(this._queue,[t])},_addToCur:function(t){if(this._active){if(!t._alive)return t._currentEvent&&this._emit(t._currentEvent.type,t._currentEvent.value),void(this._active&&(0!==this._queue.length?this._pullQueue():0===this._curSources.length&&this._onEmpty()));this._currentlyAdding=t,t.onAny(this._$handleSubAny),this._currentlyAdding=null,t._alive?(this._curSources=u(this._curSources,[t]),this._active&&this._subToEnd(t)):0!==this._queue.length?this._pullQueue():0===this._curSources.length&&this._onEmpty()}else this._curSources=u(this._curSources,[t])},_subToEnd:function(t){var e=this,i=function(){return e._removeCur(t)};this._$endHandlers.push({obs:t,handler:i}),t.onEnd(i)},_subscribe:function(t){t.onAny(this._$handleSubAny),this._active&&this._subToEnd(t)},_unsubscribe:function(t){t.offAny(this._$handleSubAny);var e=h(this._$endHandlers,(function(e){return e.obs===t}));-1!==e&&(t.offEnd(this._$endHandlers[e].handler),this._$endHandlers.splice(e,1))},_handleSubAny:function(t){t.type===a?this._emitValue(t.value):t.type===l&&this._emitError(t.value)},_removeQueue:function(t){var e=d(this._queue,t);return this._queue=p(this._queue,e),e},_removeCur:function(t){this._active&&this._unsubscribe(t);var e=d(this._curSources,t);return this._curSources=p(this._curSources,e),-1!==e&&(0!==this._queue.length?this._pullQueue():0===this._curSources.length&&this._onEmpty()),e},_removeOldest:function(){this._removeCur(this._curSources[0])},_pullQueue:function(){0!==this._queue.length&&(this._queue=f(this._queue),this._addToCur(this._queue.shift()))},_onActivation:function(){for(var t=0,e=this._curSources;t<e.length&&this._active;t++)this._subscribe(e[t])},_onDeactivation:function(){for(var t=0,e=this._curSources;t<e.length;t++)this._unsubscribe(e[t]);null!==this._currentlyAdding&&this._unsubscribe(this._currentlyAdding)},_isEmpty:function(){return 0===this._curSources.length},_onEmpty:function(){},_clear:function(){b.prototype._clear.call(this),this._queue=null,this._curSources=null,this._$handleSubAny=null,this._$endHandlers=null}}),r(We,Ue,{_name:"merge",_onEmpty:function(){this._initialised&&this._emitEnd()}}),r($e,b,{_name:"repeat",_handleAny:function(t){t.type===s?(this._source=null,this._getSource()):this._emit(t.type,t.value)},_getSource:function(){if(!this._inLoop){this._inLoop=!0;for(var t=this._generator;null===this._source&&this._alive&&this._active;)this._source=t(this._iteration++),this._source?this._source.onAny(this._$handleAny):this._emitEnd();this._inLoop=!1}},_onActivation:function(){this._source?this._source.onAny(this._$handleAny):this._getSource()},_onDeactivation:function(){this._source&&this._source.offAny(this._$handleAny)},_clear:function(){b.prototype._clear.call(this),this._generator=null,this._source=null,this._$handleAny=null}});var ze=function(t){return new $e(t)};function qe(t){return ze((function(e){return t.length>e&&t[e]})).setName("concat")}function Ge(){Ue.call(this)}function Ye(t,e,i){var n=this;Ue.call(this,i),this._source=t,this._fn=e,this._mainEnded=!1,this._lastCurrent=null,this._$handleMain=function(t){return n._handleMain(t)}}function Ke(t,e){Ye.call(this,t,e)}function Qe(t,e){return function(i,n,r){var s=this;t.call(this),this._primary=i,this._secondary=n,this._name=i._name+"."+e,this._lastSecondary=o,this._$handleSecondaryAny=function(t){return s._handleSecondaryAny(t)},this._$handlePrimaryAny=function(t){return s._handlePrimaryAny(t)},this._init(r)}}function Ze(t){return{_init:function(){},_free:function(){},_handlePrimaryValue:function(t){this._emitValue(t)},_handlePrimaryError:function(t){this._emitError(t)},_handlePrimaryEnd:function(){this._emitEnd()},_handleSecondaryValue:function(t){this._lastSecondary=t},_handleSecondaryError:function(t){this._emitError(t)},_handleSecondaryEnd:function(){},_handlePrimaryAny:function(t){switch(t.type){case a:return this._handlePrimaryValue(t.value);case l:return this._handlePrimaryError(t.value);case s:return this._handlePrimaryEnd(t.value)}},_handleSecondaryAny:function(t){switch(t.type){case a:return this._handleSecondaryValue(t.value);case l:return this._handleSecondaryError(t.value);case s:this._handleSecondaryEnd(t.value),this._removeSecondary()}},_removeSecondary:function(){null!==this._secondary&&(this._secondary.offAny(this._$handleSecondaryAny),this._$handleSecondaryAny=null,this._secondary=null)},_onActivation:function(){null!==this._secondary&&this._secondary.onAny(this._$handleSecondaryAny),this._active&&this._primary.onAny(this._$handlePrimaryAny)},_onDeactivation:function(){null!==this._secondary&&this._secondary.offAny(this._$handleSecondaryAny),this._primary.offAny(this._$handlePrimaryAny)},_clear:function(){t.prototype._clear.call(this),this._primary=null,this._secondary=null,this._lastSecondary=null,this._$handleSecondaryAny=null,this._$handlePrimaryAny=null,this._free()}}}function Xe(t,e){var i=Qe(b,t);return r(i,b,Ze(b),e),i}function Je(t,e){var i=Qe(_,t);return r(i,_,Ze(_),e),i}r(Ge,Ue,{_name:"pool",plug:function(t){return this._add(t),this},unplug:function(t){return this._remove(t),this}}),r(Ye,Ue,{_onActivation:function(){Ue.prototype._onActivation.call(this),this._active&&this._source.onAny(this._$handleMain)},_onDeactivation:function(){Ue.prototype._onDeactivation.call(this),this._source.offAny(this._$handleMain),this._hadNoEvSinceDeact=!0},_handleMain:function(t){t.type===a&&(this._activating&&this._hadNoEvSinceDeact&&this._lastCurrent===t.value||this._add(t.value,this._fn),this._lastCurrent=t.value,this._hadNoEvSinceDeact=!1);t.type===l&&this._emitError(t.value),t.type===s&&(this._isEmpty()?this._emitEnd():this._mainEnded=!0)},_onEmpty:function(){this._mainEnded&&this._emitEnd()},_clear:function(){Ue.prototype._clear.call(this),this._source=null,this._lastCurrent=null,this._$handleMain=null}}),r(Ke,Ye,{_handleMain:function(t){t.type===l&&(this._activating&&this._hadNoEvSinceDeact&&this._lastCurrent===t.value||this._add(t.value,this._fn),this._lastCurrent=t.value,this._hadNoEvSinceDeact=!1);t.type===a&&this._emitValue(t.value),t.type===s&&(this._isEmpty()?this._emitEnd():this._mainEnded=!0)}});var ti={_handlePrimaryValue:function(t){this._lastSecondary!==o&&this._lastSecondary&&this._emitValue(t)},_handleSecondaryEnd:function(){this._lastSecondary!==o&&this._lastSecondary||this._emitEnd()}},ei=Xe("filterBy",ti),ii=Je("filterBy",ti);var ni=function(t,e){return e};var ri={_handlePrimaryValue:function(t){this._lastSecondary!==o&&this._emitValue(t)},_handleSecondaryEnd:function(){this._lastSecondary===o&&this._emitEnd()}},oi=Xe("skipUntilBy",ri),si=Je("skipUntilBy",ri);var ai={_handleSecondaryValue:function(){this._emitEnd()}},li=Xe("takeUntilBy",ai),ci=Je("takeUntilBy",ai);var ui={_init:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).flushOnEnd,e=void 0===t||t;this._buff=[],this._flushOnEnd=e},_free:function(){this._buff=null},_flush:function(){null!==this._buff&&(this._emitValue(this._buff),this._buff=[])},_handlePrimaryEnd:function(){this._flushOnEnd&&this._flush(),this._emitEnd()},_onActivation:function(){this._primary.onAny(this._$handlePrimaryAny),this._alive&&null!==this._secondary&&this._secondary.onAny(this._$handleSecondaryAny)},_handlePrimaryValue:function(t){this._buff.push(t)},_handleSecondaryValue:function(){this._flush()},_handleSecondaryEnd:function(){this._flushOnEnd||this._emitEnd()}},di=Xe("bufferBy",ui),hi=Je("bufferBy",ui);var fi={_init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.flushOnEnd,i=void 0===e||e,n=t.flushOnChange,r=void 0!==n&&n;this._buff=[],this._flushOnEnd=i,this._flushOnChange=r},_free:function(){this._buff=null},_flush:function(){null!==this._buff&&(this._emitValue(this._buff),this._buff=[])},_handlePrimaryEnd:function(){this._flushOnEnd&&this._flush(),this._emitEnd()},_handlePrimaryValue:function(t){this._buff.push(t),this._lastSecondary===o||this._lastSecondary||this._flush()},_handleSecondaryEnd:function(){this._flushOnEnd||this._lastSecondary!==o&&!this._lastSecondary||this._emitEnd()},_handleSecondaryValue:function(t){this._flushOnChange&&!t&&this._flush(),this._lastSecondary=t}},pi=Xe("bufferWhileBy",fi),mi=Je("bufferWhileBy",fi);var yi=function(){return!1},gi=function(){return!0};var vi={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){var e=(0,this._fn)(t);e.convert?this._emitError(e.error):this._emitValue(t)}},bi=B("valuesToErrors",vi),_i=F("valuesToErrors",vi),Si=function(t){return{convert:!0,error:t}};var wi={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleError:function(t){var e=(0,this._fn)(t);e.convert?this._emitValue(e.value):this._emitError(t)}},Ti=B("errorsToValues",wi),Pi=F("errorsToValues",wi),Ai=function(t){return{convert:!0,value:t}};var Ei={_handleError:function(t){this._emitError(t),this._emitEnd()}},Oi=B("endOnError",Ei),Ci=F("endOnError",Ei);v.prototype.toProperty=function(t){return W(this,t)},v.prototype.changes=function(){return new H(this)},v.prototype.toPromise=function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$(),i=null;return new e((function(e,n){t.onAny((function(t){t.type===s&&null!==i?((i.type===a?e:n)(i.value),i=null):i=t}))}))}(this,t)},v.prototype.toESObservable=Y,v.prototype[q]=Y,v.prototype.map=function(t){return rt(this,t)},v.prototype.filter=function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lt;return new(t._ofSameType(st,at))(t,{fn:e})}(this,t)},v.prototype.take=function(t){return function(t,e){return new(t._ofSameType(ut,dt))(t,{n:e})}(this,t)},v.prototype.takeErrors=function(t){return function(t,e){return new(t._ofSameType(ft,pt))(t,{n:e})}(this,t)},v.prototype.takeWhile=function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vt;return new(t._ofSameType(yt,gt))(t,{fn:e})}(this,t)},v.prototype.last=function(){return new((t=this)._ofSameType(_t,St))(t);var t},v.prototype.skip=function(t){return function(t,e){return new(t._ofSameType(Tt,Pt))(t,{n:e})}(this,t)},v.prototype.skipWhile=function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ct;return new(t._ofSameType(Et,Ot))(t,{fn:e})}(this,t)},v.prototype.skipDuplicates=function(t){return Vt(this,t)},v.prototype.diff=function(t,e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o;return new(t._ofSameType(xt,jt))(t,{fn:e||Mt,seed:i})}(this,t,e)},v.prototype.scan=function(t,e){return function(t,e){return new Lt(t,{fn:e,seed:arguments.length>2&&void 0!==arguments[2]?arguments[2]:o})}(this,t,e)},v.prototype.flatten=function(t){return function(t){return new Bt(t,{fn:arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ft})}(this,t)},v.prototype.delay=function(t){return function(t,e){return new(t._ofSameType(Ht,$t))(t,{wait:e})}(this,t)},v.prototype.throttle=function(t,e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.leading,r=void 0===n||n,o=i.trailing,s=void 0===o||o;return new(t._ofSameType(Gt,Yt))(t,{wait:e,leading:r,trailing:s})}(this,t,e)},v.prototype.debounce=function(t,e){return function(t,e){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).immediate,n=void 0!==i&&i;return new(t._ofSameType(Qt,Zt))(t,{wait:e,immediate:n})}(this,t,e)},v.prototype.mapErrors=function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ee;return new(t._ofSameType(Jt,te))(t,{fn:e})}(this,t)},v.prototype.filterErrors=function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oe;return new(t._ofSameType(ne,re))(t,{fn:e})}(this,t)},v.prototype.ignoreValues=function(){return new((t=this)._ofSameType(ae,le))(t);var t},v.prototype.ignoreErrors=function(){return new((t=this)._ofSameType(ue,de))(t);var t},v.prototype.ignoreEnd=function(){return new((t=this)._ofSameType(fe,pe))(t);var t},v.prototype.beforeEnd=function(t){return function(t,e){return new(t._ofSameType(ye,ge))(t,{fn:e})}(this,t)},v.prototype.slidingWindow=function(t,e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new(t._ofSameType(be,_e))(t,{min:i,max:e})}(this,t,e)},v.prototype.bufferWhile=function(t,e){return function(t,e){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).flushOnEnd,n=void 0===i||i;return new(t._ofSameType(we,Te))(t,{fn:e||Pe,flushOnEnd:n})}(this,t,e)},v.prototype.bufferWithCount=function(t,e){return function(t,e){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).flushOnEnd,n=void 0===i||i;return new(t._ofSameType(Ee,Oe))(t,{count:e,flushOnEnd:n})}(this,t,e)},v.prototype.bufferWithTimeOrCount=function(t,e,i){return function(t,e,i){var n=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).flushOnEnd,r=void 0===n||n;return new(t._ofSameType(ke,Ie))(t,{wait:e,count:i,flushOnEnd:r})}(this,t,e,i)},v.prototype.transduce=function(t){return function(t,e){return new(t._ofSameType(De,Ve))(t,{transducer:e})}(this,t)},v.prototype.withHandler=function(t){return function(t,e){return new(t._ofSameType(xe,je))(t,{fn:e})}(this,t)},v.prototype.thru=function(t){return t(this)},v.prototype.combine=function(t,e){return Z([this,t],e)},v.prototype.zip=function(t,e){return Be([this,t],e)},v.prototype.merge=function(t){return He([this,t])},v.prototype.concat=function(t){return qe([this,t])};v.prototype.flatMap=function(t){return new Ye(this,t).setName(this,"flatMap")},v.prototype.flatMapLatest=function(t){return new Ye(this,t,{concurLim:1,drop:"old"}).setName(this,"flatMapLatest")},v.prototype.flatMapFirst=function(t){return new Ye(this,t,{concurLim:1}).setName(this,"flatMapFirst")},v.prototype.flatMapConcat=function(t){return new Ye(this,t,{queueLim:-1,concurLim:1}).setName(this,"flatMapConcat")},v.prototype.flatMapConcurLimit=function(t,e){return new Ye(this,t,{queueLim:-1,concurLim:e}).setName(this,"flatMapConcurLimit")},v.prototype.flatMapErrors=function(t){return new Ke(this,t).setName(this,"flatMapErrors")},v.prototype.filterBy=function(t){return i=t,new((e=this)._ofSameType(ei,ii))(e,i);var e,i},v.prototype.sampledBy=function(t,e){return function(t,e,i){return Z([e],[t],i?function(t,e){return i(e,t)}:ni).setName(t,"sampledBy")}(this,t,e)},v.prototype.skipUntilBy=function(t){return i=t,new((e=this)._ofSameType(oi,si))(e,i);var e,i},v.prototype.takeUntilBy=function(t){return i=t,new((e=this)._ofSameType(li,ci))(e,i);var e,i},v.prototype.bufferBy=function(t,e){return function(t,e,i){return new(t._ofSameType(di,hi))(t,e,i)}(this,t,e)},v.prototype.bufferWhileBy=function(t,e){return function(t,e,i){return new(t._ofSameType(pi,mi))(t,e,i)}(this,t,e)};var ki=!0;function Ii(t){if(ki&&console&&"function"==typeof console.warn){console.warn(t,"\nHere is an Error object for you containing the call stack:",new Error)}}v.prototype.awaiting=function(t){return Ii("You are using deprecated .awaiting() method, see https://github.com/kefirjs/kefir/issues/145"),function(t,e){var i=He([rt(t,gi),rt(e,yi)]);return(i=W(i=Vt(i),yi)).setName(t,"awaiting")}(this,t)},v.prototype.valuesToErrors=function(t){return Ii("You are using deprecated .valuesToErrors() method, see https://github.com/kefirjs/kefir/issues/149"),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Si;return new(t._ofSameType(bi,_i))(t,{fn:e})}(this,t)},v.prototype.errorsToValues=function(t){return Ii("You are using deprecated .errorsToValues() method, see https://github.com/kefirjs/kefir/issues/149"),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ai;return new(t._ofSameType(Ti,Pi))(t,{fn:e})}(this,t)},v.prototype.endOnError=function(){return Ii("You are using deprecated .endOnError() method, see https://github.com/kefirjs/kefir/issues/150"),new((t=this)._ofSameType(Oi,Ci))(t);var t};var Ri={Observable:v,Stream:b,Property:_,never:w,later:function(t,e){return new P(t,{x:e})},interval:function(t,e){return new A(t,{x:e})},sequentially:function(t,e){return 0===e.length?w():new E(t,{xs:e})},fromPoll:function(t,e){return new O(t,{fn:e})},withInterval:function(t,e){return new k(t,{fn:e})},fromCallback:function(t){var e=!1;return R((function(i){e||(t((function(t){i.emit(t),i.end()})),e=!0)})).setName("fromCallback")},fromNodeCallback:function(t){var e=!1;return R((function(i){e||(t((function(t,e){t?i.error(t):i.emit(e),i.end()})),e=!0)})).setName("fromNodeCallback")},fromEvents:function(t,e,i){for(var n=void 0,r=void 0,o=0;o<V.length;o++)if("function"==typeof t[V[o][0]]&&"function"==typeof t[V[o][1]]){n=V[o][0],r=V[o][1];break}if(void 0===n)throw new Error("target don't support any of addEventListener/removeEventListener, addListener/removeListener, on/off method pair");return function(t,e,i){return R((function(n){var r=i?function(){n.emit(function(t,e,i){var n=i?i.length:0;if(null!=e)return 0===n?t.call(e):t.apply(e,i);switch(n){case 0:return t();case 1:return t(i[0]);case 2:return t(i[0],i[1]);case 3:return t(i[0],i[1],i[2]);case 4:return t(i[0],i[1],i[2],i[3]);default:return t.apply(null,i)}}(i,this,arguments))}:function(t){n.emit(t)};return t(r),function(){return e(r)}})).setName("fromSubUnsub")}((function(i){return t[n](e,i)}),(function(i){return t[r](e,i)}),i).setName("fromEvents")},stream:R,constant:x,constantError:function(t){return new j(t)},fromPromise:function(t){var e=!1,i=R((function(i){if(!e){var n=t.then((function(t){i.emit(t),i.end()}),(function(t){i.error(t),i.end()}));n&&"function"==typeof n.done&&n.done(),e=!0}}));return W(i,null).setName("fromPromise")},fromESObservable:function(t){var e=t[q]?t[q]():t;return R((function(t){var i=e.subscribe({error:function(e){t.error(e),t.end()},next:function(e){t.emit(e)},complete:function(){t.end()}});return i.unsubscribe?function(){i.unsubscribe()}:i})).setName("fromESObservable")},combine:Z,zip:Be,merge:He,concat:qe,Pool:Ge,pool:function(){return new Ge},repeat:ze,staticLand:J};Ri.Kefir=Ri,e.ZP=Ri},5666:function(t){var e=function(t){"use strict";var e,i=Object.prototype,n=i.hasOwnProperty,r=Object.defineProperty||function(t,e,i){t[e]=i.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function u(t,e,i,n){var o=e&&e.prototype instanceof g?e:g,s=Object.create(o.prototype),a=new I(n||[]);return r(s,"_invoke",{value:E(t,i,a)}),s}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var h="suspendedStart",f="suspendedYield",p="executing",m="completed",y={};function g(){}function v(){}function b(){}var _={};c(_,s,(function(){return this}));var S=Object.getPrototypeOf,w=S&&S(S(R([])));w&&w!==i&&n.call(w,s)&&(_=w);var T=b.prototype=g.prototype=Object.create(_);function P(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function A(t,e){function i(r,o,s,a){var l=d(t[r],t,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==typeof u&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return i("throw",t,s,a)}))}a(l.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function E(t,e,i){var n=h;return function(r,o){if(n===p)throw new Error("Generator is already running");if(n===m){if("throw"===r)throw o;return D()}for(i.method=r,i.arg=o;;){var s=i.delegate;if(s){var a=O(s,i);if(a){if(a===y)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===h)throw n=m,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=p;var l=d(t,e,i);if("normal"===l.type){if(n=i.done?m:f,l.arg===y)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=m,i.method="throw",i.arg=l.arg)}}}function O(t,i){var n=i.method,r=t.iterator[n];if(r===e)return i.delegate=null,"throw"===n&&t.iterator.return&&(i.method="return",i.arg=e,O(t,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=d(r,t.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,y;var s=o.arg;return s?s.done?(i[t.resultName]=s.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,y):s:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,y)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function R(t){if(t){var i=t[s];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function i(){for(;++r<t.length;)if(n.call(t,r))return i.value=t[r],i.done=!1,i;return i.value=e,i.done=!0,i};return o.next=o}}return{next:D}}function D(){return{value:e,done:!0}}return v.prototype=b,r(T,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:v,configurable:!0}),v.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(T),t},t.awrap=function(t){return{__await:t}},P(A.prototype),c(A.prototype,a,(function(){return this})),t.AsyncIterator=A,t.async=function(e,i,n,r,o){void 0===o&&(o=Promise);var s=new A(u(e,i,n,r),o);return t.isGeneratorFunction(i)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},P(T),c(T,l,"Generator"),c(T,s,(function(){return this})),c(T,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=R,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function r(n,r){return a.type="throw",a.arg=t,i.next=n,r&&(i.method="next",i.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),k(i),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;k(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:R(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},7418:function(t,e,i){var n={"./AdTypeConfig":701,"./AdTypeConfig.js":701,"./AdTypeTranslator":914,"./AdTypeTranslator.js":914,"./Adjacency/DefaultAdjacencyConfig":5449,"./Adjacency/DefaultAdjacencyConfig.js":5449,"./Adjacency/units/AdjacFeedManagerConfig":8699,"./Adjacency/units/AdjacFeedManagerConfig.js":8699,"./Adjacency/units/AdjacencyRecoReelWidgetConfig":256,"./Adjacency/units/AdjacencyRecoReelWidgetConfig.js":256,"./Adjacency/units/AdjacencyWidgetItemConfig":1152,"./Adjacency/units/AdjacencyWidgetItemConfig.js":1152,"./Hip/DefaultHipConfig":3912,"./Hip/DefaultHipConfig.js":3912,"./Hip/units/HipFeedManagerConfig":4279,"./Hip/units/HipFeedManagerConfig.js":4279,"./Replayable/DefaultReplayableConfig":7613,"./Replayable/DefaultReplayableConfig.js":7613,"./Replayable/units/ReplayableAdFeedManagerConfig":7723,"./Replayable/units/ReplayableAdFeedManagerConfig.js":7723,"./Replayable/units/ReplayableAdInlineConfig":3353,"./Replayable/units/ReplayableAdInlineConfig.js":3353,"./Replayable/units/ReplayableAdWidgetItemConfig":6333,"./Replayable/units/ReplayableAdWidgetItemConfig.js":6333,"./SingleAd/DefaultSingleAdConfig":7507,"./SingleAd/DefaultSingleAdConfig.js":7507,"./SingleAd/units/SingleAdFeedManagerConfig":9579,"./SingleAd/units/SingleAdFeedManagerConfig.js":9579,"./SingleAd/units/SingleAdInlineConfig":3205,"./SingleAd/units/SingleAdInlineConfig.js":3205,"./SingleAd/units/SingleAdSliderConfig":7642,"./SingleAd/units/SingleAdSliderConfig.js":7642,"./SingleAd/units/SingleAdWidgetItemConfig":6505,"./SingleAd/units/SingleAdWidgetItemConfig.js":6505};function r(t){var e=o(t);return i(e)}function o(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=o,t.exports=r,r.id=7418},1999:function(t,e,i){t.exports=function(){var t="1.13.6",e="object"==typeof self&&self.self===self&&self||"object"==typeof i.g&&i.g.global===i.g&&i.g||Function("return this")()||{},n=Array.prototype,r=Object.prototype,o="undefined"!=typeof Symbol?Symbol.prototype:null,s=n.push,a=n.slice,l=r.toString,c=r.hasOwnProperty,u="undefined"!=typeof ArrayBuffer,d="undefined"!=typeof DataView,h=Array.isArray,f=Object.keys,p=Object.create,m=u&&ArrayBuffer.isView,y=isNaN,g=isFinite,v=!{toString:null}.propertyIsEnumerable("toString"),b=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],_=Math.pow(2,53)-1;function S(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),n=Array(i),r=0;r<i;r++)n[r]=arguments[r+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var o=Array(e+1);for(r=0;r<e;r++)o[r]=arguments[r];return o[e]=n,t.apply(this,o)}}function w(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function T(t){return null===t}function P(t){return void 0===t}function A(t){return!0===t||!1===t||"[object Boolean]"===l.call(t)}function E(t){return!(!t||1!==t.nodeType)}function O(t){var e="[object "+t+"]";return function(t){return l.call(t)===e}}var C=O("String"),k=O("Number"),I=O("Date"),R=O("RegExp"),D=O("Error"),V=O("Symbol"),N=O("ArrayBuffer"),x=O("Function"),j=e.document&&e.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof j&&(x=function(t){return"function"==typeof t||!1});var M=x,L=O("Object"),B=d&&L(new DataView(new ArrayBuffer(8))),F="undefined"!=typeof Map&&L(new Map),U=O("DataView");function W(t){return null!=t&&M(t.getInt8)&&N(t.buffer)}var H=B?W:U,$=h||O("Array");function z(t,e){return null!=t&&c.call(t,e)}var q=O("Arguments");!function(){q(arguments)||(q=function(t){return z(t,"callee")})}();var G=q;function Y(t){return!V(t)&&g(t)&&!isNaN(parseFloat(t))}function K(t){return k(t)&&y(t)}function Q(t){return function(){return t}}function Z(t){return function(e){var i=t(e);return"number"==typeof i&&i>=0&&i<=_}}function X(t){return function(e){return null==e?void 0:e[t]}}var J=X("byteLength"),tt=Z(J),et=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function it(t){return m?m(t)&&!H(t):tt(t)&&et.test(l.call(t))}var nt=u?it:Q(!1),rt=X("length");function ot(t){for(var e={},i=t.length,n=0;n<i;++n)e[t[n]]=!0;return{contains:function(t){return!0===e[t]},push:function(i){return e[i]=!0,t.push(i)}}}function st(t,e){e=ot(e);var i=b.length,n=t.constructor,o=M(n)&&n.prototype||r,s="constructor";for(z(t,s)&&!e.contains(s)&&e.push(s);i--;)(s=b[i])in t&&t[s]!==o[s]&&!e.contains(s)&&e.push(s)}function at(t){if(!w(t))return[];if(f)return f(t);var e=[];for(var i in t)z(t,i)&&e.push(i);return v&&st(t,e),e}function lt(t){if(null==t)return!0;var e=rt(t);return"number"==typeof e&&($(t)||C(t)||G(t))?0===e:0===rt(at(t))}function ct(t,e){var i=at(e),n=i.length;if(null==t)return!n;for(var r=Object(t),o=0;o<n;o++){var s=i[o];if(e[s]!==r[s]||!(s in r))return!1}return!0}function ut(t){return t instanceof ut?t:this instanceof ut?void(this._wrapped=t):new ut(t)}function dt(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,J(t))}ut.VERSION=t,ut.prototype.value=function(){return this._wrapped},ut.prototype.valueOf=ut.prototype.toJSON=ut.prototype.value,ut.prototype.toString=function(){return String(this._wrapped)};var ht="[object DataView]";function ft(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var r=typeof t;return("function"===r||"object"===r||"object"==typeof e)&&pt(t,e,i,n)}function pt(t,e,i,n){t instanceof ut&&(t=t._wrapped),e instanceof ut&&(e=e._wrapped);var r=l.call(t);if(r!==l.call(e))return!1;if(B&&"[object Object]"==r&&H(t)){if(!H(e))return!1;r=ht}switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return o.valueOf.call(t)===o.valueOf.call(e);case"[object ArrayBuffer]":case ht:return pt(dt(t),dt(e),i,n)}var s="[object Array]"===r;if(!s&&nt(t)){if(J(t)!==J(e))return!1;if(t.buffer===e.buffer&&t.byteOffset===e.byteOffset)return!0;s=!0}if(!s){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,c=e.constructor;if(a!==c&&!(M(a)&&a instanceof a&&M(c)&&c instanceof c)&&"constructor"in t&&"constructor"in e)return!1}n=n||[];for(var u=(i=i||[]).length;u--;)if(i[u]===t)return n[u]===e;if(i.push(t),n.push(e),s){if((u=t.length)!==e.length)return!1;for(;u--;)if(!ft(t[u],e[u],i,n))return!1}else{var d,h=at(t);if(u=h.length,at(e).length!==u)return!1;for(;u--;)if(!z(e,d=h[u])||!ft(t[d],e[d],i,n))return!1}return i.pop(),n.pop(),!0}function mt(t,e){return ft(t,e)}function yt(t){if(!w(t))return[];var e=[];for(var i in t)e.push(i);return v&&st(t,e),e}function gt(t){var e=rt(t);return function(i){if(null==i)return!1;var n=yt(i);if(rt(n))return!1;for(var r=0;r<e;r++)if(!M(i[t[r]]))return!1;return t!==Tt||!M(i[vt])}}var vt="forEach",bt="has",_t=["clear","delete"],St=["get",bt,"set"],wt=_t.concat(vt,St),Tt=_t.concat(St),Pt=["add"].concat(_t,vt,bt),At=F?gt(wt):O("Map"),Et=F?gt(Tt):O("WeakMap"),Ot=F?gt(Pt):O("Set"),Ct=O("WeakSet");function kt(t){for(var e=at(t),i=e.length,n=Array(i),r=0;r<i;r++)n[r]=t[e[r]];return n}function It(t){for(var e=at(t),i=e.length,n=Array(i),r=0;r<i;r++)n[r]=[e[r],t[e[r]]];return n}function Rt(t){for(var e={},i=at(t),n=0,r=i.length;n<r;n++)e[t[i[n]]]=i[n];return e}function Dt(t){var e=[];for(var i in t)M(t[i])&&e.push(i);return e.sort()}function Vt(t,e){return function(i){var n=arguments.length;if(e&&(i=Object(i)),n<2||null==i)return i;for(var r=1;r<n;r++)for(var o=arguments[r],s=t(o),a=s.length,l=0;l<a;l++){var c=s[l];e&&void 0!==i[c]||(i[c]=o[c])}return i}}var Nt=Vt(yt),xt=Vt(at),jt=Vt(yt,!0);function Mt(){return function(){}}function Lt(t){if(!w(t))return{};if(p)return p(t);var e=Mt();e.prototype=t;var i=new e;return e.prototype=null,i}function Bt(t,e){var i=Lt(t);return e&&xt(i,e),i}function Ft(t){return w(t)?$(t)?t.slice():Nt({},t):t}function Ut(t,e){return e(t),t}function Wt(t){return $(t)?t:[t]}function Ht(t){return ut.toPath(t)}function $t(t,e){for(var i=e.length,n=0;n<i;n++){if(null==t)return;t=t[e[n]]}return i?t:void 0}function zt(t,e,i){var n=$t(t,Ht(e));return P(n)?i:n}function qt(t,e){for(var i=(e=Ht(e)).length,n=0;n<i;n++){var r=e[n];if(!z(t,r))return!1;t=t[r]}return!!i}function Gt(t){return t}function Yt(t){return t=xt({},t),function(e){return ct(e,t)}}function Kt(t){return t=Ht(t),function(e){return $t(e,t)}}function Qt(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,n,r){return t.call(e,i,n,r)};case 4:return function(i,n,r,o){return t.call(e,i,n,r,o)}}return function(){return t.apply(e,arguments)}}function Zt(t,e,i){return null==t?Gt:M(t)?Qt(t,e,i):w(t)&&!$(t)?Yt(t):Kt(t)}function Xt(t,e){return Zt(t,e,1/0)}function Jt(t,e,i){return ut.iteratee!==Xt?ut.iteratee(t,e):Zt(t,e,i)}function te(t,e,i){e=Jt(e,i);for(var n=at(t),r=n.length,o={},s=0;s<r;s++){var a=n[s];o[a]=e(t[a],a,t)}return o}function ee(){}function ie(t){return null==t?ee:function(e){return zt(t,e)}}function ne(t,e,i){var n=Array(Math.max(0,t));e=Qt(e,i,1);for(var r=0;r<t;r++)n[r]=e(r);return n}function re(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}ut.toPath=Wt,ut.iteratee=Xt;var oe=Date.now||function(){return(new Date).getTime()};function se(t){var e=function(e){return t[e]},i="(?:"+at(t).join("|")+")",n=RegExp(i),r=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(r,e):t}}var ae={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},le=se(ae),ce=se(Rt(ae)),ue=ut.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},de=/(.)^/,he={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},fe=/\\|'|\r|\n|\u2028|\u2029/g;function pe(t){return"\\"+he[t]}var me=/^\s*(\w|\$)+\s*$/;function ye(t,e,i){!e&&i&&(e=i),e=jt({},e,ut.templateSettings);var n=RegExp([(e.escape||de).source,(e.interpolate||de).source,(e.evaluate||de).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(n,(function(e,i,n,s,a){return o+=t.slice(r,a).replace(fe,pe),r=a+e.length,i?o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),e})),o+="';\n";var s,a=e.variable;if(a){if(!me.test(a))throw new Error("variable is not a bare identifier: "+a)}else o="with(obj||{}){\n"+o+"}\n",a="obj";o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{s=new Function(a,"_",o)}catch(t){throw t.source=o,t}var l=function(t){return s.call(this,t,ut)};return l.source="function("+a+"){\n"+o+"}",l}function ge(t,e,i){var n=(e=Ht(e)).length;if(!n)return M(i)?i.call(t):i;for(var r=0;r<n;r++){var o=null==t?void 0:t[e[r]];void 0===o&&(o=i,r=n),t=M(o)?o.call(t):o}return t}var ve=0;function be(t){var e=++ve+"";return t?t+e:e}function _e(t){var e=ut(t);return e._chain=!0,e}function Se(t,e,i,n,r){if(!(n instanceof e))return t.apply(i,r);var o=Lt(t.prototype),s=t.apply(o,r);return w(s)?s:o}var we=S((function(t,e){var i=we.placeholder,n=function(){for(var r=0,o=e.length,s=Array(o),a=0;a<o;a++)s[a]=e[a]===i?arguments[r++]:e[a];for(;r<arguments.length;)s.push(arguments[r++]);return Se(t,n,this,this,s)};return n}));we.placeholder=ut;var Te=S((function(t,e,i){if(!M(t))throw new TypeError("Bind must be called on a function");var n=S((function(r){return Se(t,n,e,this,i.concat(r))}));return n})),Pe=Z(rt);function Ae(t,e,i,n){if(n=n||[],e||0===e){if(e<=0)return n.concat(t)}else e=1/0;for(var r=n.length,o=0,s=rt(t);o<s;o++){var a=t[o];if(Pe(a)&&($(a)||G(a)))if(e>1)Ae(a,e-1,i,n),r=n.length;else for(var l=0,c=a.length;l<c;)n[r++]=a[l++];else i||(n[r++]=a)}return n}var Ee=S((function(t,e){var i=(e=Ae(e,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var n=e[i];t[n]=Te(t[n],t)}return t}));function Oe(t,e){var i=function(n){var r=i.cache,o=""+(e?e.apply(this,arguments):n);return z(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return i.cache={},i}var Ce=S((function(t,e,i){return setTimeout((function(){return t.apply(null,i)}),e)})),ke=we(Ce,ut,1);function Ie(t,e,i){var n,r,o,s,a=0;i||(i={});var l=function(){a=!1===i.leading?0:oe(),n=null,s=t.apply(r,o),n||(r=o=null)},c=function(){var c=oe();a||!1!==i.leading||(a=c);var u=e-(c-a);return r=this,o=arguments,u<=0||u>e?(n&&(clearTimeout(n),n=null),a=c,s=t.apply(r,o),n||(r=o=null)):n||!1===i.trailing||(n=setTimeout(l,u)),s};return c.cancel=function(){clearTimeout(n),a=0,n=r=o=null},c}function Re(t,e,i){var n,r,o,s,a,l=function(){var c=oe()-r;e>c?n=setTimeout(l,e-c):(n=null,i||(s=t.apply(a,o)),n||(o=a=null))},c=S((function(c){return a=this,o=c,r=oe(),n||(n=setTimeout(l,e),i&&(s=t.apply(a,o))),s}));return c.cancel=function(){clearTimeout(n),n=o=a=null},c}function De(t,e){return we(e,t)}function Ve(t){return function(){return!t.apply(this,arguments)}}function Ne(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}}function xe(t,e){return function(){if(--t<1)return e.apply(this,arguments)}}function je(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}}var Me=we(je,2);function Le(t,e,i){e=Jt(e,i);for(var n,r=at(t),o=0,s=r.length;o<s;o++)if(e(t[n=r[o]],n,t))return n}function Be(t){return function(e,i,n){i=Jt(i,n);for(var r=rt(e),o=t>0?0:r-1;o>=0&&o<r;o+=t)if(i(e[o],o,e))return o;return-1}}var Fe=Be(1),Ue=Be(-1);function We(t,e,i,n){for(var r=(i=Jt(i,n,1))(e),o=0,s=rt(t);o<s;){var a=Math.floor((o+s)/2);i(t[a])<r?o=a+1:s=a}return o}function He(t,e,i){return function(n,r,o){var s=0,l=rt(n);if("number"==typeof o)t>0?s=o>=0?o:Math.max(o+l,s):l=o>=0?Math.min(o+1,l):o+l+1;else if(i&&o&&l)return n[o=i(n,r)]===r?o:-1;if(r!=r)return(o=e(a.call(n,s,l),K))>=0?o+s:-1;for(o=t>0?s:l-1;o>=0&&o<l;o+=t)if(n[o]===r)return o;return-1}}var $e=He(1,Fe,We),ze=He(-1,Ue);function qe(t,e,i){var n=(Pe(t)?Fe:Le)(t,e,i);if(void 0!==n&&-1!==n)return t[n]}function Ge(t,e){return qe(t,Yt(e))}function Ye(t,e,i){var n,r;if(e=Qt(e,i),Pe(t))for(n=0,r=t.length;n<r;n++)e(t[n],n,t);else{var o=at(t);for(n=0,r=o.length;n<r;n++)e(t[o[n]],o[n],t)}return t}function Ke(t,e,i){e=Jt(e,i);for(var n=!Pe(t)&&at(t),r=(n||t).length,o=Array(r),s=0;s<r;s++){var a=n?n[s]:s;o[s]=e(t[a],a,t)}return o}function Qe(t){var e=function(e,i,n,r){var o=!Pe(e)&&at(e),s=(o||e).length,a=t>0?0:s-1;for(r||(n=e[o?o[a]:a],a+=t);a>=0&&a<s;a+=t){var l=o?o[a]:a;n=i(n,e[l],l,e)}return n};return function(t,i,n,r){var o=arguments.length>=3;return e(t,Qt(i,r,4),n,o)}}var Ze=Qe(1),Xe=Qe(-1);function Je(t,e,i){var n=[];return e=Jt(e,i),Ye(t,(function(t,i,r){e(t,i,r)&&n.push(t)})),n}function ti(t,e,i){return Je(t,Ve(Jt(e)),i)}function ei(t,e,i){e=Jt(e,i);for(var n=!Pe(t)&&at(t),r=(n||t).length,o=0;o<r;o++){var s=n?n[o]:o;if(!e(t[s],s,t))return!1}return!0}function ii(t,e,i){e=Jt(e,i);for(var n=!Pe(t)&&at(t),r=(n||t).length,o=0;o<r;o++){var s=n?n[o]:o;if(e(t[s],s,t))return!0}return!1}function ni(t,e,i,n){return Pe(t)||(t=kt(t)),("number"!=typeof i||n)&&(i=0),$e(t,e,i)>=0}var ri=S((function(t,e,i){var n,r;return M(e)?r=e:(e=Ht(e),n=e.slice(0,-1),e=e[e.length-1]),Ke(t,(function(t){var o=r;if(!o){if(n&&n.length&&(t=$t(t,n)),null==t)return;o=t[e]}return null==o?o:o.apply(t,i)}))}));function oi(t,e){return Ke(t,Kt(e))}function si(t,e){return Je(t,Yt(e))}function ai(t,e,i){var n,r,o=-1/0,s=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,l=(t=Pe(t)?t:kt(t)).length;a<l;a++)null!=(n=t[a])&&n>o&&(o=n);else e=Jt(e,i),Ye(t,(function(t,i,n){((r=e(t,i,n))>s||r===-1/0&&o===-1/0)&&(o=t,s=r)}));return o}function li(t,e,i){var n,r,o=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,l=(t=Pe(t)?t:kt(t)).length;a<l;a++)null!=(n=t[a])&&n<o&&(o=n);else e=Jt(e,i),Ye(t,(function(t,i,n){((r=e(t,i,n))<s||r===1/0&&o===1/0)&&(o=t,s=r)}));return o}var ci=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function ui(t){return t?$(t)?a.call(t):C(t)?t.match(ci):Pe(t)?Ke(t,Gt):kt(t):[]}function di(t,e,i){if(null==e||i)return Pe(t)||(t=kt(t)),t[re(t.length-1)];var n=ui(t),r=rt(n);e=Math.max(Math.min(e,r),0);for(var o=r-1,s=0;s<e;s++){var a=re(s,o),l=n[s];n[s]=n[a],n[a]=l}return n.slice(0,e)}function hi(t){return di(t,1/0)}function fi(t,e,i){var n=0;return e=Jt(e,i),oi(Ke(t,(function(t,i,r){return{value:t,index:n++,criteria:e(t,i,r)}})).sort((function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index})),"value")}function pi(t,e){return function(i,n,r){var o=e?[[],[]]:{};return n=Jt(n,r),Ye(i,(function(e,r){var s=n(e,r,i);t(o,e,s)})),o}}var mi=pi((function(t,e,i){z(t,i)?t[i].push(e):t[i]=[e]})),yi=pi((function(t,e,i){t[i]=e})),gi=pi((function(t,e,i){z(t,i)?t[i]++:t[i]=1})),vi=pi((function(t,e,i){t[i?0:1].push(e)}),!0);function bi(t){return null==t?0:Pe(t)?t.length:at(t).length}function _i(t,e,i){return e in i}var Si=S((function(t,e){var i={},n=e[0];if(null==t)return i;M(n)?(e.length>1&&(n=Qt(n,e[1])),e=yt(t)):(n=_i,e=Ae(e,!1,!1),t=Object(t));for(var r=0,o=e.length;r<o;r++){var s=e[r],a=t[s];n(a,s,t)&&(i[s]=a)}return i})),wi=S((function(t,e){var i,n=e[0];return M(n)?(n=Ve(n),e.length>1&&(i=e[1])):(e=Ke(Ae(e,!1,!1),String),n=function(t,i){return!ni(e,i)}),Si(t,n,i)}));function Ti(t,e,i){return a.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))}function Pi(t,e,i){return null==t||t.length<1?null==e||i?void 0:[]:null==e||i?t[0]:Ti(t,t.length-e)}function Ai(t,e,i){return a.call(t,null==e||i?1:e)}function Ei(t,e,i){return null==t||t.length<1?null==e||i?void 0:[]:null==e||i?t[t.length-1]:Ai(t,Math.max(0,t.length-e))}function Oi(t){return Je(t,Boolean)}function Ci(t,e){return Ae(t,e,!1)}var ki=S((function(t,e){return e=Ae(e,!0,!0),Je(t,(function(t){return!ni(e,t)}))})),Ii=S((function(t,e){return ki(t,e)}));function Ri(t,e,i,n){A(e)||(n=i,i=e,e=!1),null!=i&&(i=Jt(i,n));for(var r=[],o=[],s=0,a=rt(t);s<a;s++){var l=t[s],c=i?i(l,s,t):l;e&&!i?(s&&o===c||r.push(l),o=c):i?ni(o,c)||(o.push(c),r.push(l)):ni(r,l)||r.push(l)}return r}var Di=S((function(t){return Ri(Ae(t,!0,!0))}));function Vi(t){for(var e=[],i=arguments.length,n=0,r=rt(t);n<r;n++){var o=t[n];if(!ni(e,o)){var s;for(s=1;s<i&&ni(arguments[s],o);s++);s===i&&e.push(o)}}return e}function Ni(t){for(var e=t&&ai(t,rt).length||0,i=Array(e),n=0;n<e;n++)i[n]=oi(t,n);return i}var xi=S(Ni);function ji(t,e){for(var i={},n=0,r=rt(t);n<r;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i}function Mi(t,e,i){null==e&&(e=t||0,t=0),i||(i=e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/i),0),r=Array(n),o=0;o<n;o++,t+=i)r[o]=t;return r}function Li(t,e){if(null==e||e<1)return[];for(var i=[],n=0,r=t.length;n<r;)i.push(a.call(t,n,n+=e));return i}function Bi(t,e){return t._chain?ut(e).chain():e}function Fi(t){return Ye(Dt(t),(function(e){var i=ut[e]=t[e];ut.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),Bi(this,i.apply(ut,t))}})),ut}Ye(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=n[t];ut.prototype[t]=function(){var i=this._wrapped;return null!=i&&(e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0]),Bi(this,i)}})),Ye(["concat","join","slice"],(function(t){var e=n[t];ut.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),Bi(this,t)}}));var Ui=Fi({__proto__:null,VERSION:t,restArguments:S,isObject:w,isNull:T,isUndefined:P,isBoolean:A,isElement:E,isString:C,isNumber:k,isDate:I,isRegExp:R,isError:D,isSymbol:V,isArrayBuffer:N,isDataView:H,isArray:$,isFunction:M,isArguments:G,isFinite:Y,isNaN:K,isTypedArray:nt,isEmpty:lt,isMatch:ct,isEqual:mt,isMap:At,isWeakMap:Et,isSet:Ot,isWeakSet:Ct,keys:at,allKeys:yt,values:kt,pairs:It,invert:Rt,functions:Dt,methods:Dt,extend:Nt,extendOwn:xt,assign:xt,defaults:jt,create:Bt,clone:Ft,tap:Ut,get:zt,has:qt,mapObject:te,identity:Gt,constant:Q,noop:ee,toPath:Wt,property:Kt,propertyOf:ie,matcher:Yt,matches:Yt,times:ne,random:re,now:oe,escape:le,unescape:ce,templateSettings:ue,template:ye,result:ge,uniqueId:be,chain:_e,iteratee:Xt,partial:we,bind:Te,bindAll:Ee,memoize:Oe,delay:Ce,defer:ke,throttle:Ie,debounce:Re,wrap:De,negate:Ve,compose:Ne,after:xe,before:je,once:Me,findKey:Le,findIndex:Fe,findLastIndex:Ue,sortedIndex:We,indexOf:$e,lastIndexOf:ze,find:qe,detect:qe,findWhere:Ge,each:Ye,forEach:Ye,map:Ke,collect:Ke,reduce:Ze,foldl:Ze,inject:Ze,reduceRight:Xe,foldr:Xe,filter:Je,select:Je,reject:ti,every:ei,all:ei,some:ii,any:ii,contains:ni,includes:ni,include:ni,invoke:ri,pluck:oi,where:si,max:ai,min:li,shuffle:hi,sample:di,sortBy:fi,groupBy:mi,indexBy:yi,countBy:gi,partition:vi,toArray:ui,size:bi,pick:Si,omit:wi,first:Pi,head:Pi,take:Pi,initial:Ti,last:Ei,rest:Ai,tail:Ai,drop:Ai,compact:Oi,flatten:Ci,without:Ii,uniq:Ri,unique:Ri,union:Di,intersection:Vi,difference:ki,unzip:Ni,transpose:Ni,zip:xi,object:ji,range:Mi,chunk:Li,mixin:Fi,default:ut});return Ui._=Ui,Ui}()}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var o=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.hmd=function(t){return(t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){"use strict";var t=i(2130),e=i.n(t),n=i(2447),r=i(5545);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,s=void 0,s=function(t,e){if("object"!==o(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===o(s)?s:String(s)),n)}var r,s}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=c(t);if(e){var r=c(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}var u=i(1999),d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(d,t);var i,n,o,c=l(d);function d(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(e=c.call(this,t.model)).model=t.model,e.onPredict=t.onPredict,e.adProperties=t.adProperties,e.onPredictCallback=t.onPredictCallback,e.currentKey=0,e.log=new r.Z({unitType:e.model.get("unitType"),className:"basePredictService",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e._bindEvents(),e}return i=d,(n=[{key:"_bindEvents",value:function(){}},{key:"_setCuerrentKey",value:function(t){this.currentKey=u.last(t.split(".")),this.model.set("adsManagerLastPredictKey",this.currentKey)}},{key:"_predicted",value:function(t){if(!this.model.get("isGetRv1OnlyForEligible.isActive")||t!=e().RV_TYPES.RV||this.model.get("isEligibleToPlay")){if(this.model.set("lastPredictPoint",t),this.model.set("lastPredictPath",this.predictPath),this.model.get(this.predictPath+".isStartWF")&&this.startWf&&(this.log.info("startWF predicted"),this.startWf()),this._checkIsGet1OnlyOnAdLoaded()&&parseInt(t)===e().RV_TYPES.RV&&!this.model.get("playerHasRvInQ"))return this.log.warning("no rv=1 in adLoaded skipping predict"),void this.model.set("isSkippedDistancePredict",!0);this.predictPath&&!this.model.get(this.predictPath+".isActive")||(this._logPredict(t),this.onPredict(t,this.log.className,this.adProperties))}else this.model.get("isGetRv1OnlyForEligible.delayPrediction")&&this._delayRvPredict(t)}},{key:"_checkIsGet1OnlyOnAdLoaded",value:function(){var t=this.model.get("predictors.isGet1OnlyAfterAdLoaded");return this.predictPath&&void 0!==this.model.get("".concat(this.predictPath,".isGet1OnlyAfterAdLoaded"))&&(t=this.model.get("".concat(this.predictPath,".isGet1OnlyAfterAdLoaded"))),t}},{key:"_logPredict",value:function(t){var e="predicted with key: "+t;this.adProperties?this.log.info(e+" with properties: ",this.adProperties):this.log.info(e)}},{key:"_delayRvPredict",value:function(t){this.delayedPredictPointKey=t,this.delayStartTimeStamp=Date.now(),this.model.set("delayRvPredict",e().PREDICT_NAMES[this._getPredictName()]),this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_predictOnDelayRvPredict",isListenOnce:!0}])}},{key:"_predictOnDelayRvPredict",value:function(){this.model.set("executeDelayedRvPredict",{name:e().PREDICT_NAMES[this._getPredictName()],time:Date.now()-this.delayStartTimeStamp}),this._predicted(this.delayedPredictPointKey)}},{key:"_getPredictName",value:function(){return this.predictPath.split(".")[1]}}])&&s(i.prototype,n),o&&s(i,o),Object.defineProperty(i,"prototype",{writable:!1}),d}(n.O),h=d;function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function p(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==f(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===f(o)?o:String(o)),n)}var r,o}function m(t,e){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},m(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=g(t);if(e){var r=g(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e)}(s,t);var e,i,n,o=y(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"autoKillPredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPath="predictors.autoKill",e.predictPoint="".concat(e.predictPath,".predictPoint"),e.allowedPredictPoint=e.model.get("".concat(e.predictPath,".allowedPredictPoint")),e.log.predict("predict created"),e}return e=s,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adState:autoKill",funcName:"_onAutoKillPredict"}])}},{key:"_onAutoKillPredict",value:function(){if(this._canPredict()){var t=this._getLastAutoKilledAdKey();this.log.predict("predicted with key ".concat(t)),setTimeout(this._predicted.bind(this,t),0)}else this.log.predict("Not allowed to predict")}},{key:"_canPredict",value:function(){return this.allowedPredictPoint===this._getLastAutoKilledAdKey()}},{key:"_getLastAutoKilledAdKey",value:function(){return this.model.get("lastAutoKilledPredict")}}])&&p(e.prototype,i),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h),b=v,_=i(9057),S=i(9288),w=i.n(S),T=i(1999),P=function(t,e){t.model=e,t.parentSelectorStr=void 0,t.model.get("permanentCard")?t.parentSelectorStr='[data-card-index="'.concat(t.model.get("permanentCard"),'"]'):t.model.get("predictors.isUseWidgetSelector")?t.parentSelectorStr=t.model.get("widgetSelector"):t.model.get("isRecoReelAboveFeed")?t.parentSelectorStr=t.model.get("aboveFeedSelector"):t.model.get("midArticleSelector")?t.parentSelectorStr=t.model.get("midArticleSelector"):t.parentSelectorStr=t.model.get("parentSelector");return{getParentSelector:function(){if(t.parentSelectorStr){var e=t.parentSelectorStr.toString(),i=(0,_.default)(e);return t.model.get("predictors.isNeedValidateParentSelector")?T.getValidSelectorElements(i)[0]:i[0]}},calcPredicts:function(){var e=t.model.get(t.predictPoints);T.each(e,(function(e,i){t._calcPredict(e,i)}))}}};function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function E(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==A(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===A(o)?o:String(o)),n)}var r,o}var O,C=i(1999),k=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.conf=e,this.log=new r.Z({unitType:"Manager",className:"ScrollManager",version:this.conf.version,isDebug:this.conf.isDebug}),this.log.info("Created"),this.window=i||window,this.$window=(0,_.default)(window),this.windowHeight=this.$window.height(),this.windowWidth=this.$window.width(),this.scrollElement=C.isEmpty(n)?this.window:(0,_.default)(n)[0],this.$scrollElement=(0,_.default)(this.scrollElement),this.timeBetweenEvents=100,this.lastTimeStamp=0,this.lastScrollTop=this.$scrollElement.scrollTop(),this.pps=0,this.ppsChange=0,this.vms=1/0,this.direction=1,this.maxMSBetweenEvents=2e3,this.scrollEndTimeout=this.conf.scrollEndTimeout;var o=C.throttle(this.onScroll.bind(this),this.timeBetweenEvents);this.scrollElement.addEventListener("scroll",o)}var e,i,n;return e=t,(i=[{key:"getPps",value:function(){return this.pps}},{key:"onScroll",value:function(t){clearTimeout(this.scrollEnd),this.pps=0;var e=t.timeStamp-this.lastTimeStamp;this.lastTimeStamp=t.timeStamp;var i=this.$scrollElement.scrollTop()-this.lastScrollTop;this.lastScrollTop=this.$scrollElement.scrollTop(),this.direction=i<0?-1:1,e<this.maxMSBetweenEvents&&this.changePPS(i/e*1e3),C.parseBool(this.conf.isLogScroll)&&this.log.info("onScroll - pps: "+this.direction*this.pps),this.scrollEnd=setTimeout(this.onScrollEnd.bind(this),this.scrollEndTimeout)}},{key:"onScrollEnd",value:function(){C.parseBool(this.conf.isLogScroll)&&this.log.warning("onScrollEnd"),this.changePPS(0),C.forEach(this.onScrollEndCBList,function(t){t()}.bind(this))}},{key:"changePPS",value:function(t){this.ppsChange=t-this.pps,this.pps=t,0===this.pps&&(this.vms=1/0),this.vms=this.windowHeight/this.pps*1e3,C.forEach(this.onScrollPPSChange,(function(t){setTimeout(t,0)}))}},{key:"registerForPPSChange",value:function(t){this.onScrollPPSChange=this.onScrollPPSChange||[];var e=this.onScrollPPSChange.indexOf(t);return-1!==e?e:this.onScrollPPSChange.push(t)-1}},{key:"deRegisterForPPSChange",value:function(t){var e=this.onScrollPPSChange.indexOf(t);this.onScrollPPSChange.splice(e,1)}},{key:"registerForScrollEnd",value:function(t){this.onScrollEndCBList=this.onScrollEndCBList||[];var e=this.onScrollEndCBList.indexOf(t);return-1!==e?e:this.onScrollEndCBList.push(t)-1}},{key:"deRegisterForScrollEnd",value:function(t){var e=this.onScrollEndCBList.indexOf(t);this.onScrollEndCBList.splice(e,1)}}])&&E(e.prototype,i),n&&E(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),I=function(t,e,i){return O||(O=new k(t,e,i)),O};function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function D(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==R(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===R(o)?o:String(o)),n)}var r,o}function V(t,e){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},V(t,e)}function N(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=x(t);if(e){var r=x(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===R(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}i(1999);var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V(t,e)}(s,t);var e,i,n,o=N(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"baseDistancePredicts",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e}return e=s,(i=[{key:"_initPredict",value:function(t){this.predictPoint=t.predictPoint,this.predictKey=t.predictKey,this.startWf=t.startWfFunc,this.utils=P(this,this.model),this.scrollManager=new I,this._setParentSelector()}},{key:"_setParentSelector",value:function(){if(!this.isSelectorFound){var t=this.utils.getParentSelector();t?(this.isSelectorFound=!0,this.parentSelector=t,this.log.info("parentSelector found staring to predict viewability"),this._bindEvents(),this._calcPredict()):(this.log.info("no parentSelector can't predict distance waiting for parentSelector"),w().once("window:scroll:change",this._setParentSelector.bind(this)),this.model.listenToOnce(this.model,"change:parentSelector",this._setParentSelector.bind(this)))}}},{key:"_bindEvents",value:function(){this.parentSelector&&(window.taboolaBridge&&!this.registeredOnNotifyExternalRects&&(this.registeredOnNotifyExternalRects=!0,window.taboolaBridge.on("notifyExternalRects",this._calcPredict.bind(this))),w().once("window:scroll:change",this._calcPredict.bind(this)))}},{key:"_calcPredict",value:function(){}},{key:"_onDistancePredicted",value:function(t){if(this.log.predict("predict key ".concat(t,": max pps = ").concat(this.maxPPS,", current pps = ").concat(this.scrollManager.pps)),this.maxPPS&&Math.abs(this.scrollManager.pps)>this.maxPPS)return this.log.warning("Distance Predicted, speed is too high",this.scrollManager.pps),this.model.set("isSkippedDistancePredict",!0),void this.log.predict("predict key ".concat(t,": skipping on pps"));this.log.warning("Distance Predicted, speed is OK",this.scrollManager.pps),this.log.predict("predict key ".concat(t,": predicted")),this._predicted(t)}}])&&D(e.prototype,i),n&&D(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h),M=j;function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function B(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==L(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===L(o)?o:String(o)),n)}var r,o}function F(t,e){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},F(t,e)}function U(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=H(t);if(e){var r=H(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===L(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return W(t)}(this,i)}}function W(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H(t){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},H(t)}var z=i(1999),q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F(t,e)}(s,t);var e,i,n,o=U(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"distancePercentPredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPath="predictors.distancePercent",e.maxPPS=e.model.get("predictors.distancePercent.maxPPS"),e.utils=P(W(e),e.model),e._initPredict(t),e}return e=s,(i=[{key:"_calcPredict",value:function(){if(!this.isPredicted){var t=(0,_.default)(this.model.get("scrollSelector"))[0],e=void 0!==t,i=e?t.clientHeight:window.innerHeight,n=e?i+t.scrollTop:i+window.pageYOffset,r=100/(this.predictPoint||1),o=z.getTopOfEl(this.parentSelector),s=o+this.model.get("height")/(100/this.model.get("viewPercent")||1),a=i+(s-i)/r;this.model.get("logViewabilityCalc")&&this.log.info("\ntopParentSelector: "+o+",\neligibilityPoint: "+s+",\nstartPoint: "+i+",\nbottomViewPort: "+n+",\npredictionPoint: "+a+",\ncalc: predictionPoint <= bottomViewPort: "+(a<=n)),a<=n?(this.model.set("distancePercentPredictData",{topParentSelector:o,bottomViewPort:n,eligibilityPoint:s,startPoint:i,predictionPoint:this.predictionPoint,predictKey:this.predictKey}),this.isPredicted=!0,this._onDistancePredicted(this.predictKey)):this._bindEvents()}}}])&&B(e.prototype,i),n&&B(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(M),G=q;function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function K(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Y(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Y(o)?o:String(o)),n)}var r,o}function Q(t,e){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Q(t,e)}function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=X(t);if(e){var r=X(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function X(t){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},X(t)}var J=function(t){return function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q(t,e)}(o,t);var e,i,n,r=Z(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return e=o,(i=[{key:"onScrollSpeedChangeCallback",value:function(){this.scrollManager.getPps()>this.maxPPS?this.log.predict("onScrollSpeedChangeCallback - Could not predict, scroll speed higher then maxPPS"):this._isAllowedForPredictOnScrollEnd()?(this.log.predict("onScrollSpeedChangeCallback - Predicted!"),this._predictWithPredictKey()):this.log.predict("onScrollSpeedChangeCallback - Could not predict, not eligible to play")}}])&&K(e.prototype,i),n&&K(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(t)};function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==tt(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===tt(o)?o:String(o)),n)}var r,o}function it(t,e){return it=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},it(t,e)}function nt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ot(t);if(e){var r=ot(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===tt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rt(t)}(this,i)}}function rt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ot(t){return ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ot(t)}var st=i(1999),at=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&it(t,e)}(s,t);var e,i,n,o=nt(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"distancePixelsPredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPath="predictors.distancePixels",e.maxPPS=e.model.get("predictors.distancePixels.maxPPS"),e.log.predict("predict created with key = ".concat(t.predictKey,", predict point = ").concat(t.predictPoint,", maxPPS = ").concat(e.maxPPS)),e._initPredict(t),e.model.get("".concat(e.predictPath,".isListenToScrollSpeedChange"))&&e.scrollManager.registerForPPSChange(e.onScrollSpeedChangeCallback.bind(rt(e))),e}return e=s,(i=[{key:"_calcPredict",value:function(){this.isPredicted||(this.isPixelsPoint=st.hasPassedPixelFromSelector(this.parentSelectorStr,this.model.get("scrollSelector"),this.predictPoint,this.model.get("predictors.isNeedValidateParentSelector")),this.isPixelsPoint?(this.model.set("distancePixelPredictData",{predictionPoint:this.predictionPoint,predictKey:this.predictKey}),this.isPredicted=!0,this.log.predict("predict key ".concat(this.predictKey,": distance from selector is lower than ").concat(this.predictPoint,"px, checking max pps")),this._predictWithPredictKey()):this._bindEvents())}},{key:"_isAllowedForPredictOnScrollEnd",value:function(){return this.isPixelsPoint}},{key:"_predictWithPredictKey",value:function(){this._onDistancePredicted(this.predictKey)}}])&&et(e.prototype,i),n&&et(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(M),lt=J(at),ct=i(9831),ut=i.n(ct);function dt(t){return dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dt(t)}function ht(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==dt(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==dt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===dt(o)?o:String(o)),n)}var r,o}function ft(t,e){return ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ft(t,e)}function pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=mt(t);if(e){var r=mt(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===dt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function mt(t){return mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mt(t)}var yt=i(1999),gt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ft(t,e)}(s,t);var e,i,n,o=pt(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"getAdFailPredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.allowedPredictPoints="predictors.getAdFail.allowedPredictPoints",e.keysToPredict=e.model.get(e.allowedPredictPoints),e.log.predict("predict created with keys to predict ".concat(e.keysToPredict)),e}return e=s,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"getAdState:failed",funcName:"_onFailedToGetAd"}])}},{key:"_onFailedToGetAd",value:function(){var t=this.model.get("lastFailedPredict");this._shouldPredict(t)&&(this.adProperties=this.model.get("lastFailedPredictProperties"),setTimeout(this._predicted.bind(this,this.model.get("lastFailedPredict")),200))}},{key:"_shouldPredict",value:function(t){var e=!1;return e=Array.isArray(this.keysToPredict)?yt.contains(this.keysToPredict,t):"any"===this.keysToPredict.toString()||this.keysToPredict===t,this.log.predict("can predict key ".concat(t," = ").concat(e)),e}}])&&ht(e.prototype,i),n&&ht(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h),vt=gt;function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function _t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==bt(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==bt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===bt(o)?o:String(o)),n)}var r,o}function St(t,e){return St=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},St(t,e)}function wt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Tt(t);if(e){var r=Tt(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Tt(t){return Tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Tt(t)}var Pt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&St(t,e)}(s,t);var e,i,n,o=wt(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"multiAdPredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPath="predictors.multiAd",e.predictPoints="".concat(e.predictPath,".predictPoints"),e.predictKey=t.predictKey,e.predictOptions=e.model.get("".concat(e.predictPoints,".").concat(e.predictKey)),e.log.predict("predict created with key = ".concat(e.predictKey)),e.predictOptions.hasOwnProperty("secondsUntilComplete")?(e.secondsUntilAdComplete=e.predictOptions.secondsUntilComplete,e.log.predict("predict created with key = ".concat(e.predictKey,", seconds to ad complete = ").concat(e.secondsUntilAdComplete)),e._bindPredictSecondsUntilAdEnd()):e.predictOptions.hasOwnProperty("qState")&&(e.adQState=e.predictOptions.qState,e.log.predict("predict created with key = ".concat(e.predictKey,", ad quartile = ").concat(e.adQState)),e._bindPredictAdQState()),e}return e=s,(i=[{key:"_bindPredictSecondsUntilAdEnd",value:function(){this.createStateHandlers([{event:"activeAdCurrentTime",funcName:"_checkAdTimeLeft"}])}},{key:"_bindPredictAdQState",value:function(){var t=this.adQState;this.createStateHandlers([{event:"adQState:".concat(t),funcName:"_onPredictPoint"}])}},{key:"_checkAdTimeLeft",value:function(){var t=this.model.get("adDuration");if(t){var e=t<this.secondsUntilAdComplete?t:this.secondsUntilAdComplete,i=this.model.get("activeAdCurrentTime");t-i<=e&&!this.timePredicted&&(this.timePredicted=!0,this.log.predict("ad duration = ".concat(t,", ad current time = ").concat(i)),this._onPredictPoint())}}},{key:"_allowPredict",value:function(){var t=this.model.get("activeAdData");return!(!(this.model.get("isEligibleToPlay")&&this.model.get("isMultiAd")&&t)||t.singleAd)}},{key:"_onPredictPoint",value:function(){if(this._allowPredict())return this.log.predict("allowing predict - in multi ad mode"),void this._predicted(this.predictKey);this.log.predict("disallowing predict - in single ad mode")}}])&&_t(e.prototype,i),n&&_t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h),At=Pt;function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function Ot(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Et(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Et(o)?o:String(o)),n)}var r,o}function Ct(t,e){return Ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ct(t,e)}function kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=It(t);if(e){var r=It(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Et(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function It(t){return It=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},It(t)}i(1999);var Rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ct(t,e)}(s,t);var e,i,n,o=kt(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).startWf=t.startWfFunc,e._init(),e}return e=s,(i=[{key:"_init",value:function(){this.initialized||(this.log=new r.Z({unitType:this.model.get("unitType"),className:"playerReadyPredict",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.predictPath="predictors.playerReady",this.predictKey=this.model.get(this.predictPath+".predictPoint"),this.predictPoint=this.predictPath+".predictPoint",this.initialized=!0,this.log.predict("predict created with key = ".concat(this.predictKey)))}},{key:"_bindEvents",value:function(){!this.initialized&&this._init(),"ready"===this.model.get("playerState")?(this.log.predict("player is ready"),this._onPlayerReady()):(this.log.predict("waiting for player ready event"),this.createStateHandlers([{event:"playerState:ready",funcName:"_onPlayerReady",isListenOnce:!0}]))}},{key:"_onPlayerReady",value:function(){this._predicted(this.predictKey)}}])&&Ot(e.prototype,i),n&&Ot(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h),Dt=Rt;function Vt(t){return Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vt(t)}function Nt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Vt(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Vt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Vt(o)?o:String(o)),n)}var r,o}function xt(t,e){return xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xt(t,e)}function jt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Mt(t);if(e){var r=Mt(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Vt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Mt(t){return Mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mt(t)}var Lt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xt(t,e)}(s,t);var e,i,n,o=jt(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"firstScrollPredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPath="predictors.firstScroll",e.predictPoints=e.predictPath+".predictPoints",e.predictKey=e.model.get(e.predictPath+".predictPoints"),e.startWf=t.startWfFunc,e.isPredicted=!1,e.log.predict("predict created with predict key = ".concat(e.predictKey)),e.model.get("isEligibleToPlay")?(e.log.predict("eligible to play on creation, calling predict"),e._callPredict()):e._onFirstScroll(),e}return e=s,(i=[{key:"_bindEvents",value:function(){w().once("window:scroll:change",this._onFirstScroll.bind(this)),this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_callPredict"}])}},{key:"_onFirstScroll",value:function(){if(!this.isPredicted){var t=window.pageYOffset,e=5,i=(0,_.default)(this.model.get("scrollSelector"))[0];if(void 0!==i){var n=i.clientHeight;t=n+i.scrollTop,e=n+5}e<=t?(this.log.predict("scrolled more than 5px, calling predict"),this._callPredict()):this._bindEvents()}}},{key:"_callPredict",value:function(){this.isPredicted||(this.isPredicted=!0,this._predicted(this.predictKey))}}])&&Nt(e.prototype,i),n&&Nt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h),Bt=Lt;function Ft(t){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ft(t)}function Ut(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Ft(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Ft(o)?o:String(o)),n)}var r,o}function Wt(t,e){return Wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wt(t,e)}function Ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=$t(t);if(e){var r=$t(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Ft(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function $t(t){return $t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$t(t)}var zt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wt(t,e)}(s,t);var e,i,n,o=Ht(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"emptyQueuePredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.log.predict("predict created"),e.predictKey=e.model.get("predictors.emptyQueue.predictPoints"),e._bindEmptyQueuePredict(),e}return e=s,(i=[{key:"_bindEvents",value:function(){}},{key:"_bindEmptyQueuePredict",value:function(){this.createStateHandlers([{event:"adManagerState:".concat(ct.adManagerState.empty),funcName:"_onQEmpty"}])}},{key:"_allowPredict",value:function(){return this.model.get("isMultiAd")}},{key:"_onQEmpty",value:function(){if(this.model.get("getAdState")!==ct.getAdState.gettingAd)return this.log.predict("queue is empty, no get ad is process"),void this._onPredictPoint();this.log.predict("queue is empty, waiting for get ad reply")}},{key:"_onPredictPoint",value:function(){if(this._allowPredict())return this.log.predict("predict allowed - in multi ad mode"),void this._predicted(this.predictKey);this.log.predict("predict disallowed - in single ad mode")}}])&&Ut(e.prototype,i),n&&Ut(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h),qt=zt;function Gt(t){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gt(t)}function Yt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Gt(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Gt(o)?o:String(o)),n)}var r,o}function Kt(t,e){return Kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Kt(t,e)}function Qt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Xt(t);if(e){var r=Xt(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Gt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Zt(t)}(this,i)}}function Zt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xt(t){return Xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xt(t)}i(1999);var Jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kt(t,e)}(a,t);var i,n,o,s=Qt(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"fullEligibilityPredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPoint=t.predictPoint,e.predictKey=e.model.get("predictors.fullEligibility.predictPoints"),e.predictPath="predictors.fullEligibility",e.startWf=t.startWfFunc,e.hadGetAdRv=!1,e.maxPPS=e.model.get("predictors.fullEligibility.maxPPS"),e.log.predict("predict created with key = ".concat(e.predictKey,", maxPPS = ").concat(e.maxPPS)),e.scrollManager=new I,e.model.get("".concat(e.predictPath,".isListenToScrollSpeedChange"))&&e.scrollManager.registerForPPSChange(e.onScrollSpeedChangeCallback.bind(Zt(e))),e._bindEvents(),e}return i=a,(n=[{key:"_bindEvents",value:function(){if(this.scrollManager)if(this.createStateHandlers([{event:"getAdState:".concat(ct.getAdState.gettingAd),funcName:"_onGettingAd",isListenOnce:!0}]),this.model.get("frameType")===e().FRAME_TYPE.plainPage)this.log.predict("listening to window scroll"),w().once("window:scroll:change",this._calcPredict.bind(this)),this.scrollManager.registerForScrollEnd(this._calcPredict.bind(this));else{var t=this.model.get("predictors.fullEligibility.checkPredictsSeconds");this.log.predict("checking eligibility every ".concat(t)),this.calcPredictInterval=setInterval(this._calcPredict.bind(this),1e3*t)}else this.log.predict("predict aborted, scroll manager not created")}},{key:"_onGettingAd",value:function(){if(1===this.model.get("lastGetAdKey"))return this.hadGetAdRv=!0,void this.log.predict("stop predict because get ad 1 in process");this.createStateHandlers([{event:"getAdState:".concat(ct.getAdState.gettingAd),funcName:"_onGettingAd",isListenOnce:!0}])}},{key:"_calcPredict",value:function(){this.hadGetAdRv||this.isPredicted||(this._canPredict()&&this.maxPPS&&Math.abs(this.scrollManager.pps)<this.maxPPS?(this.isPredicted=!0,this.calcPredictInterval&&(clearInterval(this.calcPredictInterval),this.calcPredictInterval=void 0),this.model.set("fullEligibilityPredicted",!0),this.log.predict("allowed due to max pps - current pps = ".concat(this.scrollManager.pps," is lower than max pps ").concat(this.maxPPS)),this._predicted(this.predictKey)):(this.log.predict("disallowed due to max pps - current pps = ".concat(this.scrollManager.pps," is higher than or equal to max pps ").concat(this.maxPPS)),w().once("window:scroll:change",this._calcPredict.bind(this))))}},{key:"_canPredict",value:function(){var t=this.model.get("adState")===ct.adState.playing,e=this.model.get("isEligibleToPlay"),i=this.model.get("isSkippedDistancePredict"),n=e&&i&&!t;if(this.log.predict("can predict = is eligible (".concat(e,") && skipped distance predict (").concat(i,") && no other ad playing (").concat(!t,") = ").concat(n)),n&&this._checkIsGet1OnlyOnAdLoaded()){var r=this.model.get("playerHasRvInQ");n=n&&r,this.log.predict("can predict = is player having RV1 in queue = ".concat(this.model.get("playerHasRvInQ")))}return n}},{key:"_isAllowedForPredictOnScrollEnd",value:function(){return this._canPredict()}},{key:"_predictWithPredictKey",value:function(){this._predicted(this.predictKey)}}])&&Yt(i.prototype,n),o&&Yt(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(h),te=J(Jt);function ee(t){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(t)}function ie(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==ee(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===ee(o)?o:String(o)),n)}var r,o}var ne=i(1999),re=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.model=e,this.log=new r.Z({unitType:"Util",className:"DeatchUtil",version:this.model.get("version"),isDebug:this.model.get("isDebug")})}var e,i,n;return e=t,(i=[{key:"setSliderSize",value:function(){if(this.detachToSlider=this.model.get("detachToSlider"),this.model.get("stickyCard.isActive")){var t=this.model.get("width"),e=this.model.get("height"),i=this.getStickyPosition();return this.detachToSlider.position.horizontalOffset=i.left,this.detachToSlider.position.verticalOffset=i.top,this.detachToSlider.position.horizontal="left",this.detachToSlider.position.vertical="top",this.model.set("detachToSlider.width",t),void this.model.set("detachToSlider.height",e)}this.originalSliderWidth&&(this.detachToSlider.width=this.originalSliderWidth,this.originalSliderWidth=void 0),this.originalSliderHeight&&(this.detachToSlider.height=this.originalSliderHeight,this.originalSliderHeight=void 0),this.originalSliderHeight=this.detachToSlider.height;var n=this.model.get("width"),r=this.detachToSlider.liquidSize.isActive?this.calcLiquidWidth():this.detachToSlider.width;(n>r||this.detachToSlider.liquidSize.isDisableWidthLimit)&&(n=r);var o=ne.getVideoHeightByRatio(n,this.model.get("aspectRatioNum")<=1?1.77:this.model.get("aspectRatioNum"));this.model.set("detachToSlider.width",n),this.model.set("detachToSlider.height",o)}},{key:"getStickyPosition",value:function(){var t=(0,_.default)(this.model.get("containerViewPlaceHolder")),e=t.length?t.offset().left:0,i=this.model.get("stickyCard.offset.top")||0,n=e+(this.model.get("stickyCard.offset.left")||0);return{top:"".concat(i),left:"".concat(n)}}},{key:"setSliderSizeVertical",value:function(){this.detachToSlider=this.model.get("detachToSlider");var t=ne.getVideoHeight(this.model.get("width")),e=this.detachToSlider.liquidSize.isActive?this.calcLiquidHeight():this.detachToSlider.height;t>e&&(t=e);var i=ne.getVideoWidthByRatio(t,this.model.get("aspectRatioNum"));this.model.set("detachToSlider.width",i),this.model.set("detachToSlider.height",t)}},{key:"calcLiquidWidth",value:function(){this.detachToSlider=this.model.get("detachToSlider");var t=this.detachToSlider.liquidSize.minWidth,e=this.detachToSlider.liquidSize.maxWidth,i=window.innerWidth*(this.detachToSlider.liquidSize.widthPercent/100);return e&&i>e&&(i=e),i<t&&(i=t),i}},{key:"calcLiquidHeight",value:function(){this.detachToSlider=this.model.get("detachToSlider");var t=this.detachToSlider.liquidSize.maxHeight,e=window.innerHeight*(this.detachToSlider.liquidSize.heightPercent/100);return t&&e>t&&(e=t),e}},{key:"setStickParams",value:function(){var t=this.model.get("stickyCard.navBarSelector"),e=document.querySelector(t),i=this.model.get("stickyCard.offset.top");if(e){var n=e.offsetHeight||0;this.model.set("stickyCard.offset.top",i+n)}}}])&&ie(e.prototype,i),n&&ie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),oe=function(){var t;return function(e){return t||(t=new re(e)),t}}(),se=oe;function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function le(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==ae(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===ae(o)?o:String(o)),n)}var r,o}function ce(t,e){return ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ce(t,e)}function ue(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=he(t);if(e){var r=he(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return de(t)}(this,i)}}function de(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function he(t){return he=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},he(t)}var fe=i(1999),pe=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ce(t,e)}(a,e);var i,n,o,s=ue(a);function a(e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(i=s.call(this,e)).log=new r.Z({unitType:i.model.get("unitType"),className:"intersectionPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPoint=e.predictPoint,i.predictKey=e.predictKey,i.isSliderOn=i.model.get("detachToSlider")&&(i.model.get("detachToSlider").isStartFromSlider||i.model.get("detachToSlider").isDetachToSlider),i.isSuperSlider=!!i.isSliderOn&&(i.model.get("detachToSlider.isStartFromSlider")&&i.model.get("detachToSlider.isDetachToSlider")),i.isAMP=i.model.get("frameType")===t.FRAME_TYPE.amp,i.predictPath="predictors.intersection",i.startWf=e.startWfFunc,i.utils=P(de(i),i.model),i.predictDelayTime=i.model.get("".concat(i.predictPath,".predictDelayTime")),i.scrollManager=new I,i.maxPPS=i.model.get("".concat(i.predictPath,".maxPPS")),i.log.predict("predict created with key = ".concat(i.predictKey,", predict point = ").concat(i.predictPoint,"% view, predictDelayTime = ").concat(i.predictDelayTime)),i._setSelector(),i}return i=a,(n=[{key:"_initObserver",value:function(){var t=[0,this.predictPoint/100];this.isAMP&&this.isSliderOn&&(this.detachUtil=se(this.model),this.detachUtil.setSliderSize(),t=fe.buildObserverThresholdList());var e={rootMargin:"0px",threshold:t};this.observer=new IntersectionObserver(this._observerCallback.bind(this),e),this.observer.observe(this.parentSelector)}},{key:"_setSelector",value:function(){if(!this.isSelectorFound){var t=this.utils.getParentSelector();t?(this.isSelectorFound=!0,this.selectorTimeOut&&(clearTimeout(this.selectorTimeOut),this.selectorTimeOut=void 0),this.parentSelector=t,this.log.predict("parent selector found, starting observer"),this.log.info("parentSelector found staring to predict viewability"),this._bindEvents(),this._initObserver()):(this.log.predict("parent selector couldn't be found, trying again in 1s"),this.log.info("no parentSelector can't predict distance waiting for parentSelector"),this.model.listenToOnce(this.model,"change:parentSelector",this._setSelector.bind(this)),this.selectorTimeOut=setTimeout(this._setSelector.bind(this),1e3))}}},{key:"_isIntersectingTest",value:function(t){return this.isAMP&&this.isSliderOn?t[0].intersectionRect.height>this.model.get("detachToSlider.height"):100*t[0].intersectionRatio>=this.predictPoint}},{key:"_observerCallback",value:function(t,e){var i=this.scrollManager.getPps();if(!this.isPredicted){var n=this._isIntersectingTest(t);this.isSuperSlider&&this.isAMP&&n&&this.model.set("isSliderEligibleToPlay",!0),n?this._isLowerThenMaxPPS()?(this._onPrediction(),this.log.predict("intersected and predicted")):this.log.predict("intersected but can't predict - current pps (".concat(i,") is higher then maxPps (").concat(this.maxPPS,")")):this.log.predict("lost intersection")}}},{key:"_isLowerThenMaxPPS",value:function(){return!this.maxPPS||Math.abs(this.scrollManager.getPps())<this.maxPPS}},{key:"_onPrediction",value:function(){this.isPredicted=!0,this.log.predict("predicted"),this._predicted(this.predictKey),this.observer.disconnect()}}])&&le(i.prototype,n),o&&le(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(h),me=pe;function ye(t){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(t)}function ge(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==ye(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===ye(o)?o:String(o)),n)}var r,o}function ve(t,e){return ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ve(t,e)}function be(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Se(t);if(e){var r=Se(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return _e(this,i)}}function _e(t,e){if(e&&("object"===ye(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Se(t){return Se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Se(t)}var we=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ve(t,e)}(s,t);var e,i,n,o=be(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"timePredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPath="predictors.time",e.modelKey=t.modelKey?t.modelKey:t.predictKey?"".concat(e.predictPath,".predictPoints.").concat(t.predictKey):e.predictPath,e.predictKey=t.predictKey||e.model.get("".concat(e.modelKey,".predictPoints")),e.isActive=e.model.get("".concat(e.modelKey,".isActive")),e.isActive?(e.length=1e3*e.model.get("".concat(e.modelKey,".lengthInSeconds")),e.length?(e.repeat=e.model.get("".concat(e.modelKey,".repeat"))||1,e.log.predict("predict created with key = ".concat(e.predictKey,", length = ").concat(e.length,"ms, repeat = ").concat(e.repeat)),e._bindTimePredict(),e._startPredictTimer(),e):_e(e)):_e(e)}return e=s,(i=[{key:"_bindEvents",value:function(){}},{key:"_bindTimePredict",value:function(){this.createStateHandlers([{event:"time:".concat(this.predictPath),funcName:"_startPredictTimer"}])}},{key:"_canRepeatPredict",value:function(){return this.repeat>0}},{key:"_canStartTimer",value:function(){return!this.stopped&&this._canRepeatPredict()}},{key:"_startPredictTimer",value:function(){var t=this;if(this._canStartTimer())return this.timer&&(this.timer=clearTimeout(this.timer)),this.log.info("Starting timer",this.predictKey),this.log.predict("repeating ".concat(this.repeat," more times")),void(this.timer=setTimeout((function(){--t.repeat,t._predicted(t.predictKey),t._startPredictTimer()}),this.length));this.log.predict("no more repeats")}},{key:"stop",value:function(){this.log.info("Timer predict stopped"),this.log.predict("stopping timer"),this.timer=clearTimeout(this.timer),this.stopped=!0}}])&&ge(e.prototype,i),n&&ge(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h),Te=we;function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function Ae(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Pe(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Pe(o)?o:String(o)),n)}var r,o}function Ee(t,e){return Ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ee(t,e)}function Oe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ce(t);if(e){var r=Ce(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Ce(t){return Ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ce(t)}i(1999);var ke=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ee(t,e)}(s,t);var e,i,n,o=Oe(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"mp4Predict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPath="predictors.mp4",e.predictKey=e.model.get(e.predictPath+".predictPoint"),e.predictPoint=e.predictPath+".predictPoint",e.log.predict("predict created with key = ".concat(e.predictKey)),e}return e=s,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"playerQueue",funcName:"_onPlayerQueueStatusChange"}])}},{key:"_onPlayerQueueStatusChange",value:function(){this.adsListFromPlayer=this.model.get("playerQueue"),this._allowPredict()?(this.log.predict("found rv1 video ad in player queue, predicting"),this._predicted(this.predictKey),this.model.stopListening(this.model,"change:playerQueue")):this.log.predict("didn't find rv1 video ad in player queue, waiting for next queue change")}},{key:"_allowPredict",value:function(){return this.adsListFromPlayer.filter((function(t){return"video"===t.mt&&!0===t.rv})).length>0}}])&&Ae(e.prototype,i),n&&Ae(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h),Ie=ke;function Re(t){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Re(t)}function De(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Re(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Re(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Re(o)?o:String(o)),n)}var r,o}function Ve(t,e){return Ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ve(t,e)}function Ne(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=xe(t);if(e){var r=xe(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Re(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function xe(t){return xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xe(t)}i(1999);var je=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ve(t,e)}(s,t);var e,i,n,o=Ne(s);function s(t,e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(i=o.call(this,t)).model=t,i.log=new r.Z({unitType:i.model.get("unitType"),className:i.constructor.name,version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.cardsSelector=e,i.usedCards=[],i}return e=s,(i=[{key:"_setMinDistance",value:function(){this.minCardDistance=this.model.get("cardsMinDistance")||0;var t=(0,_.default)(window).height();this.minCardDistance<t&&(this.minCardDistance=t,this.model.set("cardsMinDistance",t))}},{key:"getCard",value:function(t){}},{key:"cancelGetCard",value:function(){}},{key:"setCardAsUsed",value:function(t){this.usedCards.push(t)}},{key:"_getPlaceHolders",value:function(){}},{key:"_isElementBelowView",value:function(t){}}])&&De(e.prototype,i),n&&De(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(n.O),Me=je;function Le(t){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Le(t)}function Be(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Le(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Le(o)?o:String(o)),n)}var r,o}function Fe(t,e){return Fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Fe(t,e)}function Ue(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=We(t);if(e){var r=We(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Le(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function We(t){return We=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},We(t)}var He=i(1999),$e=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fe(t,e)}(o,t);var e,i,n,r=Ue(o);function o(t,e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(i=r.call(this,t)).model=t,i.cardsSelector=e,i.usedCards=[],i.shouldSearchForNewCard=!0,i._setMinDistance(),i._createDecisionFuncs(),i}return e=o,(i=[{key:"_createDecisionFuncs",value:function(){this.decisionsFuncs=[this._isNotUsedCard,this._isBelowUsedCard,this._viewPortFunc,this._isMinDistanceOk]}},{key:"getCard",value:function(t,e){if(this.shouldSearchForNewCard||e){e||this.log.info("searching for card");var i=void 0;this.cb=t;for(var n=this._getPlaceHolders(),r=n.length-1;r>=0;r--)this._isCardSuitable(n[r])&&(i=n[r]);i?(this.log.info("found card: ",i),this.model.set("eligiblePlaceholder",i),this._callCardCB(t,i)):(this.shouldSearchForNewCard=!1,this._registerListeners())}}},{key:"_getPlaceHolders",value:function(){var t=this.getElementsForMsnPlaceHolders();return this.model.get("msnWebComponentsEnabled")?this._getShadowDOMPlaceholders(t):this._getNonShadowDOMPlaceholders(t)}},{key:"_newShadowDomDrilldown",value:function(t,e){for(var i=0;i<e.length;i++)t&&t.shadowRoot&&(t=t.shadowRoot.querySelector(e[i]));return t}},{key:"_extractDrilldownArray",value:function(){return this.model.get("msnNewDomDrillDown")?this.model.get("msnNewDomDrillDown").split(","):[]}},{key:"_returnArrayOfShadowRootNodes",value:function(t){return t&&t.shadowRoot&&t.shadowRoot.querySelectorAll(this.cardsSelector)?Array.prototype.slice.call(t.shadowRoot.querySelectorAll(this.cardsSelector)):(0,_.default)(this.cardsSelector)}},{key:"getElementsForMsnPlaceHolders",value:function(){var t=this,e=document.querySelectorAll(this.model.get("msnFeedRootSelector")),i=this._extractDrilldownArray()||[],n=[];return He.forEach(e,(function(e){var r=t._newShadowDomDrilldown(e,i);r&&r.shadowRoot?n.push(t._returnArrayOfShadowRootNodes(r)):n.push(t._returnArrayOfShadowRootNodes(e))}),this),He.flattenArray(n)}},{key:"_getNonShadowDOMPlaceholders",value:function(t){var e=[];this.model.get("msnCanOpenFirstRow")?e=this._getRowPlaceHolder(1,this.model.get("msnMinimumCardInFirstRow")):this.model.get("msnCanOpenSecondRow")&&(e=this._getRowPlaceHolder(2,this.model.get("msnMinimumCardInSecondRow")));for(var i=0;i<t.length;i++)e.push(t[i]);return e}},{key:"_getNewShadowDomPlaceholder",value:function(t,e){if(e||e.shadowRoot){var i=e.shadowRoot.querySelector(this.model.get("msnNewDomSecondSizeSelector"));t.push(i.parentElement)}}},{key:"_getOriginalShadowDomPlaceholder",value:function(t,e){e&&e.parentElement&&t.push(e.parentElement)}},{key:"_getShadowDOMPlaceholders",value:function(t){var e=this,i=[],n=this.model.get("msnSizeSelector"),r=this.model.get("msnNewDomSizeSelector");return t&&t.length&&n&&t.forEach((function(t){if(t&&t.shadowRoot){var o=t.shadowRoot.querySelector(n),s=t.shadowRoot.querySelector(r);s?e._getNewShadowDomPlaceholder(i,s):e._getOriginalShadowDomPlaceholder(i,o)}})),i}},{key:"_getRowPlaceHolder",value:function(t,e){for(var i=[],n=[],r=document.querySelectorAll(this.model.get("msnUpperRowsSelector")),o=1,s=0,a=0;a<r.length&&o<=t;a++){var l=r[a],c=l.style.top&&He.convertRem(parseFloat(l.style.top));s!==c&&o++,o===t&&(!this.model.get("msnIsOpenOnSponsoredCards")&&l.querySelector(this.model.get("msnSponsoredSelector"))||n.push(l)),s=c}return n.length>=e&&("rtl"===document.querySelector("html").getAttribute("dir").toLowerCase()?i.push([n[1],n[0]]):i.push([n[0],n[1]])),i}},{key:"getEligiblePlaceHolders",value:function(){var t=this._getPlaceHolders()||[];return He.flattenArray(t)}},{key:"_isCardSuitable",value:function(t){for(var e=0;e<this.decisionsFuncs.length;e++){var i=this.decisionsFuncs[e].bind(this),n=t;if(He.isArray(t)&&(n=t[0]),!i(n))return!1}return!0}},{key:"_registerListeners",value:function(){w().once("window:scroll:change",this._onScroll.bind(this),this)}},{key:"_unRegisterListeners",value:function(){w().off("window:scroll:change",this._onScroll.bind(this),this)}},{key:"_callCardCB",value:function(t,e){this.shouldSearchForNewCard=!0,this.cb({cardToHide:He.isArray(e)?e[0]:e,additionalCard:He.isArray(e)?e[1]:void 0}),this.cb=void 0}},{key:"_onScroll",value:function(){this.getCard(this.cb,!0)}},{key:"setCardAsUsed",value:function(t){var e={cardEl:t,offsetTop:He.getTopOfEl(t)};He.extend(e,t.getBoundingClientRect()),e.offsetBottom=e.offsetTop+e.height,this.usedCards.push(e)}},{key:"_isNotUsedCard",value:function(t){return!this.usedCards.some((function(e){return e.cardEl===t}))}},{key:"_isBelowUsedCard",value:function(t){var e=He.getTopOfEl(t);return He.every(this.usedCards,(function(t){var i=t.offsetBottom;return e>i}))}},{key:"_viewPortFunc",value:function(t){return this.model.get("isOpenInViewPort")&&this._isCardInViewPort(t)||this._isElementBelowView(t)}},{key:"_isCardInViewPort",value:function(t){return He.getViewPercent(t,t.offsetWidth,t.offsetHeight)>=this.model.get("cardViewPercent")}},{key:"_isElementBelowView",value:function(t){return t.getBoundingClientRect().top>(window.innerHeight||document.documentElement.clientHeight)}},{key:"_isMinDistanceOk",value:function(t){var e=He.getTopOfEl(t),i=this.minCardDistance;return He.every(this.usedCards,(function(t){return e-t.offsetBottom>=i}))}}])&&Be(e.prototype,i),n&&Be(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Me),ze=$e;function qe(t){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qe(t)}function Ge(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==qe(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===qe(o)?o:String(o)),n)}var r,o}function Ye(t,e){return Ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ye(t,e)}function Ke(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Xe(t);if(e){var r=Xe(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Qe(this,i)}}function Qe(t,e){if(e&&("object"===qe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ze(t)}function Ze(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xe(t){return Xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xe(t)}var Je=i(1999),ti=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ye(t,e)}(s,t);var e,i,n,o=Ke(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"msnFullEligibilityPredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPath="predictors.msnFullEligibility",e.maxPPS=e.model.get("".concat(e.predictPath,".maxPPS")),e.predictKey=e.model.get("".concat(e.predictPath,".predictPoints")),e.msnWebComponentsEnabled=e.model.get("msnWebComponentsEnabled"),e.cardLocator=new ze(e.model,e.model.get("msnSelector")),e.scrollManager=new I,e.availableCardsElements=e.cardLocator.getEligiblePlaceHolders(),e.model.get("".concat(e.predictPath,".isListenToScrollSpeedChange"))&&e.scrollManager.registerForPPSChange(e.onScrollSpeedChangeCallback.bind(Ze(e))),Array.isArray(e.availableCardsElements)&&e.availableCardsElements.length?(e.msnWebComponentsEnabled?e._observeByScroll():e._observeByObserver(),e):Qe(e)}return e=s,(i=[{key:"_observeByScroll",value:function(){this.onScroll=this._onScroll.bind(this),w().on("window:scroll:change",this.onScroll)}},{key:"_onScroll",value:function(){var t=this;this.availableCardsElements.forEach((function(e){t.isPixelsPoint=Je.hasPassedPixelFromSelector(e,void 0,t.predictPoint,!1),t.isPixelsPoint&&t._canPredict()&&t.isPixelsPoint&&t._predictWithPredictKey()}))}},{key:"_observeByObserver",value:function(){this.intersectionObserver=new IntersectionObserver(this.intersectionCallback.bind(this),{root:null,threshold:1,rootMargin:"0px"}),this._observePossibleCards()}},{key:"_observePossibleCards",value:function(){var t=this;this.availableCardsElements.forEach((function(e){t.intersectionObserver.observe(e)}))}},{key:"intersectionCallback",value:function(t,e){this.isSelectorsInViewPort=t.some((function(t){return t.isIntersecting})),this.isSelectorsInViewPort&&this._canPredict()&&this.isSelectorsInViewPort&&this._predictWithPredictKey()}},{key:"_canPredict",value:function(){var t=this.scrollManager.getPps();if(t>this.maxPPS)return this.log.predict("Can't predict, current pps (".concat(t,") is higher then maxPps (").concat(this.maxPPS,")")),!1;var e=this.model.get("adState")===ct.adState.playing,i=this.model.get("isEligibleToPlay"),n=i&&!e;if(this.log.predict("can predict = is eligible (".concat(i,") && no other ad playing (").concat(!e,") = ").concat(n)),n&&this._checkIsGet1OnlyOnAdLoaded()){var r=this.model.get("playerHasRvInQ");n=n&&r,this.log.predict("can predict = is player having RV1 in queue = ".concat(this.model.get("playerHasRvInQ")))}return n}},{key:"_predictWithPredictKey",value:function(){w().off("window:scroll:change",this.onScroll),this._predicted(this.predictKey)}},{key:"_isAllowedForPredictOnScrollEnd",value:function(){return this._canPredict()}}])&&Ge(e.prototype,i),n&&Ge(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h),ei=J(ti),ii=i(6609),ni=i(1999),ri=i.n(ni);function oi(t){return oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oi(t)}function si(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==oi(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==oi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===oi(o)?o:String(o)),n)}var r,o}function ai(t,e){return ai=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ai(t,e)}function li(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ui(t);if(e){var r=ui(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===oi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ci(t)}(this,i)}}function ci(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ui(t){return ui=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ui(t)}function di(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,o,s,a=[],l=!0,c=!1;try{if(o=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=o.call(i)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=i.return&&(s=i.return(),Object(s)!==s))return}finally{if(c)throw r}}return a}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return hi(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return hi(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hi(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var fi=function(t,e){var i;return[0,0,-1*(ri().getRequiredHeight("data-card-index",t)*+(null!==(i=t.get("predictors.feedInViewPredict.firstCardHeightRatio"))&&void 0!==i?i:1)+ri().getFeedTitleHeight()+ri().getMarginToStartCard(t,'[data-card-index="'.concat(3,'"]'),e)),0].map((function(t){return"".concat(t,"px")})).join(" ")},pi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ai(t,e)}(s,t);var e,i,n,o=li(s);function s(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var i=(e=o.call(this,t)).model;e.predicted=!1,e.predictPath="predictors.feedInViewPredict";var n=i.get("".concat(e.predictPath,".predictPoints")),a=P(ci(e),e.model).getParentSelector();e.log=new r.Z({className:"feedInViewPredict",unitType:"".concat(i.get("unitType")," (").concat(i.get("subUnitType"),")"),version:i.get("version"),isDebug:i.get("isDebug")});var l,c,u,d=function(t){return function(i){return i.map((function(i){return e.log.debug(t(i),i),i}))}},h=(l=i,c="adState",u=function(){return l.get(c)},ii.ZP.fromEvents(l,["change",c].join(":")).map(u).skipDuplicates().toProperty(u)).map((function(t){return t!==ct.adState.playing})).thru(d((function(t){return"Ad is ".concat(t?"NOT PLAYING":"PLAYING")}))),f=i.get("permanentCard"),p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.root,n=void 0===i?null:i,r=e.threshold,o=void 0===r?0:r,s=e.rootMargin,a=void 0===s?"0px 0px 0px 0px":s;return ii.ZP.stream((function(e){var i=e.emit,r=new IntersectionObserver((function(t){var e=di(t,1)[0].isIntersecting;i(e)}),{root:n,threshold:o,rootMargin:a});return r.observe(t),function(){return r.disconnect()}}))}(a,f?{threshold:.5}:{threshold:0,rootMargin:fi(i,a)}).toProperty((function(){return!1})).thru(d((function(t){return"".concat(f?"Permanent card "+f:"Feed"," ").concat(t?"IN":"OUTSIDE"," view")}))),m=ii.ZP.fromEvents(window,"scroll"),y=ii.ZP.merge([m.map((function(){return!1})),m.debounce(1e3*(i.get("predictors.feedInViewPredict.scrollDebounceSeconds")||1)).map((function(){return!0}))]).toProperty((function(){return!0})).thru(d((function(t){return"User is ".concat(t?"NOT SCROLLING":"SCROLLING")})));return ii.ZP.combine([p,y,h],(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return e.every(Boolean)})).filter(Boolean).take(1).onValue((function(){e.log.predict("Positive prediction made"),e._predicted(n),e.isPredicted=!0})),e}return e=s,i&&si(e.prototype,i),n&&si(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(h),mi=pi;function yi(t){return yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yi(t)}function gi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==yi(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==yi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===yi(o)?o:String(o)),n)}var r,o}function vi(t,e){return vi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},vi(t,e)}function bi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Si(t);if(e){var r=Si(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return _i(this,i)}}function _i(t,e){if(e&&("object"===yi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Si(t){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Si(t)}var wi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vi(t,e)}(s,t);var e,i,n,o=bi(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"recoReelPredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPoint=t.predictPoint,e.predictKey=t.predictKey,e.predictPath="predictors.recoReel",e.scrollManager=new I,e.maxPPS=e.model.get("".concat(e.predictPath,".maxPPS")),e._setElement(),e.recoReelContainer?(e._initObserver(),e.log.predict("predict created with key = ".concat(e.predictKey,", predict point = ").concat(e.predictPoint,"% view")),e):_i(e)}return e=s,(i=[{key:"_setElement",value:function(){var t=this.model.get("recoReelContainer");t&&(this.recoReelContainer=t.parentElement)}},{key:"_initObserver",value:function(){var t={rootMargin:"0px",threshold:[0,this.predictPoint/100]};this.observer=new IntersectionObserver(this._observerCallback.bind(this),t),this.observer.observe(this.recoReelContainer)}},{key:"_isIntersectingTest",value:function(t){return 100*t[0].intersectionRatio>=this.predictPoint}},{key:"_observerCallback",value:function(t,e){var i=this.scrollManager.getPps();this.isPredicted||(this._isIntersectingTest(t)?this._isLowerThenMaxPPS()?(this._onPrediction(),this.log.predict("intersected and predicted")):this.log.predict("intersected but can't predict - current pps (".concat(i,") is higher then maxPps (").concat(this.maxPPS,")")):this.log.predict("lost intersection"))}},{key:"_isLowerThenMaxPPS",value:function(){return!this.maxPPS||Math.abs(this.scrollManager.getPps())<this.maxPPS}},{key:"_onPrediction",value:function(){this.isPredicted=!0,this.log.predict("predicted"),this._predicted(this.predictKey),this.observer.disconnect()}}])&&gi(e.prototype,i),n&&gi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h),Ti=wi;function Pi(t){return Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pi(t)}function Ai(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Pi(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Pi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Pi(o)?o:String(o)),n)}var r,o}function Ei(){return Ei="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ki(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}},Ei.apply(this,arguments)}function Oi(t,e){return Oi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Oi(t,e)}function Ci(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ki(t);if(e){var r=ki(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Pi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function ki(t){return ki=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ki(t)}var Ii=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Oi(t,e)}(s,t);var e,i,n,o=Ci(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"postRepeatPredictor",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPath="predictors.postRepeat",e.predictPoints=e.model.get("".concat(e.predictPath,".predictPoints")),e.waitBeforePredictMs=e.model.get("".concat(e.predictPath,".waitBeforePredictMs")),e}return e=s,(i=[{key:"_bindEvents",value:function(){Ei(ki(s.prototype),"_bindEvents",this).call(this),this.createStateHandlers([{event:"repeatShown",funcName:"_onRepeatShown"},{event:"repeatState:showing",funcName:"_onRepeatShown"},{event:"repeatState:clicked",funcName:"_onRepeatClicked"}])}},{key:"_onRepeatShown",value:function(){this._waitBeforePredicting()}},{key:"_isAllowedToPredict",value:function(){return this.model.get("isEligibleToPlay")?this.model.get("closeState")?(this.log.predict("unit is closed, ignoring"),!1):this.model.get("adState")!==ct.adState.playing||(this.log.predict("ad is playing"),!1):(this.log.predict("unit is not eligible to play, ignoring"),!1)}},{key:"_onRepeatClicked",value:function(){this.log.predict("clear post repeat predict timeout"),this.predictTimeout&&(clearTimeout(this.predictTimeout),this.predictTimeout=null),this.log.predict("post repeat predict timeout cleared")}},{key:"_waitBeforePredicting",value:function(){var t=this;this.log.predict("waiting for 2 seconds before predicting"),this.predictTimeout=setTimeout((function(){t._isAllowedToPredict()?(t.log.predict("predicting"),t._predicted(t.predictPoints),t.log.predict("predicted"),t.model.increaseCounter("postRepeatMode")):t.log.predict("Can't predict, ignoring")}),this.waitBeforePredictMs)}}])&&Ai(e.prototype,i),n&&Ai(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(h);function Ri(t){return Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ri(t)}function Di(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Ri(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Ri(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Ri(o)?o:String(o)),n)}var r,o}function Vi(t,e){return Vi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Vi(t,e)}function Ni(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ji(t);if(e){var r=ji(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Ri(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return xi(t)}(this,i)}}function xi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ji(t){return ji=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ji(t)}var Mi=i(1999),Li=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vi(t,e)}(s,t);var e,i,n,o=Ni(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).log=new r.Z({unitType:e.model.get("unitType"),className:"adxPredict",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictPath="predictors.adx",t.predictKey=e.model.get(e.predictPath+".predictPoint"),e._initPredict(t),e.utils=P(xi(e),e.model),e.maxPPS=e.model.get("".concat(e.predictPath,".maxPPS")),e.predictPoint=e.model.get("".concat(e.predictPath,".pixelsFromSelectors"))||100,e.model.get("".concat(e.predictPath,".isListenToScrollSpeedChange"))&&e.scrollManager.registerForPPSChange(e.onScrollSpeedChangeCallback.bind(xi(e))),e._bindAdxLoadEvent(),e.log.predict("predict created"),e}return e=s,(i=[{key:"_calcPredict",value:function(){this.predicted||(this.isPixelsPoint=Mi.hasPassedPixelFromSelector(this.parentSelectorStr,this.model.get("scrollSelector"),this.predictPoint,this.model.get("predictors.isNeedValidateParentSelector")),this.isPixelsPoint?(this.predicted=!0,this.log.info("distance from selector is lower than ".concat(this.predictPoint,"px")),this._loadAdxAd()):this._bindEvents())}},{key:"_bindAdxLoadEvent",value:function(){this.log.predict("listening to Adx events"),this.model.on("loadNewAdxAd",this._loadAdxAd.bind(this))}},{key:"_loadAdxAd",value:function(){this.log.predict("loading new adx and pulling from queue"),this._onDistancePredicted(this.predictKey)}}])&&Di(e.prototype,i),n&&Di(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(M),Bi=J(Li);function Fi(t){return Fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fi(t)}function Ui(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Fi(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Fi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Fi(o)?o:String(o)),n)}var r,o}var Wi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.syncUrl=e.get("sync"),this.syncUrl&&(this.log=new r.Z({unitType:e.get("unitType"),className:this.constructor.name,version:e.get("version"),isDebug:e.get("isDebug")}),this.timePredict=new Te({model:e,onPredict:this._syncCookies.bind(this),predictKey:"cookieSync",modelKey:"predictors.time.cookieSync"}),this._syncCookies())}var e,i,n;return e=t,(i=[{key:"_syncCookies",value:function(){var t=this;this.log.info("Cookie sync request",this.syncUrl);var e=document.createElement("iframe");e.style.display="none",e.src=this.syncUrl,e.onerror=function(){t._stopSync()},document.body.appendChild(e)}},{key:"_stopSync",value:function(){this.log.info("Stopping cookie sync"),this.timePredict.stop()}}])&&Ui(e.prototype,i),n&&Ui(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Hi=Wi,$i=i(5264),zi=i.n($i);function qi(t){return qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qi(t)}function Gi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==qi(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==qi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===qi(o)?o:String(o)),n)}var r,o}function Yi(t,e){return Yi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yi(t,e)}function Ki(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Qi(t);if(e){var r=Qi(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===qi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Qi(t){return Qi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qi(t)}var Zi=i(1999),Xi={viewability:{id:30,name:"viewability"},pauseAfterPlay:{id:31,name:"pauseAfterPlay"},conversion:{id:32,name:"adPlay"},clickThru:{id:33,name:"clickThru"},skipVimp1EligibilityLost:{id:43,name:"skipVimp1EligibilityLost"},skipVimp1Vimp0Playing:{id:44,name:"skipVimp1Vimp0Playing"},unitImpression:{id:45,name:"unitImpression"},continueAd:{id:46,name:"continueAd"},viewabilityOneS:{id:54,name:"viewabilityOneS"},adUnmuted:{id:58,name:"adUnmuted"},viewability100:{id:63,name:"viewability100"},adTitleClick:{id:74,name:"adTitleClick"},adCtaButtonClick:{id:75,name:"adCtaButtonClick"},adDescriptionClick:{id:76,name:"adDescriptionClick"},adBrandingClick:{id:77,name:"adBrandingClick"},adIconClick:{id:78,name:"adIconClick"},detach:{id:79,name:"detach"},attach:{id:80,name:"attach"},adSwappedOut:{id:104,name:"adSwappedOut"},adSwappedIn:{id:105,name:"adSwappedIn"},compView100:{id:107,name:"compView100"},pauseAfterPlayScrolledUp:{id:108,name:"pauseAfterPlayScrolledUp"},pauseAfterPlayScrolledDown:{id:109,name:"pauseAfterPlayScrolledDown"},pauseAfterPlaySwitchedTab:{id:110,name:"pauseAfterPlaySwitchedTab"},eligibilityLostScrolledUp:{id:111,name:"eligibilityLostScrolledUp"},eligibilityLostScrolledDown:{id:112,name:"eligibilityLostScrolledDown"},eligibilitySwitchedTab:{id:113,name:"eligibilitySwitchedTab"},oneSecondNoPlaySamePlace:{id:114,name:"oneSecondNoPlaySamePlace"},oneSecondNoPlayScrolledUp:{id:115,name:"oneSecondNoPlayScrolledUp"},oneSecondNoPlayScrolledDown:{id:116,name:"oneSecondNoPlayScrolledDown"},displayingFullNAS:{id:125,name:"displayingFullNAS"},displayingNASTitleOnly:{id:126,name:"displayingNASTitleOnly"},adPausedOtherUnitIsPlaying:{id:127,name:"adPausedOtherUnitIsPlaying"},reportingObserver:{id:129,name:"reportingObserver"},adPlayingNextAdReadyRV1:{id:142,name:"adPlayingNextAdReadyRV1"},adResumeAfterSwapOut:{id:145,name:"adResumeAfterSwapOut"},adPlayingRV1insteadRV0:{id:158,name:"adPlayingRV1insteadRV0"},skipVimp1Vimp1Playing:{id:160,name:"skipVimp1Vimp1Playing"},outOfTab:{id:171,name:"outOfTab"},backToTab:{id:172,name:"backToTab"},stickyDisabled:{id:174,name:"stickyDisabled"},adWaitForPubVideoToStop:{id:175,name:"adWaitForPubVideoToStop"},onImpressionError:{id:178,name:"onImpressionError"},nativeAdCallToActionButtonClick:{id:182,name:"nativeAdCallToActionButtonClick"},pubVideoPreventing:{id:197,name:"pubVideoPreventing"},adRenderedOnFeedIndexLessThanSCMitigationCard:{id:194,name:"adRenderedOnFeedIndexLessThanSCMitigationCard"},adRenderedOnFeedIndexEqualsSCMitigationCard:{id:195,name:"adRenderedOnFeedIndexEqualsSCMitigationCard"},adRenderedOnFeedIndexLargerThanSCMitigationCard:{id:196,name:"adRenderedOnFeedIndexLargerThanSCMitigationCard"},adInSCMitigationFlow:{id:198,name:"adInSCMitigationFlow"}},Ji=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yi(t,e)}(a,e);var i,n,o,s=Ki(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t.model)).model=t.model,e.adData=t.adData,e.reportFunc=t.reportFunc,e.getAdData=t.getAdDataFunc,e.unitVersion=e.model.get("unitVersion"),e.vpaidData=t.vpaidData,e.log=new r.Z({unitType:e.model.get("unitType"),className:"oppsService",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.predictId=t.predictId,e.isViewed=!1,e.hadConversion=!1,e.hadImpression=!1,e.isFirstPlayForAd=!0,e.pageEventHistory=window.cmTag.PEH,e.unifiedPlacementEH=window.cmTag.UPEH,e._fireUnitImpression(),e}return i=a,(n=[{key:"_fireUnitImpression",value:function(){this._fireOpp(Xi.unitImpression.id,Xi.unitImpression.name),this.reportFunc(Xi.unitImpression.name,{tab:this.model.get("isInTab"),eligibility:this.model.get("isEligibleToPlay"),gotVimpCountQ:this.model.get("impressionCount"),hadEligibility:this.model.get("hadEligibility"),hadLostEligibility:!!this.model.get("lostEligibilityTime")},!0),this.model.get("hadEligibility")||this.reportFunc("waitingForEligibilty",{tab:this.model.get("isInTab")},!1)}},{key:"fireSkipVimp1EligibilityLost",value:function(t){if(t){this._fireOpp(Xi.skipVimp1EligibilityLost.id,Xi.skipVimp1EligibilityLost.name);var e=this.subModel?this.subModel.get("videoViewContainer"):this.model.get("videoViewContainer");if(!e){var i=(0,_.default)(this.subModel?this.subModel.get("parentSelector"):this.model.get("parentSelector"));e=Zi.isArray(i)?i[0]:i}this.adData.pap=Zi.offsetFromBottomOfViewPort(e)+(0,_.default)(e).height()>0?1:0,this.model.get("isInTab")?this.adData.pap?(this._fireOpp(Xi.eligibilityLostScrolledUp.id,Xi.eligibilityLostScrolledUp.name),this.reportFunc(Xi.eligibilityLostScrolledUp.name,{},!0)):(this._fireOpp(Xi.eligibilityLostScrolledDown.id,Xi.eligibilityLostScrolledDown.name),this.reportFunc(Xi.eligibilityLostScrolledDown.name,{},!0)):(this._fireOpp(Xi.eligibilitySwitchedTab.id,Xi.eligibilitySwitchedTab.name),this.reportFunc(Xi.eligibilitySwitchedTab.name,{},!0))}this.reportFunc(Xi.skipVimp1EligibilityLost.name,{},!1)}},{key:"fireSkipVimp1AdIsPlaying",value:function(e){var i=e===t.RV_TYPES.NON_RV?Xi.skipVimp1Vimp0Playing:Xi.skipVimp1Vimp1Playing;this._fireOpp(i.id,i.name),this.reportFunc(i.name,{otherAdRequiredViewbility:this.model.get("activeAdData.requiredViewability"),otherAdPlayerSequenceId:this.model.get("activeAdData.tagData.sequenceId"),otherAdDp:this.model.get("activeAdData.dp")},!1)}},{key:"onConversion",value:function(){this.hadConversion||(this.shouldFirePauseAfterPlay=!0,this.hadConversion=!0,this._fireOpp(Xi.conversion.id,Xi.conversion.name),this.reportFunc(Xi.conversion.name,{},!0))}},{key:"fireAdUnmuted",value:function(){this.adUnmutedOppFired||(this._fireOpp(Xi.adUnmuted.id,Xi.adUnmuted.name),this.adUnmutedOppFired=!0)}},{key:"onFirstPauseAfterPlay",value:function(){if(this.shouldFirePauseAfterPlay&&!this.isViewed){this.shouldFirePauseAfterPlay=!1;var t=this.subModel?this.subModel.get("videoViewContainer"):this.model.get("videoViewContainer");t=Zi.isArray(t)?t[0]:t,this.adData.pap=Zi.offsetFromBottomOfViewPort(t)+(0,_.default)(t).height()>0?1:0,this._fireOpp(Xi.pauseAfterPlay.id,Xi.pauseAfterPlay.name),this.reportFunc(Xi.pauseAfterPlay.name,{tab:this.model.get("isInTab")},!0),this.model.get("isInTab")?this.adData.pap?(this._fireOpp(Xi.pauseAfterPlayScrolledUp.id,Xi.pauseAfterPlayScrolledUp.name),this.reportFunc(Xi.pauseAfterPlayScrolledUp.name,{},!0)):(this._fireOpp(Xi.pauseAfterPlayScrolledDown.id,Xi.pauseAfterPlayScrolledDown.name),this.reportFunc(Xi.pauseAfterPlayScrolledDown.name,{},!0)):(this._fireOpp(Xi.pauseAfterPlaySwitchedTab.id,Xi.pauseAfterPlaySwitchedTab.name),this.reportFunc(Xi.pauseAfterPlayScrolledUp.name,{},!0))}}},{key:"onViewabilityOneS",value:function(){this._fireOpp(Xi.viewabilityOneS.id,Xi.viewabilityOneS.name)}},{key:"onViewability",value:function(){this.isViewed=!0,this._fireOpp(Xi.viewability.id,Xi.viewability.name),this.reportFunc(Xi.viewability.name,{},!0)}},{key:"onViewability100",value:function(){this._fireOpp(Xi.viewability100.id,Xi.viewability100.name)}},{key:"onCompView100",value:function(){this._fireOpp(Xi.compView100.id,Xi.compView100.name)}},{key:"fireContinueAd",value:function(){this.isContinueAdFired||(this.isContinueAdFired=!0,this._fireOpp(Xi.continueAd.id,Xi.continueAd.name),this.reportFunc(Xi.continueAd.name,{tab:this.model.get("isInTab")},!0))}},{key:"onAdClicked",value:function(){this._fireOpp(Xi.clickThru.id),this.reportFunc(Xi.clickThru.name,{},!0),this.model.set("clickThruState",ct.clickThruState.waiting)}},{key:"onAdDetached",value:function(){this.model.get("opps.detach.isFire")&&(this._fireOpp(Xi.detach.id),this.reportFunc(Xi.detach.name,{},!0))}},{key:"onAdAttached",value:function(){this.model.get("opps.attach.isFire")&&(this._fireOpp(Xi.attach.id),this.reportFunc(Xi.attach.name,{},!0))}},{key:"fireTitleContaineClick",value:function(t){var e=Xi[t];e&&this._fireOpp(e.id,e.name)}},{key:"_fireOpp",value:function(t,e,i){if(this.adData&&t&&!this.model.get("isFireOppBlocked")){e&&this.log.info("Fire ".concat(e," opps"));var n={uv:this.unitVersion},r=this.getAdData();this._setExtraData(n,r);var o={tagItem:this.adData,playerDAST:this.adData.pdast,activeData:r,predictorId:this.predictId,extraData:n};zi().oppsula.send(o,t)}}},{key:"_setExtraData",value:function(t,e){t.pv=this.model.get("playerVersion"),e&&(t.su=e.su)}},{key:"_getAbTest",value:function(){return"".concat(this.model.get("abTest")).concat(this.adData.requiredViewabilityDrawn?"!ronrv":"").concat(this.adData.moatSampling?"!mtsmp":"").concat(Zi.isMidArticleOnReadMorePage(this.model.get("isHip"))?"!rdmr":"")}},{key:"isBillableEvent",value:function(t){return this.model.get("billableEvents").indexOf(t)>-1}},{key:"setSubModel",value:function(t){this.subModel=t}},{key:"_onSecondsToCloseGlobal",value:function(){this.reportFunc("secondsToCloseGlobal",{},!0)}},{key:"_onCloseButtonClick",value:function(){this.reportFunc("closeButtonClick",{},!0)}},{key:"_setSubUnitData",value:function(t,e){var i=this.model.get("isFireSP");for(var n in i){if(t!==parseInt(n)||!i[n])break;var r=this.getAdData();void 0!==r.sp&&(e.sp=r.sp)}var o=this.model.get("subUnitType");e.su||0===e.su||(e.su=o)}},{key:"_setModifiedPlacement",value:function(t){var e=this.model.get("modifiedPlacement");e&&(t.mp=e)}},{key:"_setCmTagParams",value:function(t){var e=this.model.get("oppsQS")||{};Zi.assignWithoutUndefinedValues(t,e)}},{key:"adSwappedOut",value:function(){this._fireOpp(Xi.adSwappedOut.id,Xi.adSwappedOut.name),this.reportFunc(Xi.adSwappedOut.name,{},!0)}},{key:"adSwappedIn",value:function(){this._fireOpp(Xi.adSwappedIn.id,Xi.adSwappedIn.name),this.reportFunc(Xi.adSwappedIn.name,{},!0)}},{key:"adResumeAfterSwapOut",value:function(){this._fireOpp(Xi.adResumeAfterSwapOut.id,Xi.adResumeAfterSwapOut.name),this.reportFunc(Xi.adResumeAfterSwapOut.name,{},!1)}},{key:"onOneSecondNoPlaySamePlace",value:function(){this._fireOpp(Xi.oneSecondNoPlaySamePlace.id,Xi.oneSecondNoPlaySamePlace.name),this.reportFunc(Xi.oneSecondNoPlaySamePlace.name,{},!0)}},{key:"onOneSecondNoPlayScrolledUp",value:function(){this._fireOpp(Xi.oneSecondNoPlayScrolledUp.id,Xi.oneSecondNoPlayScrolledUp.name),this.reportFunc(Xi.oneSecondNoPlayScrolledUp.name,{},!0)}},{key:"onOneSecondNoPlayScrolledDown",value:function(){this._fireOpp(Xi.oneSecondNoPlayScrolledDown.id,Xi.oneSecondNoPlayScrolledDown.name),this.reportFunc(Xi.oneSecondNoPlayScrolledDown.name,{},!0)}},{key:"onDisplayingFullNAS",value:function(){this.model.get("opps.displayingFullNAS.isFire")&&(this._fireOpp(Xi.displayingFullNAS.id,Xi.displayingFullNAS.name),this.reportFunc(Xi.displayingFullNAS.name,{},!0))}},{key:"onDisplayingNASTitleOnly",value:function(){this.model.get("opps.displayingNASTitleOnly.isFire")&&(this._fireOpp(Xi.displayingNASTitleOnly.id,Xi.displayingNASTitleOnly.name),this.reportFunc(Xi.displayingNASTitleOnly.name,{},!0))}},{key:"fireGenericOpp",value:function(t){var e=Xi[t];e&&(this._fireOpp(e.id,e.name),this.reportFunc(e.name,{},!0))}},{key:"fireBeaconOpp",value:function(t){var e=Xi[t];e&&(this._fireOpp(e.id,e.name,!0),this.reportFunc(e.name,{},!0))}},{key:"onAdPlayingNextAdReadyRV1",value:function(){this._fireOpp(Xi.adPlayingNextAdReadyRV1.id,Xi.adPlayingNextAdReadyRV1.name),this.reportFunc(Xi.adPlayingNextAdReadyRV1.name,{},!0)}},{key:"onAdPlayingRV1StackWithRV0",value:function(){this._fireOpp(Xi.adPlayingRV1insteadRV0.id,Xi.adPlayingRV1insteadRV0.name),this.reportFunc(Xi.adPlayingRV1insteadRV0.name,{},!0)}},{key:"hadViewabilityAfterConversion",value:function(){return this.hadConversion&&this.isViewed}},{key:"outOfTab",value:function(){this._fireOpp(Xi.outOfTab.id,Xi.outOfTab.name)}},{key:"backToTab",value:function(){this._fireOpp(Xi.backToTab.id,Xi.backToTab.name)}},{key:"stickyDisabled",value:function(){this._fireOpp(Xi.stickyDisabled.id,Xi.stickyDisabled.name)}},{key:"adWaitForPubVideoToStop",value:function(){this._fireOpp(Xi.adWaitForPubVideoToStop.id,Xi.adWaitForPubVideoToStop.name)}},{key:"onImpressionError",value:function(){this._fireOpp(Xi.onImpressionError.id,Xi.onImpressionError.name)}},{key:"onNativeAdCallToActionButtonClick",value:function(){this._fireOpp(Xi.nativeAdCallToActionButtonClick.id,Xi.nativeAdCallToActionButtonClick.name)}},{key:"adRenderedOnFeedIndexLessThanSCMitigationCard",value:function(){this._fireOpp(Xi.adRenderedOnFeedIndexLessThanSCMitigationCard.id,Xi.adRenderedOnFeedIndexLessThanSCMitigationCard.name)}},{key:"adRenderedOnFeedIndexEqualsSCMitigationCard",value:function(){this._fireOpp(Xi.adRenderedOnFeedIndexEqualsSCMitigationCard.id,Xi.adRenderedOnFeedIndexEqualsSCMitigationCard.name)}},{key:"adRenderedOnFeedIndexLargerThanSCMitigationCard",value:function(){this._fireOpp(Xi.adRenderedOnFeedIndexLargerThanSCMitigationCard.id,Xi.adRenderedOnFeedIndexLargerThanSCMitigationCard.name)}},{key:"adInSCMitigationFlow",value:function(){this._fireOpp(Xi.adInSCMitigationFlow.id,Xi.adInSCMitigationFlow.name)}}])&&Gi(i.prototype,n),o&&Gi(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.O),tn=Ji,en=i(914),nn=i(2167),rn=i.n(nn);i(5666);function on(t){return on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},on(t)}function sn(){sn=function(){return e};var t,e={},i=Object.prototype,n=i.hasOwnProperty,r=Object.defineProperty||function(t,e,i){t[e]=i.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function u(t,e,i,n){var o=e&&e.prototype instanceof g?e:g,s=Object.create(o.prototype),a=new I(n||[]);return r(s,"_invoke",{value:E(t,i,a)}),s}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",f="suspendedYield",p="executing",m="completed",y={};function g(){}function v(){}function b(){}var _={};c(_,s,(function(){return this}));var S=Object.getPrototypeOf,w=S&&S(S(R([])));w&&w!==i&&n.call(w,s)&&(_=w);var T=b.prototype=g.prototype=Object.create(_);function P(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function A(t,e){function i(r,o,s,a){var l=d(t[r],t,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==on(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return i("throw",t,s,a)}))}a(l.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function E(e,i,n){var r=h;return function(o,s){if(r===p)throw new Error("Generator is already running");if(r===m){if("throw"===o)throw s;return{value:t,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var l=O(a,n);if(l){if(l===y)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var c=d(e,i,n);if("normal"===c.type){if(r=n.done?m:f,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=m,n.method="throw",n.arg=c.arg)}}}function O(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,O(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,y;var s=o.arg;return s?s.done?(i[e.resultName]=s.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,y):s:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,y)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function R(e){if(e||""===e){var i=e[s];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function i(){for(;++r<e.length;)if(n.call(e,r))return i.value=e[r],i.done=!1,i;return i.value=t,i.done=!0,i};return o.next=o}}throw new TypeError(on(e)+" is not iterable")}return v.prototype=b,r(T,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:v,configurable:!0}),v.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(T),t},e.awrap=function(t){return{__await:t}},P(A.prototype),c(A.prototype,a,(function(){return this})),e.AsyncIterator=A,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var s=new A(u(t,i,n,r),o);return e.isGeneratorFunction(i)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},P(T),c(T,l,"Generator"),c(T,s,(function(){return this})),c(T,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function r(n,r){return a.type="throw",a.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),k(i),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;k(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:R(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function an(t,e,i,n,r,o,s){try{var a=t[o](s),l=a.value}catch(t){return void i(t)}a.done?e(l):Promise.resolve(l).then(n,r)}function ln(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function cn(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ln(Object(i),!0).forEach((function(e){un(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ln(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function un(t,e,i){return(e=hn(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function dn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hn(n.key),n)}}function hn(t){var e=function(t,e){if("object"!==on(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==on(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===on(e)?e:String(e)}var fn=i(1999),pn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sessionId=this._setSessionId(e.model),this._setData(e.model),this.sendingDataToElastic=this._decideSendingDataToElastic(e.model),this.kbnul=e.model.get("kbnul"),this.apiUrl="".concat(this.kbnul,"/putes/unitsanalytics"),this.events=[],this.timeFromSessionStart=this._getCurrentTime(),this.maxEventsToLog=e.model.get("elasticLogger.maxEventsToLog"),this.sendingDataToElastic&&(this.sendInterval=setInterval(this.sendDataToElastic.bind(this),1e3*e.model.get("elasticLogger.secondsBetweenEvents")))}var e,i,n,r,o;return e=t,i=[{key:"_setData",value:function(t){var e={unitType:t.get("unitType"),subUnit:t.get("subUnitType"),wurflData:{os:{name:t.get("wurfl.os.name"),version:t.get("wurfl.os.version")},browser:{name:t.get("wurfl.browser.name"),version:t.get("wurfl.browser.version")}},frameType:t.get("frameType"),country:t.get("country"),abTest:t.get("abTest"),unitVersion:t.get("unitVersion"),playerVersion:this._cleanPlayerVersion(t.get("player.urls.playerLocation")),liteUnitVersion:t.get("liteUnitVersion"),dast:t.get("dast"),redId:t.get("redId"),isApp:t.get("isApp")};this.data={_id:this.sessionId,session_data:cn(cn({},e),t.get("isApp")?{appName:t.get("appName"),appId:t.get("appId")}:{})}}},{key:"_cleanPlayerVersion",value:function(t){return t.substring(t.lastIndexOf("/")+1)}},{key:"isSendingDataToElastic",value:function(){return this.sendingDataToElastic}},{key:"_decideSendingDataToElastic",value:function(t){return t.get("elasticLogger.isActive")&&fn.isFactor(t.get("gaFactor"))&&t.get("isReportToKibana")?(t.set("gaFactor",1),t.set("shouldSendDataToElastic",!0),!0):(t.set("shouldSendDataToElastic",!1),!1)}},{key:"_setSessionId",value:function(t){var e=fn.generateGuid(10);return t.set("elasticSessionId",e),e}},{key:"log",value:function(t){var e=t.message,i=t.severity,n=t.extraData;this.events.length>=this.maxEventsToLog||this.events.push({eventData:{message:e,severity:i,extraData:n},timeFromSessionStart:this._getCurrentTime()-this.timeFromSessionStart})}},{key:"sendDataToElastic",value:(r=sn().mark((function t(){var e;return sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.data.timeline=this._buildTimeline(),t.prev=1,t.next=4,fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(this.data)});case 4:return e=t.sent,t.next=7,e.json();case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),this.error=t.t0.message;case 12:this.events=[];case 13:case"end":return t.stop()}}),t,this,[[1,9]])})),o=function(){var t=this,e=arguments;return new Promise((function(i,n){var o=r.apply(t,e);function s(t){an(o,i,n,s,a,"next",t)}function a(t){an(o,i,n,s,a,"throw",t)}s(void 0)}))},function(){return o.apply(this,arguments)})},{key:"_getCurrentTime",value:function(){return(new Date).getTime()}},{key:"_buildTimeline",value:function(){var t={};return this.events=this.events.sort((function(t,e){return t.timeFromSessionStart-e.timeFromSessionStart})),this.events.forEach((function(e,i){t["ev".concat(i)]=e})),t}}],i&&dn(e.prototype,i),n&&dn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),mn="info",yn="warning";function gn(t){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gn(t)}function vn(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function bn(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?vn(Object(i),!0).forEach((function(e){_n(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):vn(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function _n(t,e,i){return(e=wn(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Sn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wn(n.key),n)}}function wn(t){var e=function(t,e){if("object"!==gn(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==gn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===gn(e)?e:String(e)}function Tn(t,e){return Tn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Tn(t,e)}function Pn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=An(t);if(e){var r=An(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===gn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function An(t){return An=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},An(t)}var En=i(1999),On=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tn(t,e)}(a,e);var i,n,o,s=Pn(a);function a(t){var e,i=t.model,n=t.ppKey,o=t.adId,l=t.impressionCb,c=t.completeCb,u=t.predictName,d=t.getAdProperties,h=t.predictId;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,i)).model=i,e.elasticLogger=e.model.get("elasticLogger"),e.getAdKey=isNaN(parseInt(n))?n:parseInt(n),e.adId=o,e.impressionCb=l,e.completeCb=c,e.predictName=u,e.predictId=h,e.scrollManager=new I,e.getAdProperties=d||{},e.handleAdjacencyAd(),e.log=new r.Z({unitType:e.model.get("unitType"),className:"adService",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.adState=ct.readyState,e.getAdState=ct.getAdState.notCalled,e.adQState=ct.adQState.readyState,e.hadPlay=!1,e.isActive=!1,e.hadImpression=!1,e.sizeObj={},e.adClickCounter=0,e.onAdImpressionTimer=null,e.onAdImpressionTimerMp4=null,e._bindEvents(),e._onPlayerStateReady(),e._getAd(),e.isLostView100=!1,e.allowReportCardOnlyOnce=!0,e.allowReportMitigationOnlyOnce=!0,e.getAdExtraOptions=null,e}return i=a,n=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adManagerState:paused",funcName:"_pauseGetAd",isListenOnce:!0},{event:"adManagerState:stopped",funcName:"_stopGetAd",isListenOnce:!0},{event:"playerState:ready",funcName:"_onPlayerStateReady",isListenOnce:!0},{event:"adViewabilityFired:true",funcName:"adViewabilityFired",isListenOnce:!0},{event:"adConversionFired:true",funcName:"adConversionFired",isListenOnce:!0},{event:"adWaitForPubVideoToStop",funcName:"_onAdWaitForPubVideoToStop",isListenOnce:!0}])}},{key:"_bindOnTabEvent",value:function(){this.createStateHandlers([{event:"isInTab:false",funcName:"_outOfTabEvent",isListenOnce:!0},{event:"isInTab:true",funcName:"_backToTabEvent",isListenOnce:!0}])}},{key:"_onPlayerStateReady",value:function(){!this.player&&zi().player&&(this.player=zi().player)}},{key:"_pauseGetAd",value:function(){this.cancelGetAd(),this.getAdState=ct.getAdState.stopped,this.setToModel("getAdState",ct.getAdState.stopped),this.model.get("isReplayAd")||(this.player=void 0)}},{key:"_stopGetAd",value:function(){this.cancelGetAd(),this.getAdState=ct.getAdState.finished,this.player=void 0}},{key:"adViewabilityFired",value:function(){if(this._hasVpaidWrapper()&&this.vpaidWrapper.emit){this.vpaidWrapper.emit("unit::viewability");var t=this.vpaidWrapper.getVpaidData(),e=t&&t.eventTrackers&&t.eventTrackers.viewability;En.each(e,this._sendPixel,this)}this.isViewabilityFired=!0}},{key:"adConversionFired",value:function(){this._hasVpaidWrapper()&&this.vpaidWrapper.emit&&(this._setBottomOfVViewPort(),this.vpaidWrapper.emit("unit::conversion"))}},{key:"_getAd",value:function(){var e=this;if(!this._hasPlayer()||!this.player.getAd)return this.setToModel("getAdCurrId",this.adId),void setTimeout(this.setToModel.bind(this,"getAdState",ct.getAdState.failed),0);if(this.getAdState!==ct.getAdState.gettingAd){if(this.adRequestTime=Date.now(),this.model.get("bottomOfViewPortDebugSelector")){var i=(0,_.default)(this.model.get("bottomOfViewPortDebugSelector"));this.bottomOfViewPortOnGetAd=i.length>0&&En.offsetFromBottomOfViewPort(i[0])}this.log.info("GetAd was called, requiredViewability: ".concat(this.getAdKey,", time =").concat(this.adRequestTime," ")),this.getAdPPS=this.scrollManager.pps,this.getAdPPSChange=this.scrollManager.ppsChange,this.setToModel("lastGetAdKey",this.getAdKey),this.model.get("getAdState")===ct.getAdState.gettingAd?this.model.trigger("change:getAdState",this.model,this.model.get("getAdState")):this.setToModel("getAdState",ct.getAdState.gettingAd),this.getAdState=ct.getAdState.gettingAd;var n=this.model.get("exploreMore")>0;this._setAdExclusions(this.model.get("exclusionOptions"));var r={getAdTimeout:this._getTimeOut(),adProperties:this.getAdProperties.adProperties,excAdProperties:this.getAdProperties.excAdProperties,forceWf:n,predictId:this.predictId,preferPPD:this.model.get("PPD.preferPPD"),ppdAdImpressionTimeout:this.model.get("PPD.ppdTimeout"),extraOptions:bn({},this.getAdExtraOptions)};"any"!==this.getAdKey&&(r.requiredViewability=this.getAdKey),this.getAdResult=this.player.getAd(r),this._logEventUsingElasticLogger("getAd was called",mn,{predictPointKey:this.getAdKey,predictName:this.predictName}),this.getAdKey===t.RV_TYPES.RV&&(this.model.set("isGettingRv1Ad",!0),this.predictId===t.PREDICT_NAMES.adxPredict&&this.model.set("adxInPrediction",!0)),this.getAdResult?this.getAdResult.then(this._getAdResult.bind(this),this._getAdRejection.bind(this)).catch(this._getAdCatch.bind(this)).finally((function(){e.getAdKey===t.RV_TYPES.RV&&(e.model.set("isGettingRv1Ad",!1),e.model.set("adxInPrediction",!1))})):this.log.error("getAd Failed in auction  manager")}else this.log.info("[adID=${trimmedBranch}]getAd was called while trying to get an ad from player",this.adId)}},{key:"_setAdExclusions",value:function(e){if(e){var i=e.excAdType,n=e.excReason,r=i===t.ADX.ITEM_TYPE&&(En.isArray(n)?n.includes(t.EXC_REASONS.PUBVIDEO):n===t.EXC_REASONS.PUBVIDEO),o=i===t.ADX.ITEM_TYPE&&(En.isArray(n)?n.includes(t.EXC_REASONS.DETACH_TO_SLIDER):n===t.EXC_REASONS.DETACH_TO_SLIDER)&&this.model.get("videoViewState")!==ct.videoViewState.attached;r&&(this.model.set("beforeGetAd","checkPubVideo"),this.model.get("isPubVideoReady")&&(this._excludeADXAd("pubVideoDetected"),this.getAdExtraOptions={adxPubVideoPreventing:!0})),o&&this._excludeADXAd("notAttachedToSelector")}}},{key:"_excludeADXAd",value:function(e){var i={t:[t.ADX.ITEM_TYPE],advId:[t.ADX.ADVERTISER],advType:[t.ADX.ADVTYPE]};this.getAdProperties.excAdProperties?this.getAdProperties.excAdProperties=Object.assign(this.getAdProperties.excAdProperties,i):this.getAdProperties.excAdProperties=i,this.reportToVpaid("adxAdExcluded",{reason:e,adType:"adx"},!1)}},{key:"_getAdRejection",value:function(t){this.log.error("getAdResult promise rejected: ".concat(t.message," ")),this.model.set("getAdSuccess",!1)}},{key:"_getAdResult",value:function(e){try{var i;if(En.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoGotAd",t.TRC_PERFORMANCE_ACTIONS.START),this.vpaidWrapper=e,this._setAdTypeConfig(),this.rpox=e.tag.rpox,this.vpaidData=this.vpaidWrapper.getVpaidData(),this.adData=En.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon","requiredViewability","rpox","hip","alwsldr"]),this.adData.cpm=this.vpaidWrapper.tag.vpaidWrapperData&&this.vpaidWrapper.tag.vpaidWrapperData.vastPrice?this.vpaidWrapper.tag.vpaidWrapperData.vastPrice:this.vpaidWrapper.tag.price,this.adData.requiredViewability=En.parseBool(this.adData.requiredViewability),this.adData.getAdPPS=this.getAdPPS,this.adData.advType=null!==(i=this.vpaidWrapper.tag.advType)&&void 0!==i?i:"-1",this.adData.getAdPPSChange=this.getAdPPSChange,this.adData.timeToVimp=Date.now()-this.adRequestTime,this.model.get("bottomOfViewPortDebugSelector")&&this.bottomOfViewPortOnGetAd){var n=(0,_.default)(this.model.get("bottomOfViewPortDebugSelector"));this.adData.bovpg=!!this.bottomOfViewPortOnGetAd&&parseInt(this.bottomOfViewPortOnGetAd),this.adData.bovpv=n.length>0&&parseInt(En.offsetFromBottomOfViewPort(n[0]))}this.adData.dast=this.vpaidWrapper.tag.vidDast||this.vpaidWrapper.tag.dast,this.adData.mty=this.vpaidWrapper.tag.vpaidWrapperData&&this.vpaidWrapper.tag.vpaidWrapperData.mediatype?this.vpaidWrapper.tag.vpaidWrapperData.mediatype:void 0,this.setToModel("currentMediatype",this.adData.mty),this.adData.moatSampling=this.vpaidWrapper.tag.moatSampling||!1,this.adData.requiredViewabilityDrawn=this.vpaidWrapper.tag.requiredViewabilityDrawn||!1,this.vpaidWrapper.playerDAST&&this.vpaidWrapper.playerDAST.get&&(this.adData.pdast=this.vpaidWrapper.playerDAST.get()),this.adData.hip=!!this.vpaidWrapper.tag.hip,this.vpaidWrapper.vpaidLog.data.unit_history=[],this.reportToVpaid("gotAd",{tab:this.model.get("isInTab"),eligibility:this.model.get("isEligibleToPlay"),gotVimpCountQ:this.model.get("impressionCount"),hadEligibility:this.model.get("hadEligibility"),hadLostEligibility:!!this.model.get("lostEligibilityTime"),predictName:this.predictName,getAdKey:"any"===this.getAdKey?10:this.getAdKey,allowSlider:!!this.adData.alwsldr},!1),this._logEventUsingElasticLogger("getAd resolve"),this.setToModel("lastGotAdData",this.adData),this.model.get("lastImpressionData.sequenceId")?this.sequenceId=this.model.get("lastImpressionData.sequenceId")+1:this.sequenceId=1;var r=void 0;return this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.data&&(r=this.vpaidWrapper.vpaidLog.data._id),this.lastImpressionData={predictPoint:this.predictPoint,requiredViewability:this.vpaidWrapper.tag.requiredViewability,getAdKey:"any"===this.getAdKey?10:this.getAdKey,sequenceId:this.sequenceId,dp:this.vpaidWrapper.tag.dp,tagData:En.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]),vpaidId:r,lineItemId:this.vpaidWrapper.tag.lineItemId,predictName:this.predictName},this.setToModel("lastImpressionData",this.lastImpressionData),this.setToModel("impressionCount",this.model.get("impressionCount")+1),this.oppsService=new tn({model:this.model,adData:this.adData,vpaidData:this.vpaidData,reportFunc:this.reportToVpaid.bind(this),getAdDataFunc:this.getAdData.bind(this),predictId:this.predictId}),this.log.info("GotAd requiredViewability: ".concat(e.tag.requiredViewability?1:0)),this.getAdState=ct.getAdState.gotAd,this.setToModel("getAdState",ct.getAdState.gotAd),this.getAdResult=void 0,this._registerListeners(),this._onAdImpression(e),this.model.set("getAdSuccess",!0),this._bindOnTabEvent(),this._setAdRV(),null}catch(t){this._clearOnAdImpressionTimer(),this.oppsService&&this.oppsService.onImpressionError(),this.log.error(t)}finally{En.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoGotAd",t.TRC_PERFORMANCE_ACTIONS.STOP)}}},{key:"_getAdCatch",value:function(t){this.hadImpression||(this.getAdResult=void 0,this.log.info("GetAd failed requiredViewability: ".concat(this.getAdKey),this.adId),this.getAdState=ct.getAdState.failed,this.setToModel("getAdCurrId",this.adId),this.setToModel("getAdState",ct.getAdState.failed))}},{key:"_registerListeners",value:function(){this.vpaidWrapper.on&&(this.vpaidWrapper.on("AdError",this._onAdError.bind(this)),this.vpaidWrapper.on("AdVideoFirstQuartile",this._onAdVideoFirstQuartile.bind(this)),this.vpaidWrapper.on("AdVideoMidpoint",this._onAdVideoMidpoint.bind(this)),this.vpaidWrapper.on("AdVideoThirdQuartile",this._onAdVideoThirdQuartile.bind(this)),this.vpaidWrapper.on("end",this._adVideoEnd.bind(this)),this.vpaidWrapper.on("AdClickThru",this._onAdClickThru.bind(this)),this.vpaidWrapper.on("activeAdCurrentTime",this._onActiveAdCurrentTime.bind(this)),this.vpaidWrapper.on("NewCompletion",this._onNewCompletion.bind(this)))}},{key:"_onActiveAdCurrentTime",value:function(t){this.isCompleted||(this.setToModel("activeAdCurrentTime",t.currentTime),this.setToModel("activeAdMaxTime",t.duration))}},{key:"_onAdImpression",value:function(t){this.vpaidWrapper.pauseAd(),this.reportToVpaid("pauseAdCalled",{reason:"pauseOnAdImpression",tab:this.model.get("isInTab")},!1),this._bringToBack(),this.log.info("onAdImpression (got ad - pausing ad)",this.adId),this.hadImpression=!0,this.rpox=t.tag.rpox,this.adQState=ct.adQState.impression;var e={lineItemId:this.model.get("lineItemId"),placement:this.model.get("placement"),redId:this.model.get("redId")};this.model.get("isSendCPM")&&(e.cpm=this.adData.cpm),w().trigger("onImpression",e);var i=t.getVpaidData();this.adData.timeToImpression=i.startTimestamp?Date.now()-i.startTimestamp:void 0,this.model.get("adQState")===ct.adQState.impression?setTimeout(this.model.trigger.bind(this.model,"change:adQState",this.adQState),0):setTimeout(this.setToModel.bind(this,"adQState",this.adQState),0),this.impressionCb(this),En.sendingEventToTaboolaBridge("impression",this.adId),this.adData.requiredViewability&&(this.setToModel("player.settings.startDelay",0),this._startOneSecondNoPlayTimer()),this._logEventUsingElasticLogger("ad impression")}},{key:"_onAdError",value:function(t){this._clearOnAdImpressionTimer(),this.log.error("Vpaid Wrapper Error, key: "+this.getAdKey,this.adId),En.sendingEventToTaboolaBridge("adError",this.adId)}},{key:"_onAdVideoFirstQuartile",value:function(){this.hadPlay&&(this.adQState=ct.adQState.q1,this.setToModel("adQState",ct.adQState.q1,this.adId),this.log.info("AdVideoFirstQuartile"),En.sendingEventToTaboolaBridge("firstQuartile",this.adId))}},{key:"_onAdVideoMidpoint",value:function(){this.hadPlay&&(this.adQState=ct.adQState.q2,this.setToModel("adQState",ct.adQState.q2,this.adId),this.log.info("AdVideoMidpoint"),En.sendingEventToTaboolaBridge("midpoint",this.adId))}},{key:"_onAdVideoThirdQuartile",value:function(){this.hadPlay&&(this.adQState=ct.adQState.q3,this.setToModel("adQState",ct.adQState.q3,this.adId),this.log.info("AdVideoThirdQuartile"),En.sendingEventToTaboolaBridge("thirdQuartile",this.adId))}},{key:"_adVideoEnd",value:function(t){if(this.player){var e=this.subModel||this.model;if(this.model.get("isReplayAd")||e.stopListening(e,"change:nativeAdClick"),this.isAdxAd){var i=this.model.get("adxSessionDuration")||0;this.model.set("adxSessionDuration",i+t.adElapsedDuration)}if(this._setAdPlayingWithAdChoice(!1),this.log.info("on ad video end",this.adId),this.reportToVpaid("vpaidDone",{tab:this.model.get("isInTab")},!0),this.isCompleted=!0,!this.hadPlay)return this.adState=ct.adState.autoKill,void this.completeCb(this,!0);this.setToModel("activeTag",void 0),this.adQState=ct.adQState.completed,this.adState=ct.adState.completed,this.completeCb(this,!1),this.model.get("isReplayAd")||(this.vpaidWrapper=void 0,this.setToModel("activeAdData",void 0)),this.setOrTrigger("adQState",this.adQState),this.setOrTrigger("adState",this.adQState),this.getAdState=ct.getAdState.stopped,En.sendingEventToTaboolaBridge("complete",this.adId),this.onCompView100(),this._stopRV1Observer()}}},{key:"_onAdClickThru",value:function(){this._clearOnAdImpressionTimer(),this.setToModel("clickThruState",ct.clickThruState.clicked),this.oppsService.onAdClicked(),1==++this.adClickCounter&&En.sendingEventToTaboolaBridge("adClick",this.adId),this.reportToVpaid("adClickCounter",{number:this.adClickCounter},!1)}},{key:"_onTitleContainerClick",value:function(){if(this._hasVpaidWrapper()){this.oppsService&&!this.nativeAdCTAButtonClicked&&(this.nativeAdCTAButtonClicked=!0,this.oppsService.onNativeAdCallToActionButtonClick()),this.vpaidWrapper.triggerClick&&this.vpaidWrapper.triggerClick();var t=this.getFromModel("nativeAdClick");this.oppsService.fireTitleContaineClick(t),this._onAdClickThru()}}},{key:"_onLearnMoreClick",value:function(){this._hasVpaidWrapper()&&this._onAdClickThru()}},{key:"_bringToFront",value:function(){if(this.vpaidWrapper.localTarget){var t=this.model.get("style.videoBackgroundColor");(0,_.default)(this.vpaidWrapper.localTarget).css({zIndex:1e3,display:"block",backgroundColor:t})}}},{key:"_bringToBack",value:function(){this.vpaidWrapper.localTarget&&(0,_.default)(this.vpaidWrapper.localTarget).css({zIndex:0})}},{key:"_hasVpaidWrapper",value:function(){return this._hasPlayer()&&this.vpaidWrapper}},{key:"_hasPlayer",value:function(){return this.player&&!this.player.playerIsClosed}},{key:"setActiveTag",value:function(){this.log.info("setActiveTag",this.adId);var t=En.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]);this.model.get("activeTag")!==t&&this.setToModel("activeTag",t)}},{key:"getAdData",value:function(){var t;if(this.vpaidWrapper){var e=void 0;this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.data&&(e=this.vpaidWrapper.vpaidLog.data._id);var i={adId:this.adId,itemType:null===(t=this.vpaidWrapper)||void 0===t||null===(t=t.tag)||void 0===t?void 0:t.t,predictPoint:this.predictPoint,requiredViewability:this.vpaidWrapper.tag?En.parseBool(this.vpaidWrapper.tag.requiredViewability):void 0,getAdKey:"any"===this.getAdKey?10:this.getAdKey,sequenceId:this.sequenceId,dp:this.vpaidWrapper.tag?this.vpaidWrapper.tag.dp:void 0,rpox:this.rpox,hip:this.vpaidWrapper.tag?this.vpaidWrapper.tag.hip:void 0,allowSlider:this.vpaidWrapper.tag?this.vpaidWrapper.tag.alwsldr:void 0,isCompleted:this.isCompleted,tagData:En.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]),vpaidId:e,singleAd:this.vpaidWrapper.tag?this.vpaidWrapper.tag.singleAd:void 0,adjacencyAd:this.vpaidWrapper.tag?this.vpaidWrapper.tag.adjacencyAd:void 0,mediatype:this.vpaidWrapper.tag&&this.vpaidWrapper.tag.vpaidWrapperData?this.vpaidWrapper.tag.vpaidWrapperData.mediatype:void 0};return this._setSubUnitData(i),i}}},{key:"isPWOV",value:function(){return!(!this.vpaidWrapper||!this.vpaidWrapper.pwov)&&this.model.get("isPWOV")&&En.isFactor(100/this.vpaidWrapper.pwov)}},{key:"pause",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.PAUSE_REASONS.UNKNOWN;if((this.model.get("isInTab")&&"continueAd"===this.model.get("onOutOfView")||this.isPWOV())&&this.isViewabilityFired&&!this.model.get("blockedByExternalUnit"))return this.log.info("onOutOfView continueAd",this.adId),this.setToModel("adState",ct.adState.continueAd),this.adState=ct.adState.continueAd,this.oppsService.fireContinueAd(),void(this.isLostView100=!0);this._hasVpaidWrapper()&&(this.log.info("Pause ad",this.adId),this.vpaidWrapper.pauseAd(),this._setBottomOfVViewPort(),this.oppsService.onFirstPauseAfterPlay(),this._logEventUsingElasticLogger("ad pause",yn,{pauseReason:e}),this.reportToVpaid("pauseAdCalled",{reason:"outOfView",tab:this.model.get("isInTab")},!1)),this.setToModel("adState",ct.adState.paused),this.adState=ct.adState.paused}},{key:"skipAd",value:function(){this.log.info("Skip ad",this.adId),this.setToModel("isReplayAd",!1),this._hasVpaidWrapper()&&this.vpaidWrapper.skipAd(),this.setToModel("adState",ct.adState.skipped),this._clearOnAdImpressionTimer()}},{key:"play",value:function(){this._clearOnAdImpressionTimer(),this.model.set("lastActiveAd",this.adId),this.log.info("playing ad",this.adId);var t=this.getAdData();this._overridePreviousSingleAdConfiguration(t),this.setToModel("activeAdData",t),this._isADXad(t)&&(this.model.set("playedADX",!0),this.isAdxAd=!0),this._hasVpaidWrapper()&&(this._updateAdChoiceVisibility(),this._keepReplayableAdAlive(),this.model.get("isToggleIframeContent")&&this.vpaidWrapper.toggleIframeContentDisplay&&this.vpaidWrapper.toggleIframeContentDisplay("show")),this.hadPlay||(this.hadPlay=!0,this.log.info("Winning ad: "+this.getAdKey,this.adId),this.model.get("isMultiActiveAds")||(this._bringToFront(this.vpaidWrapper),(0,_.default)(this.vpaidWrapper.adTarget).removeClass("_cm-ad")),this.setActiveTag(),this._checkIfStartRV1Observer(),this.adQState=ct.adQState.q0,this.setToModel("adQState",ct.adQState.q0),this.setToModel("adDuration",this.vpaidData.duration),this.oppsService.onConversion(),this.adConversionFired(),this.setAdParametersToModel()),this._hasVpaidWrapper()?(this.log.info("resumeAd VpaidWrapper is alive ",this.adId),this._bringToFront(this.vpaidWrapper),this.vpaidWrapper.resumeAd(),this.model.set("hadPlayedAd",!0),this.allowReportMitigationOnlyOnce&&this.inSCMitigationFlow&&this._reportInSCMitigationFlow(),this.allowReportCardOnlyOnce&&this.model.get("SCMitigationFlow")&&this.model.get("cardNumForRV0")&&this._reportFeedCardIndexOpp(this.model.get("cardNumForRV0")),this.reportToVpaid("resumeAdCalled",{tab:this.model.get("isInTab")},!1),this._logEventUsingElasticLogger("ad play")):this.log.warning("resumeAd failed VpaidWrapper is NOT alive ",this.adId),setTimeout(this._firePlayEvents.bind(this),0),this.start||(this.start=!0,En.sendingEventToTaboolaBridge("start",this.adId));var e=this.getCurrModel();this.isLostView100||(this.isLostView100=!e.get("isViewable100"),this.isViewabilityListenerSet||this.isLostView100||(e.on("change:isViewable100",this.onViewabile100Change.bind(this)),this.isViewabilityListenerSet=!0))}},{key:"_overridePreviousSingleAdConfiguration",value:function(t){t&&!t.singleAd&&(this.model.set("isReplayAd",!1),this.model.set("isKeepViewOnMidroll",!1))}},{key:"_isADXad",value:function(e){return e.itemType===t.ITEM_TYPE.IMA}},{key:"_firePlayEvents",value:function(){this.adState=ct.adState.playing,this.setToModel("adState",ct.adState.playing),w().trigger("global:adState:playing")}},{key:"cancelGetAd",value:function(t){this.getAdResult&&(this.log.info("GetAd was cancelled",this.adId),this.getAdResult.cancel(t),this.getAdResult=void 0)}},{key:"setToModel",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.model.set(t,e,i),this.subModel&&this.subModel.set(t,e,i)}},{key:"getFromModel",value:function(t){return this.subModel?this.subModel.get(t):this.model.get(t)}},{key:"setSubModel",value:function(t){this.subModel=t,this.oppsService&&this.oppsService.setSubModel(this.subModel)}},{key:"getCurrModel",value:function(){return this.subModel?this.subModel:this.model}},{key:"forceTrigger",value:function(t){this.model.trigger("change:"+t,this.model,this.model.get(t)),this.subModel&&this.subModel.trigger("change:"+t,this.subModel,this.subModel.get(t))}},{key:"setOrTrigger",value:function(t,e){this.model.get(t)===e?this.forceTrigger(t):this.setToModel(t,e)}},{key:"resize",value:function(t){t&&t.width&&t.height?this.sizeObj.width===t.width&&this.sizeObj.height===t.height||(this.sizeObj.width=t.width,this.sizeObj.height=t.height,this.log.info("resizing ad",_.default.extend({},t,{adId:this.adId,aspectRatio:this.aspectRatioString})),this.vpaidWrapper&&this.vpaidWrapper.resizeAd(t.width,t.height,this.aspectRatioString)):this.log.warning("resize was called with empty sizeObj!",t)}},{key:"recheckSize",value:function(){var t=this.sizeObj;this.sizeObj={},this.resize(t)}},{key:"mute",value:function(){this.vpaidWrapper&&(this.log.info("Mute Player"),this.vpaidWrapper.mute(),En.sendingEventToTaboolaBridge("volumeChange",0))}},{key:"unmute",value:function(){this.vpaidWrapper&&(this.log.info("UnMute Player"),this.vpaidWrapper.unmute(),this.oppsService.fireAdUnmuted(),En.sendingEventToTaboolaBridge("volumeChange",100))}},{key:"fireSkipVimp1EligibilityLost",value:function(t){this._clearOnAdImpressionTimer(),this.oppsService.fireSkipVimp1EligibilityLost(t)}},{key:"fireSkipVimp1AdIsPlaying",value:function(t){this._clearOnAdImpressionTimer(),this.oppsService.fireSkipVimp1AdIsPlaying(t)}},{key:"onAdPlayingRV1StackWithRV0",value:function(){this._clearOnAdImpressionTimer(),this.oppsService.onAdPlayingRV1StackWithRV0()}},{key:"onViewability",value:function(){this.isViewed||(this.isViewed=!0,this.adViewabilityFired(),this.oppsService.onViewability(),this._logEventUsingElasticLogger("ad viewability"))}},{key:"onViewabilityOneS",value:function(){this.isViewedOneS||(this.isViewedOneS=!0,this.oppsService.onViewabilityOneS())}},{key:"onViewability100",value:function(){this.isViewed100||(this.setToModel("viewability100",!0),this.isViewed100=!0,this.oppsService.onViewability100())}},{key:"onCompView100",value:function(){this.isLostView100||this.isCompViewed100||(this.isCompViewed100=!0,this.oppsService.onCompView100())}},{key:"onDetached",value:function(){this.isDetached||(this.isDetached=!0,this.oppsService.onAdDetached())}},{key:"onAttached",value:function(){this.isDetached&&(this.isDetached=!1,this.oppsService.onAdAttached())}},{key:"onSliderClose",value:function(){this.isSliderClosed||(this.isSliderClosed=!0,this._clearOnAdImpressionTimer())}},{key:"reportToVpaid",value:function(t,e,i){this._setSubUnitData(e),this._hasVpaidWrapper()&&this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.push&&(this.vpaidWrapper.vpaidLog.push("unit_".concat(t),e,!1),this.vpaidWrapper.vpaidLog.data&&this.vpaidWrapper.vpaidLog.data.unit_history&&this.vpaidWrapper.vpaidLog.data.unit_history.push&&this.vpaidWrapper.vpaidLog.data.unit_history.push(t),this.vpaidWrapper.vpaidLog.data&&this.vpaidWrapper.vpaidLog.data.statuses&&this.vpaidWrapper.vpaidLog.data.statuses.push&&this.vpaidWrapper.vpaidLog.data.statuses.push(t),i&&this.vpaidWrapper.vpaidLog.push("unit_state",{status:t},i))}},{key:"reportRpoxSkip",value:function(t){this.reportToVpaid("skipRpox",{otherRpox:t.rpox,otherRequiredViewability:t.requiredViewability,otherAdDp:t.dp,otherSequenceId:t.sequenceId},!1)}},{key:"reportPpKeySkip",value:function(t){this.reportToVpaid("skipPpKey",{otherRpox:t.rpox,otherRequiredViewability:t.requiredViewability,otherAdDp:t.dp,otherSequenceId:t.sequenceId},!1)}},{key:"_setAdPlayingWithAdChoice",value:function(t){this.setToModel("adPlayingWithAdChoice",t)}},{key:"_updateAdChoiceVisibility",value:function(){this.vpaidWrapper.hasAdChoices?this._setAdPlayingWithAdChoice(!0):this._setAdPlayingWithAdChoice(!1)}},{key:"_reportInSCMitigationFlow",value:function(){this.allowReportMitigationOnlyOnce=!1,this.oppsService.adInSCMitigationFlow()}},{key:"_reportFeedCardIndexOpp",value:function(t){this.allowReportCardOnlyOnce=!1;var e=this.subModel&&this.subModel.get("cardNumber")||this.model.get("cardNumber");e<t?this.oppsService.adRenderedOnFeedIndexLessThanSCMitigationCard():e==t?this.oppsService.adRenderedOnFeedIndexEqualsSCMitigationCard():e>t&&this.oppsService.adRenderedOnFeedIndexLargerThanSCMitigationCard()}},{key:"_setSubUnitData",value:function(e){var i=this.model.get("subUnitType");if(this.model&&(i||0===i)&&(this._checkIfPlainSubUnit(i,e)?e.su=t.SUB_UNIT_TYPE.PLAIN:e.su=i),this.subModel){var n=this.model.get("detachToSlider"),r=this.subModel.get("gotFirstEligibility");n&&n.isStartFromSlider&&n.isDetachToSlider?e.sp=r?this.subModel.get("cardNumber"):0:n&&n.isStartFromSlider&&!this.subModel.get("isEligibleToPlay")?e.sp=0:this.model.get("cardNumber")&&(e.sp=this.model.get("cardNumber"))}else this.model.get("MSNCard.row")&&(e.sp=this.model.get("MSNCard.row"))}},{key:"_isStickyDisabled",value:function(e){return e!==t.SUB_UNIT_TYPE.STICKY_BELOW||!this.model.get("enableStickyOnNonAllowSlider")}},{key:"_checkIfPlainSubUnit",value:function(e,i){return i.adjacencyAd&&e===t.SUB_UNIT_TYPE.STICKY_BELOW||!i.allowSlider&&this.model.get("isSliderCutOff")&&this._isStickyDisabled(e)}},{key:"_logEventUsingElasticLogger",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mn,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.elasticLogger&&e){var r=n;if(r.isEligible=this.model.get("isEligibleToPlay")||!1,r.adId=this.adId,this.vpaidWrapper){var o=this.getAdData(),s=this.vpaidWrapper.getVpaidData();r.requiredViewability=o.requiredViewability,r.predictPoint=o.getAdKey,r.isHipAd=o.hip||!1,r.isAdjacencyAd=o.adjacencyAd,r.isSingleAd=o.singleAd,r.allowSlider=1===o.allowSlider,r.lineItemId=s.lineItem||-1,r.campaignId=s.campaignId||-1,r.advertiserId=parseInt(s.advId)||-1,r.mediatype=t.MEDIA_TYPE_ID_TO_NAME[o.mediatype]}this.elasticLogger.log({message:e,severity:i,extraData:r})}}},{key:"_setAdRV",value:function(){this.adData.requiredViewability?this.setToModel("gotRvAd",!0):this.setToModel("gotNonRvAd",!0)}},{key:"_getTimeOut",value:function(){return this.model.get("vForce.secondsToGetAdFail.".concat(this.getAdKey))}},{key:"_setAdTypeConfig",value:function(){if(this.vpaidWrapper&&this.vpaidWrapper.getVpaidData){var t=this.vpaidWrapper.getVpaidData();for(var e in this.adTypeTranslator=new en.default({model:this.subModel||this.model}),this.adTypeConfig={},t)if(t[e]){var i=this.adTypeTranslator.getConfigForKey(e);if(En.isEmpty(i))continue;if(this.log.info("got adTypeConfig for key "+e,i),i.revertAfter){var n=this._createRevertAdType(i,e);this._setAdTypeConfigAfter(i.revertAfter,n)}i.setAdConfigAfter?this._setAdTypeConfigAfter(i.setAdConfigAfter,i):this.setToModel(i),this.adTypeConfig[e]=i}else"singleAd"===e&&this._revertSingleAdConfig();this.aspectRatioNum=this.getAspectRatioNum(t),this.log.info("Ad size received is - width: "+t.adWidth+"; height: "+t.adHeight),this._setAdTypeConfigAfter("setSubModel",{aspectRatioNum:this.aspectRatioNum}),this.supportVideoCurrentTimeEvents=t.supportVideoCurrentTimeEvents}}},{key:"_revertSingleAdConfig",value:function(){var t={setAdConfigAfter:"setSubModel",isPlacementSingleAd:!1,"continueToPlayInNexCard.isActive":!0};this._setAdTypeConfigAfter(t.setAdConfigAfter,t)}},{key:"_setAdTypeConfigAfter",value:function(t,e){var i=this[t];En.isFunction(i)&&(this[t]=function(){i.apply(this,arguments),this.setToModel(e),this.log.info("setting ad type config after ".concat(i.name," function"),e)})}},{key:"_createRevertAdType",value:function(t,e){var i={};for(var n in t)"setAdConfigAfter"!==n&&"revertAfter"!==n&&(i[n]=this.model.get(n));return i}},{key:"onAdSetToUnits",value:function(){}},{key:"_keepReplayableAdAlive",value:function(){var t=this.vpaidWrapper;t.dontDie&&this.model.get("isReplayAd")&&(t.isReplayable||this.model.get("isForceDontDie"))&&(t.dontDie(),this.model.set("dontRenderRepeatButton",!t.isReplayable))}},{key:"setAdParametersToModel",value:function(){if(this.model.get("components.nativeAd.isActive")){var t=this.vpaidWrapper.getVpaidData(),e=t.adNativeSettings||{},i=this.subModel||this.model;t.adNativeSettings&&this.model.set("continueToPlayInNexCard.isActive",!1),this.setNativeAdClickListener(),this.setToModel("adNativeSettings",void 0,{silent:!0}),this.setToModel("adNativeSettings",e,{silent:!0}),i.trigger("change:adNativeSettings",i,i.get("adNativeSettings"))}this.vpaidWrapper.clickThruUrl?(this.log.info("updated click through URL",this.vpaidWrapper.clickThruUrl),this.setToModel("adClickThroughUrl",this.vpaidWrapper.clickThruUrl),this._setLearnMoreClickListener()):this.setToModel("adClickThroughUrl",""),this.setToModel("activeAdRV",this.adData.requiredViewability)}},{key:"_setTagDataToStorage",value:function(){try{this.model.setStorage("activeAdData",this.vpaidWrapper.tag)}catch(t){this.log.error("error setting activeAdData",{error:t,tag:this.vpaidWrapper.tag})}}},{key:"setNativeAdClickListener",value:function(){var t=this.subModel||this.model;t.listenTo(t,"change:nativeAdClick",this._onTitleContainerClick.bind(this))}},{key:"_setLearnMoreClickListener",value:function(){var t=this.subModel||this.model;t.listenTo(t,"change:learnMoreClick",this._onLearnMoreClick.bind(this))}},{key:"_sendPixel",value:function(t){"img"===t.method?(new Image).src=t.pixel:"js"===t.method&&this._sendJSPixel(t.pixel)}},{key:"_sendJSPixel",value:function(t){var e=document.createElement("script");e.src=t,e.type="text/javascript",e.async=!0,document.body.appendChild(e)}},{key:"getAspectRatioNum",value:function(t){return t&&t.supportVerticalVideo?(this.aspectRatioString=t.adWidth.toString()+":"+t.adHeight.toString(),t.adWidth/t.adHeight):this.aspectRatioNum?this.aspectRatioNum:(this.aspectRatioString="16:9",this.model.get("defaultAspectRatioNum"))}},{key:"onAdSwappedOut",value:function(){this.oppsService.adSwappedOut()}},{key:"onAdSwappedIn",value:function(){this.oppsService.adSwappedIn()}},{key:"onResumeAfterSwapOut",value:function(){this.oppsService.adResumeAfterSwapOut()}},{key:"_getMesureElement",value:function(){var t=(0,_.default)(this.subModel?this.subModel.get("parentSelector"):this.model.get("parentSelector"));return this.mesureElement=En.isArray(t)?t[0]:t,this.mesureElement}},{key:"_startOneSecondNoPlayTimer",value:function(){this.mesureElement=this._getMesureElement(),this.mesureElement&&(this.onImpressionPosition=En.offsetFromBottomOfViewPort(this.mesureElement),this.onAdImpressionTimer=setTimeout(this._reportOneSecondNoPlay.bind(this),1e3))}},{key:"_reportOneSecondNoPlay",value:function(){null!==this.onAdImpressionTimer&&(this.hadPlay?this._clearOnAdImpressionTimer():(this.onOneSecondPosition=En.offsetFromBottomOfViewPort(this.mesureElement),this.onImpressionPosition!==this.onOneSecondPosition?this.onImpressionPosition>this.onOneSecondPosition?this.oppsService.onOneSecondNoPlayScrolledDown():this.onImpressionPosition<this.onOneSecondPosition&&this.oppsService.onOneSecondNoPlayScrolledUp():this.oppsService.onOneSecondNoPlaySamePlace()))}},{key:"_clearOnAdImpressionTimer",value:function(){this.onAdImpressionTimer&&(clearTimeout(this.onAdImpressionTimer),this.onAdImpressionTimer=null)}},{key:"onViewabile100Change",value:function(){var t=this.getCurrModel();this.model.get("adState")===ct.adState.paused||t.get("isViewable100")||(this.isLostView100=!0)}},{key:"_onNewCompletion",value:function(){this.onCompView100()}},{key:"handleAdjacencyAd",value:function(){this.model.get("hasScAdjacency")&&(this.getAdProperties=En.extend(this.getAdProperties,{excAdProperties:{adjacencyAd:[!0]}}))}},{key:"onDisplayingFullNAS",value:function(){this.firedDisplayingFullNAS||(this.firedDisplayingFullNAS=!0,this.oppsService.onDisplayingFullNAS())}},{key:"onDisplayingNASTitleOnly",value:function(){this.firedDisplayingNASTitleOnly||(this.firedDisplayingNASTitleOnly=!0,this.oppsService.onDisplayingNASTitleOnly())}},{key:"fireAdOppOnce",value:function(t){this["".concat(t,"Fired")]||(this["".concat(t,"Fired")]=!0,this.oppsService.fireGenericOpp(t))}},{key:"_stopRV1Observer",value:function(){this.AmpViewabilityHelper&&(this.AmpViewabilityHelper.stopObserver(this.targetElement),this.AmpViewabilityHelper=null)}},{key:"_checkIfStartRV1Observer",value:function(){this.model.get("frameType")===t.FRAME_TYPE.amp&&this.model.get("isUseAmpObserver")&&(this.AmpViewabilityHelper=new(rn())({model:this.model,subModel:this.subModel}),this.targetElement=this.vpaidWrapper.adTarget?this.vpaidWrapper.adTarget:this.vpaidWrapper.localTarget,this.targetElement&&(this.log.info("Winning ad vpaidWrapper: ",this.targetElement),this.AmpViewabilityHelper.startObserver(this.targetElement),this.createStateHandlers([{event:"isViewableAMP:false",funcName:"pause"},{event:"isViewableAMP:true",funcName:"play"}])))}},{key:"_setBottomOfVViewPort",value:function(){if(this.model.get("isReportBottomOfVViewPort")){var t=this.vpaidWrapper.adTarget;this.adData.bovpv=!!t&&parseInt(En.offsetFromBottomOfViewPort(t))}}},{key:"_onAdWaitForPubVideoToStop",value:function(){this._clearOnAdImpressionTimer(),this.oppsService?this.oppsService.adWaitForPubVideoToStop():this.createStateHandlers([{event:"adWaitForPubVideoToStop",funcName:" _onAdWaitForPubVideoToStop",isListenOnce:!0}])}},{key:"_outOfTabEvent",value:function(){this._clearOnAdImpressionTimer(),this.oppsService.outOfTab()}},{key:"_backToTabEvent",value:function(){this._clearOnAdImpressionTimer(),this.oppsService.backToTab()}}],n&&Sn(i.prototype,n),o&&Sn(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.O),Cn=On;function kn(t){return kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kn(t)}function In(t){return function(t){if(Array.isArray(t))return Rn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Rn(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Rn(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rn(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Dn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==kn(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==kn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===kn(o)?o:String(o)),n)}var r,o}function Vn(t,e){return Vn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Vn(t,e)}function Nn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=xn(t);if(e){var r=xn(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===kn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function xn(t){return xn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xn(t)}var jn=i(1999),Mn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vn(t,e)}(a,t);var i,n,o,s=Nn(a);function a(t){var e,i=t.model,n=t.onPredictCallback;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,{model:i,onPredictCallback:n})).model=i,e.onPredictCallback=n,e.log=new r.Z({unitType:e.model.get("unitType"),className:"seerService",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.activePredict={},e._handleForcePredict(),e._createPlayerReadyPredict(),e._createRequestedPredictors(),e}return i=a,n=[{key:"_handleForcePredict",value:function(){var t=this.model.get("seer.force");Array.isArray(t)?(this._activatePredictors(t),this._disableAllPredictsExpectGiven.apply(this,In(t))):"string"==typeof t&&(this._activatePredictor(t),this._disableAllPredictsExpectGiven(t))}},{key:"_disableAllPredictsExpectGiven",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var n=this.model.get("predictors");Object.keys(n).filter((function(t){return"isGet1OnlyAfterAdLoaded"!==t&&!e.includes(t)})).forEach(this._disablePredict.bind(this))}},{key:"_disablePredict",value:function(t){this.model.set("predictors.".concat(t,".isActive"),!1),this.model.set("predictors.".concat(t,".isStartWF"),!1)}},{key:"multiAd",value:function(){this.activePredict.multiAd||(this.activePredict.multiAd=[]);var t=this.model.get("predictors.multiAd.predictPoints");this._createMultiPointPredict({predictPoints:t,pointKey:"qState",predictArr:this.activePredict.multiAd,predict:At})}},{key:"emptyQueue",value:function(){this.activePredict.emptyQueue=this._createPredict(qt,this.getAdProperties("emptyQueue"))}},{key:"getAdFail",value:function(){this.activePredict.getAdFailPredict=this._createPredict(vt,this.getAdProperties("getAdFail"))}},{key:"autoKill",value:function(){this.activePredict.autoKillPredict=this._createPredict(b,this.getAdProperties("autoKill"))}},{key:"fullEligibility",value:function(){this.activePredict.fullEligibilityPredict=this._createPredict(te,this.getAdProperties("fullEligibility"))}},{key:"distancePercent",value:function(){this.activePredict.distancePercent||(this.activePredict.distancePercent=[]);var t=this.model.get("predictors.distancePercent.predictPoints");this._createMultiPointPredict({predictPoints:t,pointKey:"requirePercentageToSelector",predictArr:this.activePredict.distancePercent,predict:G})}},{key:"distancePixels",value:function(){this.activePredict.distancePixels||(this.activePredict.distancePixels=[]);var t=this.model.get("predictors.distancePixels.predictPoints");this._createMultiPointPredict({predictPoints:t,pointKey:"pixelsFromSelectors",predictArr:this.activePredict.distancePixels,predict:lt})}},{key:"adx",value:function(){this.activePredict.adxPredictor=this._createPredict(Bi,this.getAdProperties("adx"))}},{key:"firstScroll",value:function(){this.activePredict.firstScrollPredict=this._createPredict(Bt,this.getAdProperties("firstScroll"))}},{key:"time",value:function(){this.activePredict.time||(this.activePredict.time=[]);var t=this.model.get("predictors.time.predictPoints");"number"==typeof t||Array.isArray(t)?this._createPredict(Te,{}):this._createMultiPointPredict({predictPoints:t,predictArr:this.activePredict.time,predict:Te})}},{key:"intersection",value:function(){this.activePredict.intersectionPredict||(this.activePredict.intersectionPredict=[]);var t=this.model.get("predictors.intersection.predictPoints");this._createMultiPointPredict({predictPoints:t,pointKey:"intersectionPercent",predictArr:this.activePredict.intersectionPredict,predict:me})}},{key:"mp4",value:function(){this.activePredict.mp4Predict=this._createPredict(Ie,this.getAdProperties("mp4"))}},{key:"msnFullEligibility",value:function(){this.activePredict.msnFullEligibilityPredict=this._createPredict(ei,{})}},{key:"feedInViewPredict",value:function(){this.activePredict.feedInViewPredict=this._createPredict(mi,this.getAdProperties("feedInViewPredict"))}},{key:"recoReel",value:function(){this.activePredict.recoReelPredict||(this.activePredict.recoReelPredict=[]);var t=this.model.get("predictors.recoReel.predictPoints");this._createMultiPointPredict({predictPoints:t,pointKey:"percentage",predictArr:this.activePredict.recoReelPredict,predict:Ti})}},{key:"postRepeat",value:function(){this.activePredict.postRepeat=this._createPredict(Ii,{})}},{key:"_createPlayerReadyPredict",value:function(){this.log.debug("Creating player ready predict"),this.model.get("predictors.playerReady")&&this.model.get("predictors.playerReady.isActive")&&(this.activePredict.playerPredict=this._createPredict(Dt,this.getAdProperties("playerReady"))),this.log.debug("playerReadyPredict created")}},{key:"onPredict",value:function(t,i,n){this.model.get("stopPredicts")&&e().PREDICT_NAMES[i]!==e().PREDICT_NAMES.postRepeatPredictor||(this.model.set("nextPredictName",i),this.model.set("nextPredict",t),this.onPredictCallback(i?e().PREDICT_NAMES[i]:-1,n))}},{key:"startWF",value:function(){this.model.set("startWF",!0)}},{key:"_createRequestedPredictors",value:function(){var t=this;if(this.model.get("playerState")===ct.readyState){var e=this.model.get("predictors");Object.keys(e).forEach((function(i){var n=e[i];n&&t[i]&&(n.isActive||n.isStartWF)&&!t.activePredict[i]&&(t.log.info("Predict activePredict",i),jn.defer(t[i].bind(t)))}))}else this.model.listenToOnce(this.model,"change:playerState",this._createRequestedPredictors.bind(this))}},{key:"_activatePredictors",value:function(t){var e=this;t.forEach((function(t){e._activatePredictor(t)}))}},{key:"_activatePredictor",value:function(t){this.model.set("predictors.".concat(t,".isActive"),!0)}},{key:"_createMultiPointPredict",value:function(t){var e=this,i=t.predictPoints,n=t.pointKey,r=t.predictArr,o=t.predict;jn.each(i,(function(t,i){r.push(e._createPredict(o,{predictPoint:t[n],predictKey:void 0!==t.key?t.key:i,adProperties:{adProperties:t.adProperties,excAdProperties:t.excAdProperties}}))}))}},{key:"_createPredict",value:function(t,e){return jn.extend(e,{model:this.model,onPredict:this.onPredict,startWfFunc:this.startWF,onPredictCallback:this.onPredictCallback}),new t(e)}},{key:"getAdProperties",value:function(t){return{adProperties:{adProperties:this.model.get("predictors.".concat(t,".adProperties")),excAdProperties:this.model.get("predictors.".concat(t,".excAdProperties"))}}}}],n&&Dn(i.prototype,n),o&&Dn(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.O),Ln=Mn;function Bn(t){return Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bn(t)}function Fn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Bn(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Bn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Bn(o)?o:String(o)),n)}var r,o}var Un=function(){function t(e,i,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.model=e,this.log=new r.Z({unitType:this.model.get("unitType"),className:"timerService",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.doneFunction=n||function(){},this.time=o||0,this.conditions=i||{startCondition:{stateToListen:"",state:""},pauseCondition:{stateToListen:"",state:""},continueCondition:{stateToListen:"",state:""},stopCondition:{stateToListen:"",state:""},isStartOnce:!1},this._startListeningToConditions(),this.timerState=ct.readyState}var e,i,n;return e=t,(i=[{key:"_startListeningToConditions",value:function(){this.conditions.startCondition&&(this.conditions.isStartOnce?this.model.listenToOnce(this.model,"change:"+this.conditions.startCondition.state,this.start.bind(this)):this.model.listenTo(this.model,"change:"+this.conditions.startCondition.state,this.start.bind(this))),this.conditions.pauseCondition&&this.model.listenTo(this.model,"change:"+this.conditions.pauseCondition.state,this.pause.bind(this)),this.conditions.continueCondition&&this.model.listenTo(this.model,"change:"+this.conditions.continueCondition.state,this.continue.bind(this)),this.conditions.stopCondition&&this.model.listenTo(this.model,"change:"+this.conditions.stopCondition.state,this.stop.bind(this))}},{key:"start",value:function(t,e){this.conditions.startCondition.stateToListen!==e&&"any"!==this.conditions.startCondition.stateToListen||(this.timerState=ct.timerState.working,this.stTime=(new Date).valueOf(),this.timeout=setTimeout(this.done.bind(this),this.time),this.timeLeft=this.time)}},{key:"pause",value:function(t,e){if(this.timerState===ct.timerState.working&&(!e||this.conditions.pauseCondition.stateToListen===e)){this.timerState=ct.timerState.paused,this._clearTimer();var i=(new Date).valueOf()-this.stTime;this.timeLeft-=i}}},{key:"continue",value:function(t,e){this.timerState===ct.timerState.paused&&(!e||e&&this.conditions.continueCondition.stateToListen===e)&&(this.timerState=ct.timerState.working,this.timeout=setTimeout(this.done.bind(this),this.timeLeft),this.stTime=(new Date).valueOf())}},{key:"stop",value:function(t,e,i,n){this.timeout&&(n||this.conditions.stopCondition.stateToListen===e)&&(this.timerState=ct.timerState.stopped,this._clearTimer())}},{key:"done",value:function(){this.timerState=ct.timerState.done,this.doneFunction(),this.timeout=void 0}},{key:"getTimerState",value:function(){return this.timerState}},{key:"_clearTimer",value:function(){clearTimeout(this.timeout),this.timeout=void 0}},{key:"isTimerActive",value:function(){return this.timerState===ct.timerState.working||this.timerState===ct.timerState.paused}}])&&Fn(e.prototype,i),n&&Fn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Wn=Un;function Hn(t){return Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hn(t)}function $n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Hn(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Hn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Hn(o)?o:String(o)),n)}var r,o}function zn(t,e){return zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zn(t,e)}function qn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Gn(t);if(e){var r=Gn(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Hn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Gn(t){return Gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gn(t)}var Yn=i(1999),Kn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zn(t,e)}(s,t);var e,i,n,o=qn(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).model=t,e.log=new r.Z({unitType:e.model.get("unitType"),className:"pixelsService",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.hadEligibility=!1,e.hadImpression=!1,e.playerHadRvInQ=!1,e.shouldFirePauseAfterPlay=!1,e.adsList={},e._bindEvents(),e.model.set("hadEligibility",!1),e}return e=s,i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adQState:impression",funcName:"_onAdImpression"},{event:"adState:playing",funcName:"_onAdPlaying"},{event:"adState:completed",funcName:"_onAdCompleted"},{event:"loadingViewState:clicked",funcName:"_onRepeatClicked"},{event:"isEligibleToPlay",funcName:"_onEligibilityChange"},{event:"closeTimer",funcName:"_fireTimerPixel"},{event:"isTerminateOnResize:true",funcName:"_onTerminateOnResize"},{event:"noAdjacInFirstWFs:true",funcName:"_onNonAdjacInFirstWFs"},{event:"readMoreClicked:true",funcName:"_onReadMoreClick",isListenOnce:!0},{event:"TRCDispatchFailed:true",funcName:"_onTRCDispatchFailed",isListenOnce:!0},{event:"onMaxNonRvVimpsInQueue",funcName:"_reportOnMaxNonRvVimpsInQueue",isListenOnce:!0}]),w().once("global:passback",this._onPassbackFunctionCalled.bind(this))}},{key:"_onAdImpression",value:function(){this._firePixel(this.model.getPixel("pixels.addImpresion"),"addImpresion (the player got an ad)")}},{key:"_onAdPlaying",value:function(){var t=this.model.get("activeAdData");!t||!t.adId||this.adsList[t.adId]&&this.adsList[t.adId].hadPlay||(this.adsList[t.adId]=t,this.adsList[t.adId].hadPlay=!0,this._firePixel(this.model.getPixel("pixels.conversion"),"conversion (the ad is playing)"))}},{key:"_onAdCompleted",value:function(){this.isViewed=!1,this.activeTag=void 0}},{key:"_onEligibilityChange",value:function(t,e,i){this.stopSendingEligibility||(e&&!this.hadEligibility?this._onEligibility():!e&&this.hadEligibility&&i&&!i.isValidation&&(this._firePixel(this.model.getPixel("pixels.lostEligibility"),"Lost first eligible"),this.model.set("lostEligibilityTime",(new Date).getTime()),this.stopSendingEligibility=!0))}},{key:"_onEligibility",value:function(){this.model.set("hadEligibility",!0),this.hadEligibility=!0,this._firePixel(this.model.getPixel("pixels.eligible"),"First eligible")}},{key:"_onRepeatClicked",value:function(){this._firePixel(this.model.getPixel("pixels.repeatClick"),"repeat click Pixel")}},{key:"_firePixel",value:function(t,e,i){if(t&&this.model.get("isFirePixel")){t=this._setAdditionalData(t,i),this.log.pixel("firing pixel: "+e+" url: "+t);var n=document.createElement("IMG");return n.src=t,n}}},{key:"_setAdditionalData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.get("modifiedPlacement")&&(e.mp=this.model.get("modifiedPlacement")),this.model.get("subUnitType")&&(e.su=this.model.get("subUnitType")),this._addParametersToUrl(t,e,-1===t.indexOf("?"))}},{key:"_addParametersToUrl",value:function(t,e,i){var n=t;return n+=i?"?":"&",_.default.each(e,(function(t,e){void 0!==e&&""!==e&&(n+=t+"="+e+"&")})),n}},{key:"_fireTimerPixel",value:function(t,e){this.model.get("pixels.".concat(e,"Timer.isFire"))&&this._firePixel(this.model.getPixel("pixels.".concat(e,"Timer")),"".concat(e," timer"))}},{key:"_onTerminateOnResize",value:function(){this._firePixel(this.model.getPixel("pixels.terminateOnResize"),"closeDueResize")}},{key:"_onPassbackFunctionCalled",value:function(){(Yn.isFunction(this.model.get("onPassback"))||this.model.get("isApiPassbackExist"))&&this._firePixel(this.model.getPixel("pixels.passbackFunctionCalled"),"passback function called")}},{key:"_onNonAdjacInFirstWFs",value:function(){this._firePixel(this.model.getPixel("pixels.noAdjacInFirstWFs"),"noAdjacInFirstWFs")}},{key:"_onTRCDispatchFailed",value:function(){this._firePixel(this.model.getPixel("pixels.TRCDispatchFailed"),"TRCDispatchFailed")}},{key:"_reportOnMaxNonRvVimpsInQueue",value:function(){this._firePixel(this.model.getPixel("pixels.onMaxNonRvVimpsInQueue"),"onMaxNonRvVimpsInQueue")}}],i&&$n(e.prototype,i),n&&$n(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(n.O),Qn=Kn,Zn=i(701),Xn=i.n(Zn);function Jn(t){return Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jn(t)}function tr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Jn(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Jn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Jn(o)?o:String(o)),n)}var r,o}var er=i(1999),ir=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.adsList=[],this.listeners=[],this.registerIndex=0,this.model=e}var i,n,r;return i=t,(n=[{key:"updateAdsList",value:function(t){t&&!er.isEmpty(t)?(this.adsList=t.items,this._notifyListeners(t)):(this.model.set("generalErrorData",1),this.model.increaseCounter("generalError"))}},{key:"_notifyListeners",value:function(t){var e=this;this.isPlayerHasRvInQ(t),this.isPlayerHasAdxInQ(t);var i=[];this.listeners.forEach((function(t){var n=e._findAdsByStatusAndType(t.type,t.typeValue,t.status,t.cb);t.isListenOnce&&n&&i.push(t.index)})),i.forEach((function(t){return e.unregisterToPlayerQueueStatusChange(t)}))}},{key:"_findAdsByStatusAndType",value:function(t,i,n,r){var o=this,s=!1,a=[];return this.adsList.forEach((function(r){(!t||o[t]&&o[t](r,i))&&(!n||e().AD_STATUS[n]&&r.vw&&r.vw.st===e().AD_STATUS[n])&&(a.push(r),s=!0)})),s&&er.isFunction(r)&&r(a),s}},{key:"singleAd",value:function(t,e){return!!(e&&t.sa||!e&&!t.sa)}},{key:"adjacency",value:function(t,e){return!!(e&&t.adjc||!e&&!t.adjc)}},{key:"hip",value:function(t,e){return!!(e&&t.hip||!e&&!t.hip)}},{key:"registerIsPlayerHasRvInQ",value:function(t){this.isPlayerHasRvInQCb=t}},{key:"registerIsPlayerHasAdxInQ",value:function(t){this.isPlayerHasAdxInQCb=t}},{key:"isPlayerHasRvInQ",value:function(t){this.isPlayerHasRvInQCb&&t.requiredViewabilityCount&&this.isPlayerHasRvInQCb()}},{key:"isPlayerHasAdxInQ",value:function(t){this.isPlayerHasAdxInQCb&&this.isPlayerHasAdxInQCb(t.adxCount>0)}},{key:"registerToPlayerQueueStatusChange",value:function(t){var i=t.type,n=t.typeValue,r=t.status,o=void 0===r?e().AD_STATUS.new:r,s=t.cb,a=t.isListenOnce,l={type:i,typeValue:n,status:o,cb:s,isListenOnce:void 0!==a&&a,index:this.registerIndex};return this.registerIndex=this.registerIndex+1,this.listeners.push(l),l.index}},{key:"unregisterToPlayerQueueStatusChange",value:function(t){this.listeners=this.listeners.filter((function(e){return e.index!==t}))}}])&&tr(i.prototype,n),r&&tr(i,r),Object.defineProperty(i,"prototype",{writable:!1}),t}(),nr=function(){var t;return function(e){return t||(t=new ir(e)),t}}(),rr=nr;function or(t){return or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},or(t)}function sr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==or(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==or(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===or(o)?o:String(o)),n)}var r,o}function ar(t,e){return ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ar(t,e)}function lr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=cr(t);if(e){var r=cr(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===or(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function cr(t){return cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cr(t)}var ur=i(1999),dr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ar(t,e)}(a,t);var i,n,o,s=lr(a);function a(t){var e,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(i=s.call(this,t)).model=t,i.log=new r.Z({unitType:i.model.get("unitType"),className:"playerService",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.oppsula=null===(e=zi().oppsula)||void 0===e?void 0:e.oppsula,i.isRestarted=!1,i}return i=a,n=[{key:"_init",value:function(){this._bindEvents(),this.model.get("isPlayerLoaded")&&this._onPlayerLoaded()}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"isPlayerLoaded",funcName:"_onPlayerLoaded"},{event:"getAdState:stopped",funcName:"_pausePlayer"},{event:"isInTab",funcName:"_onTabEvent"},{event:"startWF",funcName:"startWf"},{event:"canStartPlayer:true",funcName:"_onPlayerLoaded"},{event:"isReadMoreInViewport",funcName:"_onReadMoreInViewport"},{event:"publisherVideoDetected",funcName:"_onPublisherVideoDetectChange"}])}},{key:"_onPlayerLoaded",value:function(){if(this.model.get("isPlayerLoaded")&&this.model.get("canStartPlayer")&&!this.player&&this._validatePlayerSize()){if(this.isMuted="on"!==this.model.get("volume"),this.volume="off"!==this.model.get("volume")?40:0,this.contentIndex=0,this.playlist=this.model.get("player.playlist"),this.playlist&&ur.isEmpty(this.playlist))return void this.model.listenToOnce(this.model,"change:player.playlist",this._onPlayerLoaded.bind(this));ur.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoPlayerInit",e().TRC_PERFORMANCE_ACTIONS.START);var t=this.playlist[this.contentIndex];this.model.set("isInIdleMode",!this.model.get("isInTab")&&this.model.get("isCallIDLE"));var i=this._getAdTypesToDrop();this.data={abTest:this.model.get("abTest"),ad_controls:this.model.get("player.hasAdControls"),aspect_ratio:this.model.get("aspectRatio"),auc_dast:this.model.get("cmDast"),autostart:this.model.get("autoPlay"),base_url:this.model.get("urls.base"),bf_factor:this.model.get("player.bfFactor"),bug_feature:this.model.get("player.hasBFeature"),cfr:this.model.get("cfr"),cipid:this.model.get("cipid"),cirf:decodeURIComponent(this.model.get("referrer")),creativeId:this.model.get("creativeId"),controls:this.model.get("player.hasControls"),country:this.model.get("country"),debug:this.model.get("isDebug")?["*"]:[],default_ad_parameters:this.model.get("defaultAdParameters"),default_ad_timeout:this.model.get("adMaxPlaySeconds"),default_b2b:this.model.get("player.b2b"),fire99:this.model.get("player.isFire99"),ga_factor:this.model.get("gaFactor"),ga_frame_src:this.model.get("gaFrameSrc"),image:this.model.get("loaderImage"),interrupt_loading:this.model.get("interruptLoading"),ip:this.model.get("ip"),isViewable:this.model.get("isPlayerViewable"),keywords:this.model.get("adTitle"),min_vpaid_run_time:this.model.get("player.minVpaidRunTime"),no_debug_report:this.model.get("noDebugReport"),oid:this.model.get("originId"),opps_base_path:this.model.get("player.urls.oppsBasePath"),non_bllb_opps_base_path:this.model.get("player.urls.nonBllbOppsBasePath"),page_url:decodeURIComponent(this.model.get("referrer")),referrer:decodeURIComponent(this.model.get("referrer")),repeat:this.model.get("repeat"),ron_percent:this.model.get("ronPercent"),schedule_auto:this.model.get("timeBetweenAds"),tags:this.model.get("tags"),time_between_waterfall:this.model.get("secondsBW"),use_flash_bypass:this.model.get("player.isBypassFlash"),use_flash_player:this.model.get("player.isFlashPlayer"),version:this.model.get("adTitle"),vertical:this.model.get("vertical"),wf_base_path:this.model.get("player.urls.wfBasePath"),domain_wf_base_path:this.model.get("player.urls.domainWfBasePath"),wf_url:this.model.get("player.urls.wfRequest"),opps_url:this.model.get("player.urls.oppsRequest"),height:""+parseInt(this.model.get("height")),width:""+parseInt(this.model.get("width")),dplayerSettings:this.model.get("player.settings"),loadrsrc:!0,preset:this.model.get("preset"),isDFP:this.model.get("iframeData.inDFP"),can_opt_out:!1,description:t.title,domain:window.location.hostname,mute:this.isMuted,title:t.title,volume:this.volume,isIdleMode:this.model.get("isInIdleMode"),dlywf:this.model.get("dlywf"),target_id:this.getTarget(),schedule:this.model.getScheduleArr(),dtagid:this.model.get("dtagid"),dpubid:this.model.get("dpubid"),isMobile:this.model.get("isMobile"),queue_size:this.model.get("player.settings.queueSize"),max_ready_vpaid:this.model.get("player.settings.maxReadyVpaid"),adto:this.model.get("player.settings.adto"),vakll:this.model.get("player.settings.vakll"),mintimwf:this.model.get("player.settings.mintimwf"),agressiveLevel:this.model.get("preset.level"),suppressContentZindex:this._getSuppressContentZindex(),vimpFireEvent:this.model.get("vimpFireEvent"),subUnitType:this.model.get("subUnitType"),vForce:this.model.get("vForce.isActive"),get_ad_timeout_seconds:this.model.get("vForce.getAdTimeoutSeconds"),wf_manual:this.model.get("wfManual"),wf_dynmc_ps:this.model.get("wfDynamicPause"),run_wf_when_empty:this.model.get("runWfWhenEmpty"),rndmt:this.model.get("rndmt"),unit_name:this.model.get("unitName"),unit_loader_version:this.model.get("version"),unit_main_version:this.model.get("unitVersion"),mprdct:this.model.get("player.settings.mprdct"),gdprApplies:this.model.get("gdprApplies"),cdb:this.model.get("consentDaisyBit"),oppsQS:this.model.get("oppsQS"),adTypesToDrop:i,red_id:this.model.get("redId"),files:[t],pixelsUrl:this.model.get("pixels.url"),numOfWfUntilDcSwitch:this.model.get("numOfWfUntilDcSwitch"),isReadMoreOnPage:ur.isMidArticleOnReadMorePage(this.model.get("isHip")),isSliderCutOff:this.model.get("isSliderCutOff"),enableStickyOnNonAllowSlider:this.model.get("enableStickyOnNonAllowSlider"),onPlayerClose:this._onPlayerClose.bind(this),onPlayerError:this._onPlayerError.bind(this),onPlayerReady:this._onPlayerReady.bind(this),onPlayerStop:this._onPlayerStop.bind(this),wurfl:{os:{name:this.model.get("wurfl.os.name"),version:this.model.get("wurfl.os.version")},browser:{name:this.model.get("wurfl.browser.name"),version:this.model.get("wurfl.browser.version")}},shouldSendDataToElastic:this.model.get("shouldSendDataToElastic"),elasticSessionId:this.model.get("elasticSessionId"),oppsula:this.oppsula,shouldLoadAdxScript:this.model.get("withAdx")},ur.extend(this.data,this.extraData||{}),ur.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoOvaMediaPlayerInit",e().TRC_PERFORMANCE_ACTIONS.START),this.player=new OvaMediaPlayer(this.data),ur.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoOvaMediaPlayerInit",e().TRC_PERFORMANCE_ACTIONS.STOP),zi().player=this.player,this.player.on("AdClickThru",this._onAdClickThru.bind(this)),this.player.on("emptyFirstWaterfall",this._triggerPassback.bind(this)),ur.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoPlayerInit",e().TRC_PERFORMANCE_ACTIONS.STOP),this._registerListeners(),this._onPublisherVideoDetectChange(this.model,this.model.get("publisherVideoDetected"))}}},{key:"_registerListeners",value:function(){this.player.on&&this.player.on("AdImpression",this._onAdImpression.bind(this))}},{key:"_onAdImpression",value:function(){this.hadImpression||(w().trigger("filledImpression"),this.hadImpression=!0)}},{key:"_validatePlayerSize",value:function(){var t=this.model.get("width"),e=this.model.get("height"),i=!0;return ur.isWidthValid(t)?ur.isHeightValid(e)||(this.model.set("height",ur.getVideoHeight(t)),this.model.set("playerHeightLost",!0)):(i=!1,this.model.set("playerWidthLost",!0)),i}},{key:"_getSuppressContentZindex",value:function(){return this.model.get("suppressContentZindex")&&this.model.get("vForce.isActiv")||!1}},{key:"_onAdClickThru",value:function(){this.model.set("clickThruState",ct.clickThruState.clicked)}},{key:"_onPlayerReady",value:function(){this.playerQueueSeeker=new rr(this.model),this.playerQueueSeeker.registerIsPlayerHasRvInQ(this.isPlayerHasRvInQ.bind(this)),this.playerQueueSeeker.registerIsPlayerHasAdxInQ(this.isPlayerHasAdxInQ.bind(this)),this.playerQueueSeeker.registerToPlayerQueueStatusChange({instance:this,type:void 0,typeValue:void 0,status:"adLoaded",cb:this.isFirstAdLoaded.bind(this),isListenOnce:!0}),this._onTabEvent(this.model,this.model.get("isInTab")),this.model.set("playerVersion",this.player.get("player_version")),this.model.set("playerRepeatCount",this.player.repeatCount),this.model.set("playerState",ct.readyState),this.player.on("AdVolumeChange",this._onVolumeChange.bind(this)),this.player.on("AdPaused",this._onAdPaused.bind(this)),this.player.on("AdPlaying",this._onAdPlaying.bind(this)),this.player.on("UserInteractionPauseState",this._onPausedChanged.bind(this)),this.player.on("queueStatus",this.playerQueueSeeker.updateAdsList.bind(this.playerQueueSeeker)),this.player.on("queueStatus",this._onQueueStatusChange.bind(this)),this.player.on("adxAdStop",this._onAdxAdStop.bind(this)),this.isRestarted?(this.model.set("playerState",ct.playerState.restarted),this.model.get("player.settings.dlywf")&&this.startWf()):this.model.set("playerState",ct.readyState),this.model.get("isContainerRatioNotValidForTakeOver")&&this.dropAds(Xn().adjacency.name)}},{key:"_onAdxAdStop",value:function(t){this.model.set("playerQueue",t.items),this.model.trigger("loadNewAdxAd")}},{key:"_onQueueStatusChange",value:function(t){this.model.set("playerQueue",t.items)}},{key:"_onPausedChanged",value:function(t){this.model.set("generalPlayingUnitState",!t)}},{key:"_onAdPaused",value:function(){this.model.set("generalPlayingUnitState",!1)}},{key:"_onAdPlaying",value:function(){this.model.set("generalPlayingUnitState",!0)}},{key:"_onPlayerClose",value:function(){this._setGeneralPlayingUnitState(!1),this.model.set("playerState",ct.playerState.closed)}},{key:"_setGeneralPlayingUnitState",value:function(t){this.model.set("generalPlayingUnitState",null),this.model.set("generalPlayingUnitState",t)}},{key:"_onPlayerStop",value:function(){this.model.set("playerState",ct.playerState.stopped)}},{key:"_onPlayerError",value:function(){this.model.set("playerState",ct.playerState.error)}},{key:"isPlayerHasRvInQ",value:function(){this.model.set("playerHasRvInQ",!0)}},{key:"isPlayerHasAdxInQ",value:function(t){this.model.set("playerHasAdxInQ",t)}},{key:"isFirstAdLoaded",value:function(){this.model.set("isFirstAdLoaded",!0)}},{key:"close",value:function(){setTimeout(function(){this.player&&(this.player.closeCleanPlayer(),this.player=null,this.model.set("closeState",ct.closeState.playerClosed),this.model.set("playerState",ct.playerState.closed),this.log.info("player was closed"))}.bind(this),0)}},{key:"_pausePlayer",value:function(){this.close()}},{key:"_onLoadingClick",value:function(){this.isRestarted=!0,setTimeout(this._onPlayerLoaded.bind(this),0)}},{key:"_hasPlayer",value:function(){return this.player&&!this.player.playerIsClosed}},{key:"_onVolumeChange",value:function(t){this.isMuted=0===t.adVolume}},{key:"getTarget",value:function(){if(this.model.get("targetId"))return this.model.get("targetId").toString();var t=ur.now().toString(),e=(0,_.default)("<div>");return e.attr("id",t),e.css({width:this.model.get("width")+"px",height:0,position:"absolute",top:0,left:0,display:"none"}),"FEED_MANAGER"!==this.model.get("unitType")&&e.css({}),e.appendTo("body"),this.playerDiv=e,t}},{key:"_onTabEvent",value:function(t,e){this.model.get("isCallIDLE")&&this.player&&this.player.startIdleMode&&this.player.stopIdleMode&&(e?(this.player.stopIdleMode(),this.model.set("isInIdleMode",!1),this.log.info("Stop idle mode")):(this.player.startIdleMode(),this.model.set("isInIdleMode",!0),this.log.info("Start idle mode")))}},{key:"_onPublisherVideoDetectChange",value:function(t,e){var i;null!==(i=this.player)&&void 0!==i&&i.onPublisherVideoDetectChange&&this.player.onPublisherVideoDetectChange(e)}},{key:"startWf",value:function(){this._hasPlayer()&&this.player.startWf&&!this.model.get("isInIdleMode")?(this.log.info("Starting Waterfall"),this.player.startWf()):this.model.get("isInIdleMode")&&this.createStateHandlers([{event:"isInIdleMode:false",funcName:"startWf",isListenOnce:!0}])}},{key:"_getAdTypesToDrop",value:function(){var t=this.model.get("adsToDrop")||[];Array.isArray(t)||(t=[t]);var e=Xn().adjacency.name+"Ad";return this._canGetAdjacCard()||t.push(e),ur.isPlacementWithScAdjacency(this.model)&&(t.includes(e)||t.push(e),t.push(Xn().hip.name+"Ad")),t}},{key:"_triggerPassback",value:function(){var t=this.model.get("isApiPassbackExist");!this.model.get("isFirstAdLoaded")&&t&&(this.log.info("Waterfall returned Empty"),w().trigger("global:passback",{isApiPassbackExist:t}),this.model.set("closeState",ct.closeState.terminate))}}],n&&sr(i.prototype,n),o&&sr(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.O),hr=dr;function fr(t){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fr(t)}function pr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==fr(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==fr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===fr(o)?o:String(o)),n)}var r,o}function mr(){return mr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vr(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}},mr.apply(this,arguments)}function yr(t,e){return yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yr(t,e)}function gr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=vr(t);if(e){var r=vr(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===fr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function vr(t){return vr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vr(t)}var br=i(1999),_r=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yr(t,e)}(o,t);var e,i,n,r=gr(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).targetElem=(0,_.default)("#"+e.model.get("targetId").toString()),e._waterfallRetries=Number(e.model.get("waterfallRetries")),isNaN(e._waterfallRetries)&&(e._waterfallRetries=0),e._init(),e}return e=o,(i=[{key:"_bindEvents",value:function(){mr(vr(o.prototype),"_bindEvents",this).call(this),this.createStateHandlers([{event:"videoPlaceholderSize",funcName:"resize"},{event:"videoViewSize",funcName:"resizeDetach"},{event:"videoViewState:detached",funcName:"_onDetach"},{event:"loadingViewState:clicked",funcName:"_onLoadingClick"},{event:"adState:playing",funcName:"_dropSingleAds",isListenOnce:!0},{event:["dropAds:adjacency","playerState:ready"],funcName:"_dropAdjcAds",isListenOnce:!0},{event:"dropAdjacDueHIP",funcName:"_dropAdjcAds",isListenOnce:!0}])}},{key:"resize",value:function(t,e,i){if(this.model.get("videoViewState")!==ct.videoViewState.detached||i){var n=e||t;if(this.lastSize=this.lastSize||{},this.lastSize.width===n.width&&this.lastSize.height===n.height)return;this.player&&this.player.resize&&n&&n.width&&n.height&&(this.lastSize=br.extend({},n),this.player.resize(n.width,n.height),this.log.info("player was resize",n))}}},{key:"_onDetach",value:function(){var t={width:this.model.get("width"),height:this.model.get("height")};this.resize(t,null,!0)}},{key:"resizeDetach",value:function(t,e){this.resize(t,e,!0)}},{key:"_dropAdjcAds",value:function(){this.dropAds(Xn().adjacency.name)}},{key:"_dropSingleAds",value:function(){this.model.get("predictors.postRepeat.isActive")||this.dropAds(Xn().singleAd.name)}},{key:"dropAds",value:function(t){this.player&&this.player.dropAds&&(this.player.dropAds(Xn()[t].playerType),this.log.info("dropping ".concat(t," ads from player Q")),this.model.appendArray("droppedAdTypes",t))}},{key:"_canGetAdjacCard",value:function(){return!this.model.get("isContainerRatioNotValidForTakeOver")}},{key:"_onAdError",value:function(){this.log.error("onAdError"),this._errorCount++,this._waterfallRetries&&!this._hasImpression&&this._errorCount>=this._waterfallRetries&&(this.log.info("number of errors reached the allowed waterfall retries - stopping the unit",this._waterfallRetries),this.model.set("closeState",ct.closeState.terminate))}}])&&pr(e.prototype,i),n&&pr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(hr),Sr=_r;i(1999);i(1999);i(1999);function wr(t){return wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wr(t)}function Tr(t){return function(t){if(Array.isArray(t))return Pr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Pr(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Pr(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pr(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Ar(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==wr(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==wr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===wr(o)?o:String(o)),n)}var r,o}function Er(t,e){return Er=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Er(t,e)}function Or(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=kr(t);if(e){var r=kr(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===wr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Cr(t)}(this,i)}}function Cr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kr(t){return kr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kr(t)}var Ir=i(1999),Rr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Er(t,e)}(o,t);var e,i,n,r=Or(o);function o(t,e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(i=r.call(this,t)).model=t,i.globalModel=e,i.model.set("isEligibleToPlay",!1),i.model.get("isTestParentSelector")&&i._bindScroll(),i.model.get("isInAppBridgeOn")&&window.taboolaBridge&&i._observeInAppIntersectionChange(),i.oldRect={},i.viewabilityPercent=i.model.get("viewabilityPercent"),i.printCurrentViewPercent=i.model.get("printCurrentViewPercent"),i.isListenToScrollSpeedChange=i.model.get("eligibility.isListenToScrollSpeedChange"),i.isListenToScrollSpeedChange&&(i.scrollManager=new I,i.maxPPS=i.model.get("eligibility.maxPPS"),i.scrollManager.registerForPPSChange(i._testEligibility.bind(Cr(i)))),i}return e=o,(i=[{key:"_bindScroll",value:function(){this._testTopParentSelector(),w().on("window:scroll:change",this._testTopParentSelector.bind(this))}},{key:"_isLowerThenMaxPPS",value:function(){return!this.maxPPS||Math.abs(this.scrollManager.getPps())<this.maxPPS}},{key:"_initObserver",value:function(){var t={rootMargin:"0px",threshold:[0,this.model.get("viewPercent")/100,this.model.get("viewabilityPercent")/100,this.model.get("100viewPercent")/100]};if(this.model.get("stickyCard.isActive")){var e,i=this.model.get("stickyCard.observerThreshold");i&&(e=t.threshold).push.apply(e,Tr(i))}this.observer=new IntersectionObserver(this._observerCallback.bind(this),t),this.log.info("IntersectionObserver was created")}},{key:"bindEvent",value:function(){}},{key:"_getDimensions",value:function(t){var e=(0,_.default)(t);return{width:e.width()||this.model.get("width"),height:e.height()||this.model.get("height")}}},{key:"_calculateEligibility",value:function(){this.model.get("isUseObserver")||(this.inViewDiv=this._getInViewDiv()),this._testEligibility()}},{key:"_onTabEvent",value:function(t){}},{key:"_printCurrentViewPercent",value:function(t,e){this.printCurrentViewPercent&&this.log.info("".concat(t,": "),e||0)}},{key:"_getInViewDiv",value:function(){for(var t=0;t<this.placeHolders.length;t++){var e=this.placeHolders[t],i=this._getDimensions(e),n=Ir.getViewPercent(e,i.width,Ir.getVideoHeight(i.width),this.model.get("scrollSelector"));this._printCurrentViewPercent("currViewPercent",n);var r=this.model.get("viewPercent")||100;if(this.model.set("isViewable",this.viewabilityPercent<=n),this.model.set("isViewable100",n>=this.model.get("100viewPercent")),this.model.get("stickyCard.isActive")){var o=n<this.model.get("stickyCard.attachPercent")&&this._canStickToTop(e);this.model.set("isEligibleToStick",o)}if(r<=n)return this.placeHolders[t]}}},{key:"_observerCallback",value:function(t,e){this.inViewDiv=void 0;for(var i=0;i<t.length;i++){var n=100*t[i].intersectionRatio;if(this.model.set("isViewable100",n>=this.model.get("100viewPercent")),this.model.set("isViewable",this.viewabilityPercent<=n),this.model.get("stickyCard.isActive")){var r=n<this.model.get("stickyCard.attachPercent")&&t[i].boundingClientRect.top<=0;this.model.set("isEligibleToStick",r)}if(n>=this.model.get("viewPercent")){this.inViewDiv=t[i];break}}this._testEligibility()}},{key:"_testEligibility",value:function(){}},{key:"_testTopParentSelector",value:function(){var t=this._getTopParentSelector();this.topParentSelector||(this.topParentSelector=t),this.topParentSelector&&!t&&this.model.get("isCheckTopParentSelectorLost")&&(this.model.set("topParentSelectorLost",!0),this._stopObserver())}},{key:"_getTopParentSelector",value:function(){var t=this.model.get("parentSelector");return t=Ir.isArray(t)?t[0]:t,t=(0,_.default)(t)[0],Ir.getTopOfEl(t)}},{key:"_observeInAppIntersectionChange",value:function(){window.taboolaBridge.on("intersectionChanged",this._onIntersectionChanged.bind(this)),window.taboolaBridge.active=!0}},{key:"_onIntersectionChanged",value:function(t){var e=t.rects.boundingClientRect,i={width:function(){return e.width},height:function(){return Math.abs(e.top-window.taboolaBridge.data.rootBounds.height)},top:function(){var t=0;return e.top<0&&(t-=e.top),t}};this.model.set("scrollSelector",i),this._calculateEligibility()}},{key:"_canStickToTop",value:function(t){return!!t&&t.getBoundingClientRect().top<=0}},{key:"_getFromModel",value:function(t){return(this.globalModel||this.model).get(t)}},{key:"_stopObserver",value:function(){this.observer&&this.observer.disconnect&&this.observer.disconnect()}},{key:"_setToModel",value:function(t,e){this.model.set(t,e),this.globalModel&&this.globalModel.set(t,e)}}])&&Ar(e.prototype,i),n&&Ar(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(n.O),Dr=Rr;function Vr(t){return t.get("isUseHasFocus")?document.hasFocus():!document.hidden}function Nr(t){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nr(t)}function xr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Nr(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Nr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Nr(o)?o:String(o)),n)}var r,o}function jr(t,e){return jr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jr(t,e)}function Mr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Lr(t);if(e){var r=Lr(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Nr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Lr(t){return Lr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Lr(t)}var Br=i(1999),Fr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jr(t,e)}(a,t);var i,n,o,s=Mr(a);function a(t,e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(i=s.call(this,t)).$parentElement=(0,_.default)(e),i.model.set("isInTab",Vr(i.model)),i.log=new r.Z({unitType:"Service",className:i.constructor.name,version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.placeHolders=[],i.model.get("isUseObserver")&&i._initObserver(),i.bindEvent(),i._createPlaceHolders(),i._initEligibilityListener(),i}return i=a,(n=[{key:"bindEvent",value:function(){this.model.listenTo(w(),"window:tab:change",this._onTabEvent.bind(this)),this.createStateHandlers([{event:"containerViewState:rendered",funcName:"_setPlaceHolderToVideoView"},{event:"getAdState:gotAd",funcName:"_testEligibility"},{event:"componentVisibility",funcName:"_calculateEligibility"}])}},{key:"_setPlaceHolderToVideoView",value:function(){this.model.get("isUseObserver")?(this.observer.disconnect(),this._clearTempDivs(),this.observer.observe(this.model.get("containerViewPlaceHolder"))):(this._clearTempDivs(),this.placeHolders=[this.model.get("containerViewPlaceHolder")],this._calculateEligibility())}},{key:"_clearTempDivs",value:function(){if(this.model.get("frameType")!==e().FRAME_TYPE.plainPage&&this.model.get("isDataTrackDivHasDim"))for(var t in this.placeHolders)(0,_.default)(this.placeHolders[t]).hide()}},{key:"_initEligibilityListener",value:function(){this.model.get("isUseObserver")?this._registerObserverListeners():(this._calculateEligibility(),w().on("window:scroll:change",this._calculateEligibility.bind(this)),this.model.listenTo(this.model,"change:aspectRatioNum",this._calculateEligibility.bind(this)))}},{key:"_createPlaceHolders",value:function(){for(var t=this.$parentElement.length>0?this.$parentElement:(0,_.default)(this.model.get("parentSelector").toString()),e=0;e<t.length;e++){var i=t[e];if(!i.querySelector("#_cm-css-reset")){var n=this._createTempDiv(i);i.appendChild(n),this.placeHolders.push(n)}}}},{key:"_createTempDiv",value:function(){var t=document.createElement("div");return t.classList.add("_cm-div"),t.id="_cm-css-reset",this.model.get("isDataTrackDivHasDim")&&this.model.get("frameType")!==e().FRAME_TYPE.plainPage&&(0,_.default)(t).css({height:"1px !important",width:"1px !important",visibility:"hidden !important",position:"absolute !important"}),t.setAttribute("data-tracked","true"),t}},{key:"_onTabEvent",value:function(t){t===e().TAB_STATE.tabOut?(this.model.set("isViewable",!1),this.model.set("isInTab",!1),this.model.get("isIgnoreTabInIframe")&&this.model.get("frameType")!==e().FRAME_TYPE.plainPage||this.model.set("isEligibleToPlay",!1)):(this._calculateEligibility(),this.model.set("isInTab",!0))}},{key:"_registerObserverListeners",value:function(){for(var t=0;t<this.placeHolders.length;t++)this.observer.observe(this.placeHolders[t])}},{key:"_testEligibility",value:function(){if(this.inViewDiv){this._setFirstEligiblePosition(),this.model.set("isEligibleToPlay",!0),this.model.set("isViewable",!this.model.get("isIgnoreTabInIframe")||this.model.get("frameType")===e().FRAME_TYPE.plainPage||this.model.get("isInTab"));var t=this.model.get("getAdState");this.model.get("eligiblePlaceholder")||t!==ct.getAdState.gotAd||this.model.set("eligiblePlaceholder",this.inViewDiv),this.model.get("hadEligibility")||this.model.set("hadEligibility",!0)}else this.model.set("isEligibleToPlay",!1)}},{key:"_getInViewDiv",value:function(){for(var t=0;t<this.placeHolders.length;t++){var e=this.placeHolders[t],i=this._getDimensions(e),n=i.height||Br.getVideoHeightByRatio(i.width,this.model.get("aspectRatioNum")),r=Br.getViewPercent(e,i.width,n,this.model.get("scrollSelector"));this._printCurrentViewPercent("currViewPercent",r);var o=this.model.get("viewPercent")||100;if(this.model.set("isViewable",this.model.get("viewabilityPercent")<=r),this.model.set("isViewable100",r>=this.model.get("100viewPercent")),this.model.set("isEligibleToStick",r<100),o<=r)return this.placeHolders[t]}}},{key:"_setFirstEligiblePosition",value:function(){if(this.model.get("placementOffsetValidation.isActive")&&!this.firstEligibilePosition){this.firstEligibilePosition=!0;var t=this.inViewDiv.target?this.inViewDiv.target:this.inViewDiv,e=Br.getOffsetWithContainer(t,this.model.get("offsetGetterType"),this.model.get("videoContainerSelector"));e&&this.model.set("eligibleContainerOffset",{left:e.left,top:e.top,el:t})}}}])&&xr(i.prototype,n),o&&xr(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(Dr),Ur=Fr;i(1999);i(1999);i(1999);i(1999);i(1999);function Wr(t){return Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wr(t)}function Hr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Wr(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Wr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Wr(o)?o:String(o)),n)}var r,o}var $r=i(1999),zr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.model=e,this._loadOvaMediaPlayer()}var e,i,n;return e=t,(i=[{key:"_loadOvaMediaPlayer",value:function(){var t="".concat(this.model.get("player.urls.playerLocation"),"/OvaMediaPlayer.js");window.OvaMediaPlayer?this._onOvaMediaPlayerLoaded():$r.loadJs(t,this._onOvaMediaPlayerLoaded.bind(this),{crossOrigin:"anonymous"})}},{key:"_onOvaMediaPlayerLoaded",value:function(){this.model.set("isPlayerLoaded",!0)}}])&&Hr(e.prototype,i),n&&Hr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),qr=zr;function Gr(t){return Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gr(t)}function Yr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Gr(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Gr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Gr(o)?o:String(o)),n)}var r,o}function Kr(t,e){return Kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Kr(t,e)}function Qr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Zr(t);if(e){var r=Zr(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Gr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Zr(t){return Zr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zr(t)}var Xr=i(1999),Jr=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kr(t,e)}(a,e);var i,n,o,s=Qr(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t.model)).model=t.model,e.log=new r.Z({unitType:e.model.get("unitType"),className:"PlayPriorityHandler",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.isRvPriority=e.model.get("isRvPriority")&&e._isAllowedInFT(),e.isHadFirstSetAd=!1,e.detachToSlider=e.model.get("detachToSlider"),e.isStickyCardActive=e.model.get("stickyCard.isActive"),e.isDetachActive=e.detachToSlider&&(e.detachToSlider.isStartFromSlider||e.detachToSlider.isDetachToSlider),e.isForceDetachOnGotAd=(e.isDetachActive||e.isStickyCardActive)&&e.model.get("detachToSlider.forceDetach.isActive"),e._bindEvents(),e}return i=a,(n=[{key:"_isAllowedInFT",value:function(){return!!this.model.get("playPriority.isAllowInIframes")||this.model.get("frameType")===t.FRAME_TYPE.plainPage}},{key:"_bindEvents",value:function(){}},{key:"setNextAd",value:function(t){this.lastAd=t,this._isForceAdToDetach(t)?this._setReadyAd(t):this.isRvPriority&&!this.isHadFirstSetAd?this._handleRvPriority(t):this._setReadyAd(t)}},{key:"_isForceAdToDetach",value:function(t){if(!this.isForceDetachOnGotAd||this.model.get("hadStickyDetach"))return!1;var e=this.model.get("detachToSlider.forceDetach.restrictions.rv"),i="any"===e||e===t.adData.requiredViewability;return this.log.info("force ad detach:",{isForced:i,activeAdRV:t.adData.requiredViewability}),i}},{key:"_setReadyAd",value:function(t){t.onAdSetToUnits(),this.lastSetAdId=t.adId;var e=t.adData.requiredViewability,i=!t.adData.alwsldr;this.model.setNextAd(t),setTimeout(function(){this.model.set("isNextAdRV",e),this.model.set("isNextAdNotAllowSlider",i),this.model.set("hasReadyAd",!0)}.bind(this),0)}},{key:"_handleRvPriority",value:function(t){var e=!1;if(t.adData.requiredViewability)e=!0;else{var i=this._isAtDecisionPoint();e=this._shouldSetReadyAd(i)}e&&(this._setReadyAd(t),t._bringToFront(),this.isHadFirstSetAd=!0)}},{key:"_shouldSetReadyAd",value:function(t){return!!t&&(this.model.get("playPriority.isAlwaysWaitForRv")?!this.model.get("playerHasRvInQ"):!this.model.get("playerHasRvInQ")||this.model.get("isSkippedDistancePredict")||this._isLoaderInRequiredPercentage())}},{key:"_isAtDecisionPoint",value:function(){if(!this.model.get("playPriority.checkForRvPriority"))return!1;var e=this.model.get("playPriority.checkForRvPriority");return this[t.CHECK_FOR_RV_PRIORITY[e]].bind(this)()}},{key:"_reCheckAd",value:function(t){this.isHadFirstSetAd||(this.hasListener=!1,this.setNextAd(this.lastAd))}},{key:"hasReachedEligibility",value:function(){return!(!this.model.get("isEligibleToPlay")&&!this.model.get("hadEligibility"))||(this.hasListener?void 0:(this._waitForEligibility(),this.hasListener=!0,!1))}},{key:"_waitForEligibility",value:function(){this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_reCheckAd",isListenOnce:!0}])}},{key:"hasReachedPixelsFromSelector",value:function(){if(void 0===this.model.get("playPriority.pixelsFromSelector"))return!1;var t=Xr.hasPassedPixelFromSelector(this.model.get("parentSelector"),this.model.get("scrollSelector"),this.model.get("playPriority.pixelsFromSelector"),this.model.get("isNeedValidateParentSelector"));return t||this.hasListener||(this.hasListener=!0,w().once("window:scroll:change",this._reCheckAd.bind(this))),t}},{key:"intersectionPercent",value:function(){if(void 0===this.model.get("playPriority.intersectionPercent"))return!1}},{key:"_activeSecondsToGetRVTime",value:function(){}},{key:"_secondsAfterGetAdRv",value:function(){}},{key:"beforeLoaderEnd",value:function(){return!!this._isLoaderInRequiredPercentage()||(this.createStateHandlers([{event:"loaderCurrCount",funcName:"_reCheckAd",isListenOnce:!0}]),!1)}},{key:"_isLoaderInRequiredPercentage",value:function(){return this.model.get("loaderCurrCount")>=this.model.get("playPriority.loaderPercent")}}])&&Yr(i.prototype,n),o&&Yr(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.O),to=Jr;function eo(t){return eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eo(t)}function io(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==eo(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==eo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===eo(o)?o:String(o)),n)}var r,o}function no(t,e){return no=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},no(t,e)}function ro(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=oo(t);if(e){var r=oo(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===eo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function oo(t){return oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},oo(t)}var so=i(1999),ao=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&no(t,e)}(a,t);var i,n,o,s=ro(a);function a(t,e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(i=s.call(this,t)).model=t,i.eligibilityService=e,i.log=new r.Z({unitType:i.model.get("unitType"),className:"adsManager",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.model.set("adState",ut().readyState),i.model.set("getAdState",ut().getAdState.notCalled),i.model.set("adManagerState",ut().adManagerState.empty,{silent:!0}),i._createAdsList(),i.model.set("nextPredict",NaN),i.adId=0,i.currentAdIndex=-1,i.model.set("activeTag",!1),i.model.set("activeAd",!1),i.model.set("impressionCount",0),i.playPriorityHandler=new to({model:i.model}),i._bindEvents(),so.sendingEventToTaboolaBridge("sessionStart",i.model.get("unitName")),i.model.get("isCancelGetAdOnEligibilityLost.isActive")&&(i.cancelGetAdOnEligibilityLostForRVAny=i.model.get("isCancelGetAdOnEligibilityLost.includeRVAny"),i._trackEligibilityLost()),i}return i=a,(n=[{key:"_createAdsList",value:function(){for(var t in this.adsList={},e().RV_TYPES)this.adsList[e().RV_TYPES[t]]=[]}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"getAdState:failed",funcName:"_onFailedToGetAd"},{event:"hasReadyAd:false",funcName:"_updateNextAd"},{event:"cancelRV:true",funcName:"_cancelAllRVCalls"},{event:"adState:playing",funcName:"_onFirstAdPlay",isListenOnce:!0},{event:"exploreMore",funcName:"_onExploreMore"}])}},{key:"adPredict",value:function(t,i){var n=this,r=this.model.get("adxDurationDebtPay");if(this._countReadyAdsByRV(!1,e().RV_TYPES.NON_RV)==this.model.get("maxNonRvVimpsInQueue")&&this.model.set("onMaxNonRvVimpsInQueue",!0),!(this._countReadyAdsByRV(!1,e().RV_TYPES.RV)>=this.model.get("maxVimpsInQueue")&&this._countReadyAdsByRV(!1,e().RV_TYPES.NON_RV)>=this.model.get("maxNonRvVimpsInQueue"))){var o=this.model.get("nextPredict");o!==e().RV_TYPES.RV||!this.model.get("isGettingRv1Ad")||this.model.get("adxInPrediction")?r&&!this.model.get("isRV1InQueue")||(this.firstGetAdFired||(this.log.info("First Get Ad Fired"),this.model.set("firstGetAdFired",!0),this.firstGetAdFired=!0),this._checkIfAlreadyHas1InList(),so.isArray(o)?so.forEach(o,(function(e){(!n.alreadyHas1InList||n.alreadyHas1InList&&0===e||n.alreadyHas1InList&&n.hasRV1AdxInQueue)&&(n.createNewAd(e,t,i),n._checkIfAlreadyHas1InList())}),this):(!this.alreadyHas1InList||this.alreadyHas1InList&&0===o||this.alreadyHas1InList&&this.hasRV1AdxInQueue)&&this.createNewAd(o,t,i),"mp4Predict"===this.model.get("nextPredictName")?this.model.set("mp4Predict",!0):this.model.set("mp4Predict",!1)):this.log.warning("Already getting rv1 ad, ignoring")}}},{key:"createNewAd",value:function(t,e,i){var n=this.model.get("nextPredictName");if(!this.model.get("isAllowDuplicateKey")){var r=this.adsList[t].some((function(e,i,n){return(e.adQState===ut().adQState.readyState||e.adQState===ut().adQState.impression)&&e.getAdKey===t}));if(r)return}this.model.set("adId",this.adId);var o=new Cn({model:this.model,ppKey:t,adId:this.adId,impressionCb:this.onAdImpression.bind(this),completeCb:this.onAdComplete.bind(this),predictName:n,getAdProperties:i,predictId:e});this.adsList[t].push(o),this.adId++}},{key:"_checkIfAlreadyHas1InList",value:function(){var t=this;this.alreadyHas1InList=!1,this.hasRV1AdxInQueue=!1,so.forEach(this.adsList[e().RV_TYPES.RV],(function(i){if("multiAdPredict"!==t.model.get("nextPredictName"))return t.alreadyHas1InList=!0,t.hasRV1AdxInQueue=i.predictId===e().PREDICT_NAMES.adxPredict,!1}),this)}},{key:"onAdImpression",value:function(t){t.setActiveTag(),this._updateNextAd(),this.model.set("adManagerState",ut().adManagerState.hasAds),this.model.get("hadReady")||this.model.get("isEligibilityNomination")||this.model.get("isRvPriority")||(this.eligibilityService?(this.eligibilityService._calculateEligibility(),this.model.get("isEligibleToPlay")?this._triggerReady():this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_triggerReady",isListenOnce:!0}])):this._triggerReady(),this.model.set("hadReady",!0));var i=t.getAdData();if(this._isRV1withRV0InStack=function(){return i.requiredViewability&&this.adsList[e().RV_TYPES.NON_RV].length>0},"any"===t.getAdKey&&this._moveAdFromAnyQueue(t,i.requiredViewability),t.rv=i.requiredViewability,t.itemType=i.itemType,this.model.increaseCounter(i.requiredViewability?"adsList.rvAds":"adsList.nonRvAds"),!this.model.get("isEligibleToPlay")&&this.model.get("lostEligibilityTime")&&t.fireSkipVimp1EligibilityLost(i.requiredViewability),i.requiredViewability&&!this._isSwapEnabled()){var n=this.getPlayingAdRVType();void 0!==n&&t.fireSkipVimp1AdIsPlaying(n)}this._isRV1withRV0InStack()&&t.onAdPlayingRV1StackWithRV0()}},{key:"_isSwapEnabled",value:function(){return this.model.get("isForceSwapToRV")}},{key:"_triggerReady",value:function(){w().trigger("ready")}},{key:"_moveAdFromAnyQueue",value:function(t,i){var n=this;so.each(this.adsList[e().RV_TYPES.ANY],(function(i,r){i.adId===t.adId&&n.adsList[e().RV_TYPES.ANY].splice(r,1)})),this.adsList[i?e().RV_TYPES.RV:e().RV_TYPES.NON_RV].push(t)}},{key:"getPlayingAdRVType",value:function(){return this.adsList[e().RV_TYPES.NON_RV].some((function(t){return t.adState===ut().adState.playing}))?e().RV_TYPES.NON_RV:this.adsList[e().RV_TYPES.RV].some((function(t){return t.adState===ut().adState.playing}))?e().RV_TYPES.RV:void 0}},{key:"onAdComplete",value:function(t,e){if(this._removeAd(t.adId,t.adData&&void 0!==t.adData.requiredViewability?t.adData.requiredViewability:t.getAdKey,!1),this.model.get("hasReadyAd")){var i=this.model.getStorage("nextAd");(null==i?void 0:i.adId)===t.adId&&this.model.set("hasReadyAd",!1)}e&&!this.model.get("hasReadyAd")&&(this.model.set("lastAutoKilledPredict",t.getAdKey),this.model.set("adState",t.adState))}},{key:"close",value:function(){this.model.set("adManagerState",ut().adManagerState.stopped),this.model.set("closeState",ut().closeState.adManagerStop)}},{key:"pauseGetAds",value:function(){for(var t in this.model.set("adManagerState",ut().adManagerState.paused),this.adsList)this.adsList[t]=[];this.model.set("hasReadyAd",!1)}},{key:"_cancelAllRVCalls",value:function(){so.forEach(this.adsList[e().RV_TYPES.RV],function(t){t.cancelGetAd(),this._removeAd(t.adId,e().RV_TYPES.RV,!0)}.bind(this)),this.model.set("cancelRV",!1)}},{key:"_removeAdsByKeyAndStatus",value:function(t,e){so.forEach(this.adsList[t],function(i){e.indexOf(i.getAdState)>-1&&(i.cancelGetAd(),this._removeAd(i.adId,t,!0))}.bind(this))}},{key:"_onFailedToGetAd",value:function(){var t,e=this.model.get("getAdCurrId");for(var i in this.adsList)t||(t=so.find(this.adsList[i],(function(t){return t.adId===e}),this));this.model.set("lastFailedPredictProperties",t.getAdProperties),this.model.set("lastFailedPredict",t.getAdKey),this._removeAd(e,t.adData&&void 0!==t.adData.requiredViewability?t.adData.requiredViewability:t.getAdKey,!0)}},{key:"_removeAd",value:function(t,i,n){var r=this,o=i?e().RV_TYPES.RV:e().RV_TYPES.NON_RV;so.size(this.adsList[o])>0&&(this.adsList[o]=this.adsList[o].filter((function(e){return e.adId===t&&r.model.decreaseCounter(e.rv?"adsList.rvAds":"adsList.nonRvAds"),e.adId!==t}))),0===this.countReadyAds(n)&&this.model.set("adManagerState",ut().adManagerState.empty)}},{key:"_filterAds",value:function(){var t=this,i=[];for(var n in this.adsList)i=i.concat(this.adsList[n].filter((function(i){return i.adQState===ut().adQState.impression&&!i.isUsed&&(t.getPlayingAdRVType()===e().RV_TYPES.NON_RV||t._isAllowAd(i))})));return i}},{key:"_updateNextAd",value:function(){var t=this,i=this._filterAds(),n=this._chooseBestAd(i),r=i[n];r&&(this.playPriorityHandler.setNextAd(r),r.getAdKey&&r.getAdKey===e().RV_TYPES.RV&&this._countReadyAdsByRV(!0,e().RV_TYPES.RV)>1&&r.oppsService.onAdPlayingNextAdReadyRV1());var o=r;if(this.model.get("hasReadyAd")){var s=this.model.get("playPriority.type"),a=function(e){so.each(t.adsList[e],function(t,i){n===i&&e==o.getAdKey||t.adQState===ut().adQState.impression&&o&&o.getAdData&&("rpox"===s?t.reportRpoxSkip(o.getAdData()):"ppKey"===s&&t.reportPpKeySkip(o.getAdData()))}.bind(t))};for(var l in this.adsList)a(l)}}},{key:"_chooseBestAd",value:function(t){var e=this,i=0;if(1===so.size(t))return i;var n=this.model.get("playPriority.type")||"rpox";if("ppKey"===n)so.find(t,(function(t,n){t.getAdKey===e.model.get("playPriority.key")&&(i=n)}));else if("function"===n){var r=this.model.get("playPriority.func");i=r(t)}else"rpox"===n&&(i=this.priorityByRpox(t));return i}},{key:"priorityByRpox",value:function(t){var e=0,i=(this.model,0);return so.each(t,(function(t,n){t.rpox>=i&&(i=t.rpox,e=n)})),e}},{key:"_hasPlayingAd",value:function(){return!!this.model.get("activeTag")}},{key:"countReadyAds",value:function(t){var e=0;for(var i in this.adsList)e+=this._countReadyAdsByRV(t,i);return e}},{key:"_countReadyAdsByRV",value:function(t,e){var i=0;return so.forEach(this.adsList[e],(function(e){(t&&e.adQState!==ut().adQState.readyState||e.adQState===ut().adQState.impression)&&i++}),this),i}},{key:"_onFirstAdPlay",value:function(){this.model.set("hadPlayedAd",!0)}},{key:"_isAllowAd",value:function(t){return this._isAllowSingleAd(t)}},{key:"_isAllowSingleAd",value:function(t){if(this.model.get("postRepeatMode"))return!0;var e=t.adTypeConfig&&t.adTypeConfig.singleAd&&t.adTypeConfig.singleAd.isPlacementSingleAd;return!(e&&this.model.get("hadPlayedAd")||this.model.get("isPreventNextAd")||e&&this._isAdTypeDropped(Xn().singleAd.name))}},{key:"_isAdTypeDropped",value:function(t){var e=this.model.get("droppedAdTypes");return!!so.isArray(e)&&0!==(e=e.filter((function(e){return t===e}))).length}},{key:"_getLastActiveAd",value:function(){var t=this;for(var e in this.adsList){var i=this.adsList[e].filter((function(e){return e.adId===t.model.get("lastActiveAd")}));if(i&&i[0])return i}return[]}},{key:"_onExploreMore",value:function(){this.model.get("exploreMoreConfig.clearAdsQ")&&this._removeAdsByKeyAndStatus(e().RV_TYPES.NON_RV,["gotAd","waiting","failed","stopped","finished"]);var t=this.model.get("exploreMoreConfig.maxNonRvVimpsInQueue");t&&this.model.set("maxNonRvVimpsInQueue",t)}},{key:"_trackEligibilityLost",value:function(){this.createStateHandlers([{event:"isEligibleToPlay:false",funcName:"_cancelGetAdOnLostEligibility"}])}},{key:"_cancelGetAdOnLostEligibility",value:function(){this._cancelGetAdOnLostEligibilityByRVType(e().RV_TYPES.RV),this.cancelGetAdOnEligibilityLostForRVAny&&this._cancelGetAdOnLostEligibilityByRVType(e().RV_TYPES.ANY)}},{key:"_cancelGetAdOnLostEligibilityByRVType",value:function(t){var i=this;this.adsList[t].map((function(t){t.getAdState===ut().getAdState.gettingAd&&(t.cancelGetAd(e().CANCEL_GET_AD_REASONS.LOST_ELIGIBILITY),i.model.fireCancelGetAdOnEligibilityLost())}))}}])&&io(i.prototype,n),o&&io(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.O),lo=ao;i(1999);function co(t){return co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},co(t)}function uo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==co(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==co(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===co(o)?o:String(o)),n)}var r,o}function ho(t,e){return ho=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ho(t,e)}function fo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=po(t);if(e){var r=po(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===co(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function po(t){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},po(t)}var mo=i(1999),yo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ho(t,e)}(a,t);var i,n,o,s=fo(a);function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t)).model=t,e.shouldConsiderBlurAsTabOut=e.model.get("usePageEventsForTabStatus")&&!0===e.model.get("isMobile");var i=Vr(e.model);return e.model.set("isInTab",i),e.log=new r.Z({unitType:e.model.get("unitType"),className:"tabStatusService",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.bindEvent(),e}return i=a,(n=[{key:"bindEvent",value:function(){this.model.listenTo(w(),"window:tab:change",this._onTabEvent.bind(this))}},{key:"_onTabEvent",value:function(t){this.model.set("tabState",mo.find(Object.keys(e().TAB_STATE),(function(i){return e().TAB_STATE[i]===t}))),this._isTabOut(t)?this.model.set("isInTab",!1):this.model.set("isInTab",!0)}},{key:"_isTabOut",value:function(t){return t===e().TAB_STATE.tabOut||!!this.shouldConsiderBlurAsTabOut&&t===e().TAB_STATE.blur}}])&&uo(i.prototype,n),o&&uo(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.O),go=yo;function vo(t){return vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vo(t)}function bo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==vo(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==vo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===vo(o)?o:String(o)),n)}var r,o}function _o(t,e){return _o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_o(t,e)}function So(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=wo(t);if(e){var r=wo(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===vo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function wo(t){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wo(t)}var To=i(1999),Po=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_o(t,e)}(a,t);var i,n,o,s=So(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t)).model=t,e.log=new r.Z({unitType:e.model.get("unitType"),className:"GDPRManager",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e._init(),e}return i=a,(n=[{key:"_init",value:function(){var t=window.__cmp,i=e().UNIT_TYPES[this.model.get("unitType")],n=i===e().UNIT_TYPES.EXPANDABLE||i===e().UNIT_TYPES.EXPANDABLE_MOBILE,r=i===e().UNIT_TYPES["300X600"]||i===e().UNIT_TYPES["300X600_MOBILE"];(n||r)&&!this.model.get("isStayInIframe")&&this._isInFriendlyIframe()&&(t=To.getTopWindow().__cmp),void 0!==t?(this.model.set("hasCMPonPage",!0),t("getConsentData",null,this._getConsentDataCB.bind(this))):(this.model.set("hasCMPonPage",!1),this.model.set("canStartPlayer",!0))}},{key:"_getConsentDataCB",value:function(t){var e=t.gdprApplies,i=t.consentData||"";this._setPlayerParams(e,i)}},{key:"_setPlayerParams",value:function(t,e){zi().player?(zi().player.set("gdprApplies",t),zi().player.set("cdb",e)):(this.model.set("gdprApplies",t),this.model.set("consentDaisyBit",e),this.model.set("canStartPlayer",!0))}},{key:"_isInFriendlyIframe",value:function(){return this._isInIframe()&&cmTag.config.iframeData.isFriendlyIframe}},{key:"_isInIframe",value:function(){return cmTag.config.iframeData.inIframe||cmTag.config.iframeData.inDFP}}])&&bo(i.prototype,n),o&&bo(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.O),Ao=Po;function Eo(t){return Eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eo(t)}function Oo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Co(n.key),n)}}function Co(t){var e=function(t,e){if("object"!==Eo(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Eo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Eo(e)?e:String(e)}var ko=function(){function t(e,i){var n,r,o,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=function(){return!(!navigator||"function"!=typeof navigator.sendBeacon)},(r=Co(r="_isSendBeaconSupported"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this.useSendBeacon=this._isSendBeaconSupported()&&s,this.baseUrl=e,this.useSendBeacon||(this.async=null==a||a,this.withCredentials=null==l||l,this.timeout=c||5e3,this.contentType=i||"application/x-www-form-urlencoded")}var e,i,n;return e=t,(i=[{key:"_onFail",value:function(){this.gotResponse||(this.gotResponse=!0)}},{key:"send",value:function(t,e){this.useSendBeacon?this._sendBeacon(t,e):this._sendXHR(t,e)}},{key:"_sendBeacon",value:function(t,e){var i=void 0!==e?"?rst=".concat(e):"",n="".concat(this.baseUrl).concat(i);navigator.sendBeacon(n,t)}},{key:"_sendXHR",value:function(t,e){if(this.baseUrl){var i=new XMLHttpRequest,n=void 0!==e?"?rst=".concat(e):"",r="".concat(this.baseUrl).concat(n);return i.open(t?"POST":"GET",r,!0),i.withCredentials=this.withCredentials,i.setRequestHeader("Content-type",this.contentType),i.async=this.async,i.timeout=this.timeout,i.gotResponse=!1,this._setHttpEvents(i),i.send(t),!0}return!1}},{key:"_setHttpEvents",value:function(t){var e=this;t.addEventListener("error",this._onFail),t.addEventListener("abort",this._onFail),t.addEventListener("timeout",this._onFail),t.addEventListener("readystatechange",(function(){if(4==e.readyState){if(e.gotResponse)return;e.gotResponse=!0}}))}}])&&Oo(e.prototype,i),n&&Oo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Io=ko;function Ro(t){return Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ro(t)}function Do(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Ro(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Ro(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Ro(o)?o:String(o)),n)}var r,o}var Vo=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.service=i,this.models={},this.data={psthdrs:"application/json",timbtopps:2e3}}var e,i,n;return e=t,(i=[{key:"setModel",value:function(t,e){this.models[t]=e}},{key:"get",value:function(t,e){var i;if(e&&this.models.hasOwnProperty(t)){var n=(null===(i=this.models)||void 0===i?void 0:i[t].get(e))||void 0;return n||this._getFromData(e)}}},{key:"getBillableEvents",value:function(t){return(this.get(t,"billableEvents")||[]).concat((this.get(t,"bllblevt")||"").split(",").map((function(t){return parseInt(t,10)})))}},{key:"_getFromData",value:function(t){var e=t.toString();return e.includes(".")?e.split(".").reduce((function(t,e){return t&&t[e]}),this.data):this.data[e]}},{key:"destroy",value:function(){var t=[void 0,void 0];this.models=t[0],this.data=t[1]}}])&&Do(e.prototype,i),n&&Do(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),No=Vo;function xo(t){return xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xo(t)}var jo=function(t){return t?1:0},Mo=function(t,e){try{var i=[];return JSON.stringify(t,(function(t,e){if(null!=e&&"object"==xo(e)){if(i.indexOf(e)>-1)return;i.push(e)}return e}),e)}catch(t){return""}},Lo={KIBANA_URL:"vidanalytics.taboola.com/putes/units-ads-analytics",SERVICES:{UNIT:"unit",PLAYER:"player"},EXTRA_PARAMS_EXCEPTIONS:["vidCurrentTime"],OPPS_PARAMETERS_MAPING:{player:{pstn:"pstn",mob:"isMobile",unv:"unit_version",unit_type:"unit_type",pv:"playerVersion",fdScore:"fdScore",abt:"ab_test",agl:"preset.level",su:"subUnitType",awr:"performance.dtsvrRoundTripAverageDuration",pm:"performance.performanceMeasurment",dtsvrRoundTripAverageDuration:"performance.dtsvrRoundTripAverageDuration",mp:"modifiedPlacement",sts:"playerRepeatCount",ft:"frameType",be:"playerHasRvInQ",pt:"ab_test",width:"width",height:"height",cmDast:"auc_dast"},unit:{pstn:"pstn",mob:"isMobile",unv:"unit_version",unit_type:"unit_type",fdScore:"fdScore",abt:"abTest",agl:"preset.level",awr:"performance.dtsvrRoundTripAverageDuration",pm:"performance.performanceMeasurment",su:"subUnitType",ft:"frameType",mp:"modifiedPlacement",vstt:"isInTab",cmDast:"cmDast",be:"playerHasRvInQ",sts:"playerRepeatCount"}},MAX_ES_STRING_LENGTH:32766};function Bo(t){return Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bo(t)}function Fo(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Uo(t,e,i){return(e=Ho(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Wo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ho(n.key),n)}}function Ho(t){var e=function(t,e){if("object"!==Bo(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Bo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Bo(e)?e:String(e)}var $o=i(1999),zo=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.get("player.urls.oppsRequest")||"".concat(e.get("opps_base_path"),"/OpportunityServlet"),r=e.get("player.urls.nonBllboppsRequest")||"".concat(e.get("non_bllb_opps_base_path"),"/OpportunityServlet"),o=e.get("sendBeacon");this.opps=[],this.fireOppsInterval=null,this.stopped=!1,this.unloadCallbacks=[],this.fireOppsCallbacks=[],this.store=new No,this.unloadEventName=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i)?"pagehide":"beforeunload",this._setFireOppsBeforeUnload(),this.setSource(i,e),this.oppRequest=new Io(n,this.store.get(i,"psthdrs"),o),this.nonBllbOppRequest=new Io(r,this.store.get(i,"psthdrs"),o),this._setFireOppsInterval(i)}var e,i,n;return e=t,i=[{key:"registerCallback",value:function(t,e){this[t].push(e)}},{key:"unRegisterCallback",value:function(t,e){this[t].splice(this[t].indexOf(e),1)}},{key:"_activateCallbacks",value:function(t){for(var e=0;e<this[t].length;e++){var i=this[t][e];this[t].splice(this[t].indexOf(i),1),i()}}},{key:"_addAbTests",value:function(t,e){return"".concat(t.requiredViewabilityDrawn?"!ronrv":"").concat(t.moatSampling?"!mtsmp":"").concat(this.store.get(e,"isReadMoreOnPage")?"!rdmr":"")}},{key:"_addExtraParams",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Fo(Object(i),!0).forEach((function(e){Uo(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Fo(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},t);return Object.keys(e).forEach((function(t){Lo.EXTRA_PARAMS_EXCEPTIONS.indexOf(t)<0&&(i[t]=e[t])})),i}},{key:"_addCmTagParams",value:function(t,e){var i=this.store.get(t,"oppsQS")||{};Object.assign(e,i)}},{key:"_addDelayedParams",value:function(t,e,i,n){var r=this._getDelayedParams(e,i,n)||{};Object.assign(t,r)}},{key:"_getDelayedParams",value:function(t,e,i){var n=Lo.OPPS_PARAMETERS_MAPING[t],r=this.store.get(t,n.width),o=this.store.get(t,n.height);return{"auc-dast":this.store.get(t,n.cmDast)||void 0,sts:i.STS||this.store.get(t,n.sts),wp:i.WP,vpd:e.pubId||i.VPD,vptd:e.tagId||i.VPTD,vmt:(e.isRon?1:0)||i.VMT||0,pt:$o.crc32(this.store.get(t,n.pt)||999),w:r||void 0,h:o||void 0,rv:e.requiredViewability}}},{key:"buildOppsData",value:function(t,e,i){var n,r=Lo.OPPS_PARAMETERS_MAPING[t],o=i.tagItem,s=o.lineItemStats,a=i.extraData||{},l=i.playerParams||{},c=o.vpaidWrapperData||(o.vpaidWrapper&&o.vpaidWrapper.tag?o.vpaidWrapper.tag.vpaidWrapperData:void 0);n=t===Lo.SERVICES.UNIT?this.store.get(t,"vstt")?1:0:jo(!document.hidden);var u,d,h={tms:Date.now(),st:(u=o.rollType,d={"pre-roll":0,preroll:0,"mid-roll":-1,midroll:-1,"post-roll":-2,postroll:-2},d.hasOwnProperty(u)?d[u]:0),sts:this.store.get(t,r.sts),rs:o.sequenceId,os:1*o.waterfallTagId+1,d:(new Date).getTime()-o.created,rst:e,dast:o.vidDast||o.dast,pstn:this.store.get(t,r.pstn)||1,dp:$o.crc32(o.dp),mob:jo(this.store.get(t,r.mob)),vstt:n,unv:this.store.get(t,r.unv),unt:$o.crc32(this.store.get(t,r.unit_type)),abt:"".concat(this.store.get(t,r.abt)).concat(this._addAbTests(o,t)),frd:this.store.get(t,r.fdScore),agl:this.store.get(t,r.agl),rp:c&&c.vastPrice,mty:o.mty||c&&c.mediatype,fv_t:s&&s.tries,fv_c:s&&s.conversions,fv_f:s&&s.fails,fv_fr:s&&s.failsRow,awr:this.store.get(t,r.awr),pm:this.store.get(t,r.pm),su:this.store.get(t,r.su),pdast:i.playerDAST,extpvid:window.TRCImpl&&window.TRCImpl.external_page_view,vpd:o.pubId,vptd:o.tagId,pv:this.store.get(t,r.pv)||999,vmt:Number(o.isRon)||0,ft:this.store.get(t,r.ft),ttv:o.timeToVimp,bovpv:o.bovpv,bovpg:o.bovpg,be:this.store.get(t,r.be)?1:0,pap:void 0!==o.pap?o.pap:"",rv:o.requiredViewability,mp:this.store.get(t,r.mp),sp:i.activeData?i.activeData.sp:void 0,prdid:void 0!==i.predictorId?i.predictorId:void 0};return this._addCmTagParams(t,h),h=this._addExtraParams(h,a),this._addDelayedParams(h,t,o,l),h}},{key:"send",value:function(t,e,i){if(!this.stopped){var n=this.buildOppsData(t,e,i);this._isBillableEvent(t,e)||!this.store.get(t,"cmbopps")?this.oppRequest.send(Mo([n]),e):this.opps.push(n)}}},{key:"_setFireOppsInterval",value:function(t){this.stopped||this.fireOppsInterval||(this.fireOpps=this._fireOpps.bind(this),this.fireOppsInterval=setInterval(this.fireOpps,this.store.get(t,"timbtopps")))}},{key:"destroy",value:function(){if(!this.stopped){this._activateCallbacks("unloadCallbacks"),window.removeEventListener(this.unloadEventName,this._destroy),this.fireOppsInterval=clearInterval(this.fireOppsInterval),this._fireOpps(),this.stopped=!0,this.store&&this.store.destroy();var t=[void 0,void 0,void 0];this.store=t[0],this.fireOpps=t[1],this._destroy=t[2]}}},{key:"_fireOpps",value:function(){this.stopped||(this._activateCallbacks("fireOppsCallbacks"),this.opps.length>0&&this.nonBllbOppRequest.send(Mo(this.opps)),this.opps=[])}},{key:"_setFireOppsBeforeUnload",value:function(){this._destroy=this.destroy.bind(this),window.addEventListener(this.unloadEventName,this._destroy)}},{key:"_isBillableEvent",value:function(t,e){return this.store.getBillableEvents(t).indexOf(parseInt(e,10))>-1}},{key:"setSource",value:function(t,e){this.store&&this.store.setModel(t,e)}}],i&&Wo(e.prototype,i),n&&Wo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),qo=zo;function Go(t){return Go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Go(t)}function Yo(t){return function(t){if(Array.isArray(t))return Ko(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ko(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ko(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ko(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Qo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Go(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Go(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Go(o)?o:String(o)),n)}var r,o}function Zo(t,e){return Zo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zo(t,e)}function Xo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Jo(t);if(e){var r=Jo(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Go(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Jo(t){return Jo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jo(t)}i(1999);var ts=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zo(t,e)}(s,t);var e,i,n,o=Xo(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t.model)).model=t.model,e.log=new r.Z({unitType:e.model.get("unitType"),className:"OppsulaManager",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.oppsArr=[],e._loadOppsula(),e}return e=s,(i=[{key:"_loadOppsula",value:function(){this.oppsula=new qo(this.model,"unit"),this._sendOppsFromArr()}},{key:"send",value:function(t,e){this.oppsula.send("unit",e,t)}},{key:"_sendOppsFromArr",value:function(){var t=this;this.oppsArr.splice(0).forEach((function(e){return t.send.apply(t,Yo(e))}))}}])&&Qo(e.prototype,i),n&&Qo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(n.O),es=function(){var t;return function(e){return t||(t=new ts(e)),t}}(),is=es;i(1999);function ns(t){return ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ns(t)}function rs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==ns(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==ns(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===ns(o)?o:String(o)),n)}var r,o}function os(t,e){return os=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},os(t,e)}function ss(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=as(t);if(e){var r=as(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===ns(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function as(t){return as=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},as(t)}var ls=i(1999),cs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&os(t,e)}(s,t);var e,i,n,o=ss(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).model=t,e.adjacCardPlacement=e.model.get("adjacCardPlacement"),e.log=new r.Z({unitType:e.model.get("unitType"),className:"organicCardInjector",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e._bindEvents(),e}return e=s,(i=[{key:"_bindEvents",value:function(){}},{key:"injectOrganicCard",value:function(t){if(this.adjacCardPlacement=this.model.get("adjacCardPlacement")||this.adjacCardPlacement,!this._isCardOrganic(this.adjacCardPlacement)&&!this.isOrganicCardInjected){this.organicContainer=(0,_.default)(t)[0];var e=ls.getOrganicCard();if(!e)return this.log.error("missing mode can't inject organic"),!1;if(!this.organicContainer)return this.log.error("missing container to inject an organic card"),!1;var i=document.createElement("div");i.id="taboola-adjacent-organic-card",i.classList.add("tbl-feed-card"),i.dataset.cardIndex=this.adjacCardPlacement-.25,this.organicContainer.insertAdjacentElement("afterend",i),window._taboola=window._taboola||[];var n=this._getPlacementName();return this.isOrganicCardInjected=!0,this.model.set("isOrganicCardInjected",!0),_taboola.push({mode:e,container:"taboola-adjacent-organic-card",placement:n,target_type:"mix"}),!0}}},{key:"_getPlacementName",value:function(){var t=(0,_.default)(this.model.get("parentSelector"))[0];if(t&&t.dataset&&t.dataset.parentPlacementName)return t.dataset.parentPlacementName+" | Card 0"}},{key:"_isCardOrganic",value:function(t){var e=(0,_.default)('[data-card-index="'.concat(t,'"]'))[0];return!(!e||!e.querySelector(".trc-content-organic"))}}])&&rs(e.prototype,i),n&&rs(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(n.O);!function(){var t}();function us(t){return us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},us(t)}function ds(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==us(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==us(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===us(o)?o:String(o)),n)}var r,o}var hs="data-cm-v-ad-id",fs=function(){function t(e,i){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t.instance)return t.instance;this.viewabilityPercent=e/100,this.viewPercent100=i/100,this.threshold=[0,this.viewabilityPercent,this.viewPercent100,1],t.instance=this,this.elementsToObserve={},this.observerOptions={root:null,rootMargin:"0px",threshold:this.threshold},this.intersectionObserver=this._createObserver(this._observerCallback.bind(this),this.observerOptions)}var e,i,n;return e=t,i=[{key:"_observerCallback",value:function(t){var e=this;t.map((function(t){var i=t.intersectionRatio,n=t.target.getAttribute(hs),r=e.viewabilityPercent<=i,o=e.viewPercent100<=i;e.elementsToObserve[n].model.set("isViewableByOb",r),e.elementsToObserve[n].model.set("isViewableByOb100",o)}))}},{key:"_createObserver",value:function(t,e){return new IntersectionObserver(t,e)}},{key:"startObserverElement",value:function(t,e,i){t.setAttribute(hs,e),this.elementsToObserve[e]={element:t,model:i},this.elementsToObserve[e].model.set("isViewableByOb100",i.get("isViewable100")),this.intersectionObserver.observe(t)}},{key:"stopObserveElement",value:function(t){this.intersectionObserver.unobserve(this.elementsToObserve[t].element),delete this.elementsToObserve[t]}},{key:"stopObserver",value:function(){this.intersectionObserver.disconnect()}}],i&&ds(e.prototype,i),n&&ds(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ps(t){return ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ps(t)}function ms(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==ps(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==ps(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===ps(o)?o:String(o)),n)}var r,o}function ys(t,e){return ys=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ys(t,e)}function gs(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=vs(t);if(e){var r=vs(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===ps(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function vs(t){return vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vs(t)}var bs=i(1999),_s=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ys(t,e)}(a,e);var i,n,o,s=gs(a);function a(e){var i;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(i=s.call(this)).constructor===a)throw new Error("Can't instantiate abstract class!");return i.model=e.model,i.log=new r.Z({unitType:i.model.get("unitType"),className:i.constructor.name,version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.timers={},i.isAmp=i.model.get("frameType")===t.FRAME_TYPE.amp&&i.model.get("isUseAmpObserver"),i.onViewability=e.onViewability||function(){},i.isFirstUpdate=!0,i.traceViewabilitySeconds=i.model.get("traceViewabilitySeconds"),i.traceViewability100Seconds=i.model.get("traceViewability100Seconds"),i._startAdViewabilityObserver(),i}return i=a,(n=[{key:"_startAdViewabilityObserver",value:function(){this.viewabilityObserverHelper=new fs(this.model.get("viewabilityPercent")||50,this.model.get("100viewPercent")||100)}},{key:"updateActiveAd",value:function(t){this.activeAdId!==t.adId&&(this.isFirstUpdate&&(this._bindEvents(),this.isFirstUpdate=!1),this.activeAd=t,(this.activeAdId||0===this.activeAdId)&&this.viewabilityObserverHelper.stopObserveElement(this.activeAdId),this.activeAdId=t.adId,this._startViewabilityObserverOfElement(t),this._initViewabilityHandler())}},{key:"_startViewabilityObserverOfElement",value:function(t){var e=this._getElementForObserver(t),i=this.activeAdId,n=this.model;this.viewabilityObserverHelper.startObserverElement(e,i,n)}},{key:"_getElementForObserver",value:function(t){var e=this._getWrapperElement(t);return this.model.get("isUseVideoElementForViewabilityObserver")?this._getAdVideoElementFromWrapper(e):e}},{key:"_getWrapperElement",value:function(t){return t.vpaidWrapper.localTarget||t.vpaidWrapper.adTarget}},{key:"_getAdVideoElementFromWrapper",value:function(t){return t.querySelector("video")}},{key:"_initViewabilityHandler",value:function(){throw new Error("Abstract method!")}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"activeAdCurrentTime",funcName:"_checkViewability"},{event:"isViewableByOb:true",funcName:"_updateViewabilityTimes"},{event:"isViewableByOb100:true",funcName:"_update100ViewabilityTime"}])}},{key:"_updateViewabilityTimes",value:function(){this._updateViewabilityTime(),this._updateOneSecViewabilityTime(),this._update100ViewabilityTime()}},{key:"_updateViewabilityTime",value:function(){if(this.model.get("isViewableByOb")&&this.model.get("isInTab")){var t=this.model.get("activeAdCurrentTime");this.activeAdViewabilityTime=t+this.traceViewabilitySeconds}else this.activeAdViewabilityTime=void 0}},{key:"_updateOneSecViewabilityTime",value:function(){if(this.model.get("isViewableByOb")&&this.model.get("isInTab")){var t=this.model.get("activeAdCurrentTime");this.activeAdOneSecViewabilityTime=t+1}else this.activeAdOneSecViewabilityTime=void 0}},{key:"_update100ViewabilityTime",value:function(){if(this.model.get("isViewableByOb100")&&this.model.get("isInTab")){var t=this.model.get("activeAdCurrentTime");this.activeAd100ViewabilityTime=t+this.traceViewability100Seconds}else this.activeAd100ViewabilityTime=void 0}},{key:"_checkViewability",value:function(){if(this.activeAd){var t=this.model.get("activeAdCurrentTime");this._checkNormalViewability(t),this._checkOneSecViewability(t),this._check100Viewability(t)}}},{key:"_checkNormalViewability",value:function(t){var e=this.model.get("activeAdData")?this.model.get("activeAdData").mediatype:void 0,i=this.model.get("mediatypesArraySkippingViewableCheckAtSendOppMoment"),n=this.model.get("isViewableByOb");i&&e&&i.includes(e)&&(n=!0),this._testViewability(n,t,this.activeAdViewabilityTime,this.activeAd.isViewed)&&this._onViewability()}},{key:"_checkOneSecViewability",value:function(t){this._testViewability(this.model.get("isViewableByOb"),t,this.activeAdOneSecViewabilityTime,this.activeAd.isViewedOneS)&&this._onViewabilityOneS()}},{key:"_check100Viewability",value:function(t){this._testViewability(this.model.get("isViewableByOb100"),t,this.activeAd100ViewabilityTime,this.activeAd.isViewed100)&&this._onViewability100()}},{key:"_testViewability",value:function(t,e,i,n){return t&&e>=i&&!n}},{key:"_onViewability",value:function(){this.activeAd&&(this.activeAd.onViewability(),bs.dispatchTRC(ct.storiesUnitState.videoViewable,this.model),this.onViewability())}},{key:"_onViewabilityOneS",value:function(){this.activeAd&&this.activeAd.onViewabilityOneS()}},{key:"_onViewability100",value:function(){this.activeAd&&this.activeAd.onViewability100()}}])&&ms(i.prototype,n),o&&ms(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.O),Ss=_s;i(1999);function ws(t){return ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(t)}function Ts(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==ws(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==ws(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===ws(o)?o:String(o)),n)}var r,o}function Ps(t,e){return Ps=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ps(t,e)}function As(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Es(t);if(e){var r=Es(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===ws(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Es(t){return Es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Es(t)}var Os=".tbl-read-more-box",Cs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ps(t,e)}(s,t);var e,i,n,o=As(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this)).model=t.model,e.log=new r.Z({unitType:e.model.get("unitType"),className:e.constructor.name,version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.model.set("readMoreIsVisible",!1),e._initObserver(),e}return e=s,(i=[{key:"_bindEvents",value:function(){TRC.listen("readMoreClicked",this._clearObservers.bind(this)),this.createStateHandlers([{event:"impressionCount:1",funcName:"_observerCallback",isListenOnce:!0}])}},{key:"_initObserver",value:function(){var t=(0,_.default)(".tbl-read-more-btn")[0]||(0,_.default)(Os)[0],e={rootMargin:(this.model.get("readMoreObserver.observerMargin")||"10")+"px",threshold:0},i=(0,_.default)(Os)[0].getBoundingClientRect();this._isReadMoreInitiallyInViewport(i)?this.model.set("readMoreIsInitiallyInViewport",!0):this._unitIsAboveReadMore(i)||(this._bindEvents(),this.readMoreObserver=t&&new IntersectionObserver(this._observerCallback.bind(this),e),this.readMoreObserver&&this.readMoreObserver.observe(t))}},{key:"_observerCallback",value:function(t){var e=this;t[0]&&t[0].isIntersecting?(this.model.set("hasImpBeforeReadMoreViewable",!1),this.model.set("isReadMoreInViewport",!0),window.TRC.listen("readMoreClicked",(function(){return e._onReadMoreClick()}))):this.model.get("impressionCount")>0&&void 0===this.model.get("hasImpBeforeReadMoreViewable")&&this.model.set("hasImpBeforeReadMoreViewable",!0)}},{key:"_onReadMoreClick",value:function(){this.model.set("readMoreClicked",!0),this.model.set("isReadMoreInViewport",!1),this._clearObservers()}},{key:"_clearObservers",value:function(){this.readMoreObserver&&this.readMoreObserver.disconnect()}},{key:"_isReadMoreInitiallyInViewport",value:function(t){return!!t&&t.top>=0&&t.left>=0&&t.bottom<=window.innerHeight&&t.right<=window.innerWidth}},{key:"_unitIsAboveReadMore",value:function(t){var e=this.model.get("parentSelector"),i=e&&(0,_.default)(e)[0],n=i&&i.getBoundingClientRect();return!n||!t||n.bottom<=t.top}}])&&Ts(e.prototype,i),n&&Ts(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(n.O),ks=Cs;i(4187);function Is(t){return Is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Is(t)}function Rs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Is(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Is(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Is(o)?o:String(o)),n)}var r,o}var Ds=i(1999),Vs=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.window=e||window,this.conf=i,this.$window=(0,_.default)(window),this.windowHeight=this.$window.height(),this.windowWidth=this.$window.width(),this.setScrollableSelector(n),this._timeBetweenEvents=100,this.keyPressMap={17:!1,18:!1,84:!1,86:!1},this._setScrollListener(),this._setMouseMoveListener(),this._setTabViewListener(),this._setOrientationChangeListener(),this._setResizeListener(),this._setTaboolaReadMoreListener()}var i,n,r;return i=t,(n=[{key:"_setScrollListener",value:function(){var t=Ds.throttle(this._trigger.bind(this,"window:scroll:change"),this._timeBetweenEvents);this.scrollSelector.addEventListener("scroll",t)}},{key:"_setMouseMoveListener",value:function(){var t=Ds.throttle(this._trigger.bind(this,"window:mouse:move"),this._timeBetweenEvents);this.window.addEventListener("mousemove",t)}},{key:"_setOrientationChangeListener",value:function(){var t=Ds.throttle(this._trigger.bind(this,"window:orientation:change"),this._timeBetweenEvents);window.addEventListener("orientationchange",t)}},{key:"_setResizeListener",value:function(){var t=Ds.throttle(this._handleResizeEvent.bind(this),this._timeBetweenEvents);window.addEventListener("resize",t)}},{key:"_setTabViewListener",value:function(){this.isTabOut="hidden"===document.visibilityState,this.window.document.addEventListener("visibilitychange",this._handleVisibilityChange.bind(this)),this.window.addEventListener("focus",this._handleTabEvents.bind(this),!0),this.window.addEventListener("blur",this._handleTabEvents.bind(this),!0),this._shouldUsePageEventsForTabStatus()&&(this.window.addEventListener("pageshow",this._handleTabEvents.bind(this),!0),this.window.addEventListener("pagehide",this._handleTabEvents.bind(this),!0))}},{key:"_shouldUsePageEventsForTabStatus",value:function(){return this.conf.usePageEventsForTabStatus&&!0===this.conf.isMobile}},{key:"_handleResizeEvent",value:function(t){var e=this.$window.height(),i=e-this.windowHeight;this.windowHeight=e;var n=this.$window.width(),r=n-this.windowWidth;this.windowWidth=n,this._trigger("window:resize:change",{heightChange:i,widthChange:r})}},{key:"_handleVisibilityChange",value:function(t){this.isTabOut="hidden"===document.visibilityState,this._handleTabEvents(t)}},{key:"_handleTabEvents",value:function(t){this._trigger("window:tab:change",this._getTabState(t.type))}},{key:"_getTabState",value:function(t){return this.isTabOut?e().TAB_STATE.tabOut:"focus"===t||"pageshow"===t?e().TAB_STATE.focus:e().TAB_STATE.blur}},{key:"_trigger",value:function(t,e){w().trigger(t,e)}},{key:"_setTaboolaReadMoreListener",value:function(){window._taboola=window._taboola||[],_taboola.push({listenTo:"readmore.click",handler:function(){w()&&w().trigger("taboola:readmore:click")}})}},{key:"setScrollableSelector",value:function(t){this.scrollSelector="document"===t?document:Ds.isEmpty(t)?this.window:(0,_.default)(t)[0]}}])&&Rs(i.prototype,n),r&&Rs(i,r),Object.defineProperty(i,"prototype",{writable:!1}),t}(),Ns=function(){var t;return function(e,i,n){return t||(t=new Vs(e,i,n)),t}}(),xs=Ns,js=i(2707),Ms=i.n(js);function Ls(t){return Ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(t)}function Bs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Ls(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Ls(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Ls(o)?o:String(o)),n)}var r,o}var Fs=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),window.cmTag.autoPlayDetectorInstance?(window.cmTag.autoPlayDetectorInstance.callbacks.push(e),window.cmTag.autoPlayDetectorInstance.safelyRunCallbacks()):(this.isMobile=i.isMobile,this.src=i.src,this.timeout=i.timeout||250,this.autoPlaySupport={unmuted:!1},this.unmutedVideo=this.creatVideo(),this.callbacks=[e],this.testVideo(this.unmutedVideo),window.cmTag.autoPlayDetectorInstance=this),window.cmTag.autoPlayDetectorInstance}var e,i,n;return e=t,(i=[{key:"creatVideo",value:function(){var t=document.createElement("video");return t.tbData={isMuted:!1},this.setVideoAttributes(t),this.setVideoStyle(t),this.isMobile&&document.body.appendChild(t),t}},{key:"setVideoAttributes",value:function(t){t.src=this.src,t.type="video/mp4",t.setAttribute("playsinline",!0)}},{key:"setVideoStyle",value:function(t){t.style.left="0",t.style.top="0",t.style.height="0px",t.style.width="0px",t.style.position="absolute",t.style.display="none"}},{key:"testVideo",value:function(t){var e=this;t.tbData.timeupdateHandler=this.handleSupported.bind(this,t),t.addEventListener("timeupdate",t.tbData.timeupdateHandler),t.tbData.timeout=setTimeout(this.handleNotSupported.bind(this,t,"no promise - timeout"),this.timeout);var i=t.tbData.promise=t.play();void 0===i||t.tbData.isResolved||i.then((function(){e.handleSupported(t)})).catch((function(i){e.handleNotSupported(t,i.message)}))}},{key:"handleSupported",value:function(t){t.tbData.isResolved||(t.tbData.isMuted===t.muted?(this.handleResolved(t),this.autoPlaySupport.unmuted={supported:!0},this.safelyRunCallbacks()):this.handleNotSupported(t,"Muted by browser"))}},{key:"handleNotSupported",value:function(t,e){t.tbData.isResolved||(this.handleResolved(t),this.autoPlaySupport.unmuted={supported:!1,error:e},this.safelyRunCallbacks())}},{key:"handleResolved",value:function(t){t.tbData.isResolved=!0,this.removeTimeupdateEventListener(t),clearTimeout(t.tbData.timeout)}},{key:"removeTimeupdateEventListener",value:function(t){t.removeEventListener("timeupdate",t.tbData.timeupdateHandler),t.tbData.timeupdateHandler=void 0,delete t.tbData.timeupdateHandler}},{key:"safelyRunCallbacks",value:function(){var t=this;this.supportIsKnown()&&(this.callbacks.map((function(e){e(t.autoPlaySupport)})),this.callbacks=[])}},{key:"supportIsKnown",value:function(){return this.autoPlaySupport.unmuted}}])&&Bs(e.prototype,i),n&&Bs(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();i(2782);function Us(t){return Us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(t)}function Ws(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Us(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Us(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Us(o)?o:String(o)),n)}var r,o}var Hs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.logsMap=[],this.elasticLogger=e.model.get("elasticLogger")}var e,i,n;return e=t,(i=[{key:"log",value:function(t,e){try{if(!this.elasticLogger.isSendingDataToElastic())return;this.logsMap.includes(t)||(this.logsMap.push(t),this.elasticLogger.log({message:"usage:unit:"+t,severity:mn,extraData:e}))}catch(t){}}}])&&Ws(e.prototype,i),n&&Ws(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),$s=i(7904),zs=(i(9861),i(1999)),qs=i(9288),Gs=i(9245),Ys=i(9791);function Ks(t,i,n){var o,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=!1;$s.beforeCMTag(t);var l={unit:void 0,model:void 0,placement:void 0,isUnitPlay:!1},c=new r.Z({unitType:t.unitType,className:"cmTagMainBase",version:t.version,isDebug:t.isDebug});function u(){o=function(n,r){zs.trcPerformanceMeasurement(r.trcPerformanceMeasurementEnabled,"videoCreateUnitModel".concat(r.perfUnitType),e().TRC_PERFORMANCE_ACTIONS.START);var o=new qs.DeepModel;o.set(r),i&&i._settings&&(c.info("settings by FPP",i._settings),o.set(i._settings));!function(t){if(t.onPassback)return void(t.isApiPassbackExist=!0);if(TRC&&TRC._taboolaClone)for(var e=0;e<TRC._taboolaClone.length;e++)if("video.passback"==TRC._taboolaClone[e].listenTo)return void(t.isApiPassbackExist=!0);t.isApiPassbackExist=!1}(o.attributes);var s=new n(o.attributes);new Gs(s);if(zs.parseBool(t.isUseCMP))new Ao(s);else s.set("canStartPlayer",!0);return function(t){var e=new pn({model:t});t.set("elasticLogger",e,{},!1)}(s),function(t){var e=new Hs({model:t});t.set("codeUsageLogger",e,{},!1)}(s),function(t){var e={model:t};zi().oppsula=new is(e)}(s),function(t){if(!t.get("isVideoAutoplayDetectorEnabled"))return;zi().autoPlayDetector=new Fs(t.handleAutoPlayData.bind(t),{isMobile:t.get("isMobile"),timeout:1e3*t.get("autoplayDetectorTimeoutSec"),src:t.get("player.urls.blankLocation").replace(/{{(.+?)}}/g,(function(e,i){return t.get(i)}))})}(s),zs.trcPerformanceMeasurement(r.trcPerformanceMeasurementEnabled,"videoCreateUnitModel".concat(r.perfUnitType),e().TRC_PERFORMANCE_ACTIONS.STOP),s}(n.model,t),zs.defer(d.bind(this,n.unitController,o,void 0,s))}function d(e,i,n,r){zs.parseBool(t.isWaitForStartEvent)?(l.unit=e,l.model=i,l.placement=n,l.isUnitPlay=r,i.fireUnitDelayedPixel(),window.TRC=window.TRC||{},window.TRCImpl=window.TRCImpl||{},window.TRC.videoFunctions={},window.TRC.videoFunctions.startEvent=function(){a||(l.model.fireUnitLoadAfterDelayPixel(),h(l.unit,l.model,l.placement,l.isUnitPlay),a=!0)}):h(e,i,n,r)}function h(t,e,n,r){var o=new t({model:e,placementElement:n});r&&(i.play=o.play.bind(o))}function f(){window.TRC=window.TRC||{},qs.$=_.default,zs.templateSettings={interpolate:/\{\{(.+?)\}\}/g},t.documentReadyState=document.readyState,c.info("init",t),cmTag.utils=zs,cmTag.$=_.default,i&&(i._events&&(i._events.forEach((function(t){qs.on(t.name,t.cb)})),i.on=function(t,e){qs.on(t,e)}),i.trigger=function(t,e){qs.trigger(t,e)}),cmTag.config||(cmTag.config=t);var e=window;zs.isInFriendlyIframe(cmTag.config.iframeData)&&(e=zs.getTopWindow()),t.isHideIframe&&zs.hideDFPIframe(t.iframeData),cmTag.config.scrollSelector?(new xs(e,t,cmTag.config.scrollSelector),new I(t,e,cmTag.config.scrollSelector)):(new xs(e,t),new I(t,e)),zs.setConfig(t),function(){zs.defer(p.bind(this))}()}function p(){c.info("PMS Loaded"),zi().pms=new(Ms()),function(){var i,n;if(t.perfUnitType=(i=t.unitType,n=i.replace(/_/g,"").toLowerCase(),"".concat(n.charAt(0).toUpperCase()).concat(n.substring(1))),zs.trcPerformanceMeasurement(t.trcPerformanceMeasurementEnabled,"videoInitToRender".concat(t.perfUnitType),e().TRC_PERFORMANCE_ACTIONS.START),t.unitName=t.cm_unitName?t.cm_unitName:t.unitType,t.urlPrefix){var r=t.urlPrefix.split("/");t.unitVersion=r[r.length-2],t.unitVersion=t.unitVersion.replace(/_/g,"")}else t.unitVersion=t.version.replace(/_/g,"");u(),o.get("multiUnitManager.isActive")&&Ys.addUnit(o.get("redId"),o),o.get("cookieMatchActive")&&new Hi(o)}(),cmTag.units=cmTag.units||{},cmTag.units[zs.now()]=t}zs.parseBool(t.isStartUnitOnWindowLoaded)?("complete"===document.readyState&&f(),document.onreadystatechange=function(){"complete"===document.readyState&&setTimeout(f,0)}):(0,_.default)("document").ready(f)}function Qs(t){return Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(t)}function Zs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Qs(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Qs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Qs(o)?o:String(o)),n)}var r,o}function Xs(t,e){return Xs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xs(t,e)}function Js(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ea(t);if(e){var r=ea(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Qs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ta(t)}(this,i)}}function ta(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ea(t){return ea=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ea(t)}var ia=i(1999),na=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xs(t,e)}(s,t);var e,i,n,o=Js(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).model=t.model,e.model.get("msnWebComponentsEnabled")||e.model.set("height",ia.getVideoHeight(e.model.get("width"))),e.log=new r.Z({unitType:e.model.get("unitType"),className:e.constructor.name||"UnitController",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.containerView=void 0,e.videoView=void 0,e.adService=void 0,e.playerService=void 0,e.isClosedByUser=!1,e.createStateHandlers([{event:"closeState",funcName:"handleCloseState"},{event:"topParentSelectorLost:true",funcName:"_onParentSelectorLost"}]),e.model.listenTo(e.model,"ad:stoppedByUser",e.terminate.bind(ta(e),!0)),e.model.get("placementOffsetValidation.isActive")&&e.createStateHandlers([{event:"isEligibleToPlay:false",funcName:"_checkPlacementPositionChange"}]),"undefined"!=typeof TRC&&TRC.listen&&TRC.listen("trcReset",e._onTRCReset.bind(ta(e))),e._createTimers(),e._handleMidArticleReadMore(),e}return e=s,(i=[{key:"_createTimers",value:function(){if(this.model.get("isMultiAd")&&this.model.get("midrollTimeout")>0){var t={startCondition:{stateToListen:ut().adManagerState.empty,state:"adManagerState"},stopCondition:{stateToListen:ut().adManagerState.hasAds,state:"adManagerState"}};this.getAdTimer=new Wn(this.model,t,this.terminate.bind(this,!1,"midrollCollapse"),1e3*this.model.get("midrollTimeout"))}else if(this.model.get("isMultiAd")&&this.model.get("secondsToCloseFeed")>0){var e={startCondition:{stateToListen:ut().adManagerState.empty,state:"adManagerState"},stopCondition:{stateToListen:ut().adManagerState.hasAds,state:"adManagerState"}};this.getAdTimer=new Wn(this.model,e,this.pause.bind(this,"midrollCollapse"),1e3*this.model.get("secondsToCloseFeed"))}var i=this.model.get("secondsToClose");if(i>0){var n={startCondition:{stateToListen:!0,state:"firstGetAdFired"},stopCondition:{stateToListen:ut().adQState.impression,state:"adQState"},isStartOnce:!0};this.secondsToCloseTimer=new Wn(this.model,n,this.terminate.bind(this,!1,"secondsToClose"),1e3*i)}var r=this.model.get("secondsToCloseGlobal");if(r>0){var o={startCondition:{stateToListen:"",state:""}};"showReplay"===this.model.get("onTimerClose")?this.secondsToCloseGlobalTimer=new Wn(this.model,o,this.pause.bind(this,"secondsToCloseGlobal"),1e3*this.model.get("secondsToCloseGlobal")):this.secondsToCloseGlobalTimer=new Wn(this.model,o,this.terminate.bind(this,!1,"secondsToCloseGlobal"),1e3*r),this.secondsToCloseGlobalTimer.start(this.model,"")}this._createSecondsToPassbackTimer()}},{key:"terminate",value:function(t,e){this.log.info("Terminate reason: "+e),this.isClosedByUser=t,this._setTimerReason(e),this.model.set("closeState",ut().closeState.terminate)}},{key:"_setTimerReason",value:function(t){this.model.set("closeTimer",t)}},{key:"handleCloseState",value:function(t,e){switch(this.log.info("handleCloseState",e),w().trigger("global:closeState:changed"),e){case ut().closeState.terminate:this.containerView?this.containerView.close(this.isClosedByUser):this.model.set("closeState",ut().closeState.containerViewClosed);break;case ut().closeState.containerViewClosed:this.nativeAdView&&this.nativeAdView.hide(),this.videoView?this.videoView.close(this.isClosedByUser):this.model.set("closeState",ut().closeState.videoViewClosed);break;case ut().closeState.videoViewClosed:this.adService?this.adService.close():this.model.set("closeState",ut().closeState.adManagerStop);break;case ut().closeState.adManagerStop:this.playerService&&(this.playerService.close(),this._stopListening())}}},{key:"_stopListening",value:function(){this.model.off(),w().off()}},{key:"pause",value:function(t){this._setTimerReason(t),this.adService&&this.adService.pauseGetAds()}},{key:"_onParentSelectorLost",value:function(){this.overKill("parentSelectorLost")}},{key:"_onTRCReset",value:function(){this.overKill("TRCReset"),this._resetFmOnPage()}},{key:"_resetFmOnPage",value:function(){setTimeout(function(){this.model.off(),window.isCmTagFMOnPage=!1}.bind(this),500)}},{key:"overKill",value:function(t){this.log.info("overKill reason: "+t),this.adService&&this.adService.pauseGetAds(),this.adsManager&&(this.adsManager.pauseGetAds(),this.adsManager.close()),this.playerService.playerDiv&&this.playerService.playerDiv.hide(),this.containerView&&this.containerView.$el&&this.containerView&&this.containerView.$el.hide();var e=(0,_.default)("._cm-video");e&&e.hide(),this.secondsToCloseGlobalTimer&&this.secondsToCloseGlobalTimer.stop(this.model,"",{},!0),this.model.set("closeState",ut().closeState.terminate),this._setTimerReason(t)}},{key:"_createSecondsToPassbackTimer",value:function(){this.model.get("secondsToPassback")&&(this.passBackTimer=new Wn(this.model,{startCondition:{stateToListen:"",state:""},stopCondition:{stateToListen:!0,state:"isFirstAdLoaded"}},this._triggerPassback.bind(this,"Passback"),1e3*this.model.get("secondsToPassback")),this.passBackTimer.start(this.model,""))}},{key:"_triggerPassback",value:function(){this.model.get("isFirstAdLoaded")||(this.log.info("Passback timer done"),w().trigger("global:passback",{isApiPassbackExist:this.model.get("isApiPassbackExist")}),this.model.set("closeState",ut().closeState.terminate))}},{key:"_handleMidArticleReadMore",value:function(){ia.isReadMoreObserverNeededOnPage(this.model.get("readMoreObserver.isActive"),this.model.get("isHip"))&&(this.readMoreObserver=new ks({model:this.model}))}},{key:"_checkPlacementPositionChange",value:function(){if(!this.model.get("isEligibleToPlay")&&!this.placementOffsetValidationChecked&&this.model.get("placementOffsetValidation.isActive")&&this.model.get("eligibleContainerOffset")){this.placementOffsetValidationChecked=!0;var t=this.model.get("eligibleContainerOffset"),e=t.left,i=t.top,n=t.el,r=ia.getOffsetWithContainer(n,this.model.get("offsetGetterType"),this.model.get("videoContainerSelector"));if(r&&(r.top!==i||r.left!==e)){var o={debug:"!url:"+(window&&window.location&&window.location.href?window.location.href:""),yOffset:r.top-i,xOffset:r.left-e};ia.firePixel(this.model.getPixel("pixels.placementPushedOutOfViewport"),"placement position changed to Out Of Viewport",o)}}}}])&&Zs(e.prototype,i),n&&Zs(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(n.O),ra=na;function oa(t){return oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oa(t)}function sa(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==oa(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==oa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===oa(o)?o:String(o)),n)}var r,o}function aa(t,e){return aa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},aa(t,e)}function la(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ca(t);if(e){var r=ca(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===oa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function ca(t){return ca=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ca(t)}var ua=i(1999),da={title:"._cm-ad-title",placeholder:"._cm-inline-video"},ha=0,fa=1,pa=2,ma=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aa(t,e)}(a,t);var i,n,o,s=la(a);function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),s.apply(this,arguments)}return i=a,(n=[{key:"initialize",value:function(t){this.log=new r.Z({unitType:this.model.get("unitType"),className:"FeedContainerView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.template='<div class="_cm-ad-title"></div> <div class="_cm-inline-video"></div> ',this.animationCss={transition:"all 200ms ease-in-out"},this.noAnimationCss={transition:"none"},"WIDGET_ITEM"===this.model.get("unitType")&&this.$el.attr("class","_cm-widget-item"),this.model.get("isFitToSize")?(this.isFitToSize=!0,this.placeholderSizeType=ha,this.$el.addClass("_cm-fit-to-size")):"WIDGET_ITEM"===this.model.get("unitType")?this.placeholderSizeType=pa:this.placeholderSizeType=fa,this.model.set("containerViewState",ct.readyState),this.createStateHandlers([{event:"videoViewState:detached",funcName:"_detachCss"},{event:"videoViewState:attached",funcName:"_attachCss"}])}},{key:"_bindWindowEvents",value:function(){this.isFitToSize?(this.listenTo(w(),"window:orientation:change",this.terminate.bind(this)),this.listenTo(w(),"window:resize:change",this.terminate.bind(this,!0))):(this.listenTo(w(),"window:orientation:change",this._orientationChange.bind(this)),this.listenTo(w(),"window:resize:change",this._onPlaceHolderDomChange.bind(this))),this.listenTo(w(),"window:scroll:change",this._onPlaceHolderDomChange.bind(this,!1)),this.listenTo(w(),"taboola:readmore:click",this._onPlaceHolderDomChange.bind(this,!0)),this.listenTo(w(),"publisher:dom:change",this._onPlaceHolderDomChange.bind(this,!0)),this.bindLoaderEvens()}},{key:"bindLoaderEvens",value:function(){this.model.get("isStartWithLoader")&&this.createStateHandlers([{event:"progressLoaderTimerReached:true",funcName:"onLoaderEnded",isListenOnce:!0}])}},{key:"render",value:function(t){this.container=t,this.$container=(0,_.default)(this.container),this.renderTemplate(),this._customize(),this.el.id="_cm-video-unit",(0,_.default)(t).append(this.el),this._onPlaceHolderDomChange(),this.model.set("containerViewPlaceHolder",this.ui.placeholder[0]),this._bindWindowEvents(),this.model.set("containerViewState",ct.containerViewState.rendered),ua.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoInitToRender".concat(this.model.get("perfUnitType")),e().TRC_PERFORMANCE_ACTIONS.STOP)}},{key:"terminate",value:function(t,e){t&&Math.abs(e.heightChange)<this.model.get("allowedHeightChange")&&0===e.widthChange||(this.model.set("isTerminateOnResize",!0),this.stopListening(w(),"window:scroll:change"),this.model.set("closeState",ct.closeState.terminate))}},{key:"hide",value:function(){this.$el.hide()}},{key:"show",value:function(){this.$el.show(),this._onPlaceHolderDomChange()}},{key:"close",value:function(){"WIDGET_ITEM"===this.model.get("unitType")?(this._runAnimation(!1,this.hide.bind(this)),this.model.set("closeState",ct.closeState.containerViewClosed)):setTimeout(function(){this.model.set("closeState",ct.closeState.containerViewClosed)}.bind(this),1500)}},{key:"_customize",value:function(){var t=this.model.get("customization.unitContainer");if(this.model.get("isCoverWidgetHorizontal")){var e=this.container.parentElement.clientWidth;t.width=e+"px"}if(this.model.get("isCoverWidgetVertical")){for(var i=0,n=(0,_.default)(".trc_rbox_outer"),r=0;r<n.length;r++)if((0,_.default)(this.container,n[r]).length>0){i=n[r].clientHeight;break}t.height=i+"px"}var o=this.model.get("customization.placeHolder"),s=this.model.get("customization.adTitle");switch(this.placeholderSizeType){case ha:this._customizeFitToSize();break;case fa:this._customizeFeed();break;case pa:this._customizeWidget()}this.$el.css(ua.toCssObj(t)),this.ui.title.css(ua.toCssObj(s)),this.ui.placeholder.css(ua.toCssObj(o))}},{key:"_customizeFitToSize",value:function(){this._updateBrandingStyle(),this.ui.title.css("display","none")}},{key:"_minimizeCard",value:function(){this.log.info("_minimizeCard");var t=(0,_.default)("._cm-inline-video",this.$el).height()+this._getElementHeight((0,_.default)("._cm-branding-title",this.$el))+"px";this.$el.css({height:t}),this.$el.css(this.animationCss),this.bottomCard=(0,_.default)(this.$el.parent()).next(),this.cardOriginalheight=this.bottomCard.height(),this.bottomCard.css({height:this.cardOriginalheight}),this.bottomCard.css(this.animationCss),this.bottomCard.css({height:t}),setTimeout(function(){this.bottomCard.css(this.noAnimationCss)}.bind(this),200)}},{key:"_getElementHeight",value:function(t){return t.height()+(Number(t.css("margin-top").replace("px",""))+Number(t.css("margin-bottom").replace("px","")))+(Number(t.css("padding-top").replace("px",""))+Number(t.css("padding-bottom").replace("px","")))}},{key:"_restoreBottomCard",value:function(){this.bottomCard.css({height:this.cardOriginalheight}),setTimeout(function(){this.bottomCard.css(this.noAnimationCss),this.bottomCard.css({height:"auto"})}.bind(this),200)}},{key:"_customizeWidget",value:function(){this.ui.title.css("display","none"),this.$el.height("auto")}},{key:"_customizeFeed",value:function(){this.ui.title.text(this.model.get("unitTitle"))}},{key:"_onPlaceHolderDomChange",value:function(){this._calcPlaceholderSize(),this._calcPlaceholderPosition()}},{key:"_calcPlaceholderSize",value:function(){switch(this.placeholderSizeType){case ha:this._calcPlaceholderSizeFitToSize();break;case fa:this._calcPlaceholderSizeFeed();break;case pa:this._calcPlaceholderSizeWidgetItem()}}},{key:"_calcPlaceholderSizeFitToSize",value:function(){this.isAnimated||(this._runAnimation(!0,w().trigger.bind(w(),"renderAnimation:completed")),this.isAnimated=!0);var t=this.$container.width(),e=this.$container.height(),i=ua.getVideoBestSize(t,e);this.model.set("videoPlaceholderSize",i),this.ui.placeholder.css(i),this.model.set("width",i.width),this.model.set("height",i.height),this.model.trigger("change:videoPlaceholderSize",this.model,this.model.get("videoPlaceholderSize"))}},{key:"_isMinimizeCardAvailable",value:function(t){this.model.get("isMinimizeCardOnMobile")&&this.model.get("isMobile")&&(t?setTimeout(function(){this._minimizeCard()}.bind(this),0):setTimeout(function(){this._restoreBottomCard()}.bind(this),0))}},{key:"_runAnimation",value:function(t,e){ua.oneAnimationEnd(this.$el,function(){this.$el.removeClass("animated"),this.$el.removeClass("slideInTop"),this.$el.removeClass("flip"),this.$el.removeClass("slideInLeft"),this.$el.removeClass("fadeIn"),this.$el.removeClass("zoomIn"),this.$el.removeClass("slideOutTop"),this.$el.removeClass("flipOut"),this.$el.removeClass("slideOutLeft"),this.$el.removeClass("fadeOut"),this.$el.removeClass("zoomOut"),e&&(e(),this._isMinimizeCardAvailable(t))}.bind(this));var i=this.model.get("openingEffect");t?0==i||(1==i?this.$el.addClass("slideInTop"):2==i?this.$el.addClass("flip"):3==i?this.$el.addClass("slideInLeft"):4==i?this.$el.addClass("fadeIn"):5==i&&this.$el.addClass("zoomIn")):0==i?this.hide():1==i?this.$el.addClass("slideOutTop"):2==i?this.$el.addClass("flipOut"):3==i?this.$el.addClass("slideOutLeft"):4==i?this.$el.addClass("fadeOut"):5==i&&this.$el.addClass("zoomOut"),0!=i&&this.$el.addClass("animated")}},{key:"_calcPlaceholderSizeWidgetItem",value:function(){this.ui.placeholder.height(ua.getVideoHeight(this.ui.placeholder.width()));var t=this.ui.placeholder.width(),e=this.ui.placeholder.height();this.model.set("videoPlaceholderSize",{width:t,height:e}),this.model.set("width",t),this.model.set("height",e),this.model.trigger("change:videoPlaceholderSize",this.model,this.model.get("videoPlaceholderSize"))}},{key:"_calcPlaceholderSizeFeed",value:function(){var t=this.ui.placeholder.width(),e=ua.getVideoHeight(t);this.model.set("width",t),this.model.set("height",e),this.$el.css({height:e+this.ui.title.height(),width:t}),this.model.set("videoPlaceholderSize",{width:t,height:e}),this.model.get("videoViewState")!==ct.videoViewState.detached&&this.model.trigger("change:videoPlaceholderSize",this.model,this.model.get("videoPlaceholderSize"))}},{key:"_calcPlaceholderPosition",value:function(){var t=ua.getOffsetWithContainer(this.model.get("parentPlaceholderSelector")||this.ui.placeholder,this.model.get("offsetGetterType"),this.model.get("videoContainerSelector"));this.model.set("videoPlaceholderPosition",{top:t.top,left:t.left}),this.model.trigger("change:model, positionObj",this.model,this.model.get("videoPlaceholderPosition"))}},{key:"_orientationChange",value:function(){if(this.placeholderSizeType===pa){var t=document.querySelector(".videoCube");this.model.set("customization.placeHolder",ua.cssObjToString(getComputedStyle(t)));var e=t.querySelector(".thumbBlock_holder");this.model.set("customization.unitContainer",ua.cssObjToString(getComputedStyle(e))),this._updateBrandingStyle(),this.$el.height("auto")}this._onPlaceHolderDomChange()}},{key:"_updateBrandingStyle",value:function(){if(this.container.parentElement){var t=this.container.parentElement.querySelector(".videoCube"),e=t.querySelector(this.model.get("widgetTitleSelector"));e&&this.model.set("customization.titleContainer.title",ua.cssObjToString(getComputedStyle(e)));var i=t.querySelector(this.model.get("brandingTitleSelector"));i&&this.model.set("customization.titleContainer.branding",ua.cssObjToString(getComputedStyle(i)))}}},{key:"hideUnit",value:function(){this._runAnimation(!1,this._isHideOnMidroll.bind(this)),this.model.set("isAnimationRunning",!0)}},{key:"_isHideOnMidroll",value:function(){this.hide(),this.model.set("isAnimationRunning",!1)}},{key:"onLoaderEnded",value:function(){this.hideUnit(),this.createStateHandlers([{event:"hasReadyAd:true",funcName:"show",isListenOnce:!0}])}},{key:"className",get:function(){return"_cm-inline"}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=da},set:function(t){return this.UI=t}},{key:"_detachCss",value:function(){this.$el.addClass("widget-detached"),this.$el.parent().addClass("widget-detached-figure")}},{key:"_attachCss",value:function(){this.$el.removeClass("widget-detached"),this.$el.parent().removeClass("widget-detached-figure")}}])&&sa(i.prototype,n),o&&sa(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.s),ya=ma,ga=i(1231),va=i(9288),ba=(i(1999),va.View.extend({className:"_cm-disc-text",id:"_cm-css-reset",initialize:function(t){this.log=new r.Z({unitType:t.unitType,className:"disclosureTextView",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),this.disclosureText='<div class="title text opt-out-hidden">{text}</div> ',this.container=t.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=ga.L},render:function(){this._rendered||(this._rendered=!0,this.container.appendChild(this.el),"detached"===this.model.get("videoViewState")?this.model.get("detachToSlider.components.disclosureText.isActive")?this.show():this.hide():this.model.get("components.disclosureText.isActive")?this.show():this.hide())},_bindEvents:function(){(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onVideoViewStateChange:function(t,e){switch(e){case"detached":0==this.model.get("detachToSlider.components.disclosureText.isActive")?this.hide():this.show();break;case"attached":this.model.get("components.disclosureText.isActive")?this.show():this.hide()}},hide:function(){this.$el.hide()},show:function(){var t="detached"===this.model.get("videoViewState")?this.model.get("detachToSlider.components.disclosureText.text"):this.model.get("components.disclosureText.text");this.$el[0].innerHTML="",this.$el.append(this.disclosureText.replace("{text}",t)),this.$el.show()}}));function _a(t){return _a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_a(t)}function Sa(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==_a(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==_a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===_a(o)?o:String(o)),n)}var r,o}var wa=i(1999),Ta=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.model=e,this.log=new r.Z({unitType:this.model.get("unitType"),className:this.constructor.name,version:this.model.get("version"),isDebug:this.model.get("isDebug")})}var e,i,n;return e=t,(i=[{key:"setReportingObserver",value:function(t){if(!this.reportingObserver&&wa.isObserverSupported("ReportingObserver")){var e={types:this.model.get("reportingObserver.types"),buffered:!0};this.reportingObserver=new ReportingObserver(t.bind(this),e),this.reportingObserver.observe(),this._bindUnloadEvents(t)}}},{key:"_bindUnloadEvents",value:function(t){var e=this;window.addEventListener("unload",(function(i){var n=e.reportingObserver.takeRecords();t(n)}))}}])&&Sa(e.prototype,i),n&&Sa(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Pa=function(){var t;return function(e){return t||(t=new Ta(e)),t}}(),Aa=Pa;function Ea(t){return Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ea(t)}function Oa(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Ea(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Ea(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Ea(o)?o:String(o)),n)}var r,o}function Ca(t,e){return Ca=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ca(t,e)}function ka(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ia(t);if(e){var r=Ia(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Ea(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Ia(t){return Ia=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ia(t)}var Ra=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ca(t,e)}(o,t);var e,i,n,r=ka(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,t)}return e=o,(i=[{key:"_initViewabilityHandler",value:function(){this._bindPlay()}},{key:"_bindPlay",value:function(){this.model.get("adState")!==ct.adState.playing?this.createStateHandlers([{event:"adState:".concat(ct.adState.playing),funcName:"_startTestingViewability",isListenOnce:!0}]):this._startTestingViewability()}},{key:"_startTestingViewability",value:function(){this._updateViewabilityTimes(),this._checkViewability(),this._bindPause()}},{key:"_bindPause",value:function(){this.model.get("adState")!==ct.adState.paused?this.createStateHandlers([{event:"adState:".concat(ct.adState.paused),funcName:"_stopAllViewability",isListenOnce:!0}]):this._stopAllViewability()}},{key:"_stopAllViewability",value:function(){this._bindPlay()}}])&&Oa(e.prototype,i),n&&Oa(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Ss);function Da(t){return Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Da(t)}function Va(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Da(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Da(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Da(o)?o:String(o)),n)}var r,o}function Na(t,e){return Na=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Na(t,e)}function xa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ja(t);if(e){var r=ja(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Da(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function ja(t){return ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ja(t)}var Ma=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Na(t,e)}(s,e);var i,n,r,o=xa(s);function s(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),o.call(this,t)}return i=s,(n=[{key:"_initViewabilityHandler",value:function(){this._startViewabilityTimers()}},{key:"_startViewabilityTimers",value:function(){this.model.get("isViewableByOb")?this._startViewabilityTime():this.createStateHandlers([{event:["isViewableByOb:true","isInTab:true"],funcName:"_startViewabilityTime"},{event:"isViewableByOb:false",funcName:"_clearViewabilityTime"}]),this.model.get("isViewableByOb100")&&this._startViewability100Time(),this.createStateHandlers([{event:["isViewableByOb100:true","isInTab:true"],funcName:"_startViewability100Time"},{event:"isViewable100:false",funcName:"_clearViewability100"},{event:"adState:".concat(ct.adState.paused),funcName:"clearAllViewabilityTimers",isListenOnce:!0},{event:"isInTab:false",funcName:"_clearViewabilityTime"}])}},{key:"_startViewabilityTime",value:function(){this.activeAd&&!this.activeAd.isViewed&&(this._startViewabilityTimer(t.TIMER_NAMES.viewability,this._onViewability.bind(this),this.traceViewabilitySeconds),this._startViewabilityTimer(t.TIMER_NAMES.viewabilityOneS,this._onViewabilityOneS.bind(this),1))}},{key:"_startViewabilityTimer",value:function(t,e,i){this.timers[t]||(this.timers[t]=setTimeout(e,1e3*i))}},{key:"_onViewability",value:function(){this.timers[t.TIMER_NAMES.viewability]=void 0,this.activeAd.onViewability()}},{key:"_startViewability100Time",value:function(){this.activeAd&&!this.activeAd.isViewed&&this._startViewabilityTimer(t.TIMER_NAMES.viewability100,this._onViewability100.bind(this),this.traceViewability100Seconds)}},{key:"_startViewabilityAMPTime",value:function(){this.activeAd&&!this.activeAd.isViewed&&this._startViewabilityTimer(t.TIMER_NAMES.viewabilityAMP,this._onViewabilityAMP.bind(this),this.traceViewabilitySeconds)}},{key:"clearAllViewabilityTimers",value:function(){this._clearViewabilityTime(),this._clearViewability100()}},{key:"_clearViewabilityTime",value:function(){this._clearViewabilityTimer(t.TIMER_NAMES.viewability),this._clearViewabilityTimer(t.TIMER_NAMES.viewabilityOneS)}},{key:"_clearViewability100",value:function(){this._clearViewabilityTimer(t.TIMER_NAMES.viewability100)}},{key:"_clearViewabilityAMP",value:function(){this._clearViewabilityTimer(t.TIMER_NAMES.viewabilityAMP)}},{key:"_clearViewabilityTimer",value:function(t){this.timers[t]&&(clearTimeout(this.timers[t]),this.timers[t]=void 0)}},{key:"_onViewabilityOneS",value:function(){this.timers[t.TIMER_NAMES.viewabilityOneS]=void 0,this.activeAd.onViewabilityOneS()}},{key:"_onViewability100",value:function(){this.timers[t.TIMER_NAMES.viewability100]=void 0,this.activeAd.onViewability100()}},{key:"_onViewabilityAMP",value:function(){this.timers[t.TIMER_NAMES.viewabilityAMP]=void 0,this.activeAd.onViewability()}}])&&Va(i.prototype,n),r&&Va(i,r),Object.defineProperty(i,"prototype",{writable:!1}),s}(Ss);function La(t){return La="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},La(t)}function Ba(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==La(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==La(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===La(o)?o:String(o)),n)}var r,o}var Fa=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cache={}}var e,i,n;return e=t,i=[{key:"getViewabilityService",value:function(t){var e=t.model,i=t.ad,n=t.onViewabilityCallback,r=i.supportVideoCurrentTimeEvents&&e.get("isUseNewViewabilityCalc")?Ra:Ma,o=this.cache[r];return o||(this.cache[r]=o=new r({model:e,onViewability:n})),o}}],i&&Ba(e.prototype,i),n&&Ba(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ua(t){return Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ua(t)}function Wa(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Ua(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Ua(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Ua(o)?o:String(o)),n)}var r,o}function Ha(t,e){return Ha=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ha(t,e)}function $a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=za(t);if(e){var r=za(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Ua(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function za(t){return za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},za(t)}var qa=i(1999),Ga=qa.now().toString(),Ya=function(){this.activeAd&&(this.activeAd.unmute(),this.currModel.set("volumeMuted",!1))},Ka=function(){this.activeAd&&(this.activeAd.mute(),this.currModel.set("volumeMuted",!0))},Qa={video:"._cm-video-ad"},Za=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ha(t,e)}(a,t);var i,n,o,s=$a(a);function a(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"VideoView",n=arguments.length>2?arguments[2]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t)).eligibilityService=t.eligibilityService||{},e.log=new r.Z({unitType:e.model.get("unitType"),className:i,version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.model.set("videoAdId",e.videoAdId),e.ad=t.adjs,e.currModel=n||e.model,e._setVolumeAnimationTrigger(),e._bindEvents(),e._bindBlockedByExternalUnitChange(),e._initPerformanceMonitor(),e._viewabilitySerivcesFactory=new Fa,e}return i=a,(n=[{key:"_bindEvents",value:function(){}},{key:"_initPerformanceMonitor",value:function(){this.currModel.get("reportingObserver.isActive")&&(this.performanceMonitor=new Aa(this.currModel),this.performanceMonitor.setReportingObserver(this.reportingObserverCB.bind(this)))}},{key:"reportingObserverCB",value:function(t){var e=this,i=this.currModel.get("reportingObserver.ids");i&&i.length>0&&(t=qa.filter(t,(function(t){return t.body&&t.body.id&&qa.contains(i,t.body.id)}))),this.activeAd?qa.forEach(t,(function(t){e._setReportingObserverAdData(t),e.activeAd.oppsService.fireBeaconOpp("reportingObserver")})):this.model.get("pixels.reportingObserver.isFire")&&this._fireReportObserverPixel(t)}},{key:"_setReportingObserverAdData",value:function(t){this.activeAd.adData.rot=t.type,this.activeAd.adData.roid=t.body&&t.body.id,this.activeAd.adData.rom=t.body&&t.body.message}},{key:"_fireReportObserverPixel",value:function(t){var e=this;qa.forEach(t,(function(t){var i={debug:"rot:".concat(t.type,"!roid:").concat(t.body.id,"!rom:").concat(t.body.message,"!")},n=e.model.getPixel("pixels.reportingObserver"),r=qa.addParametersToUrl(n,i,-1===n.indexOf("?"));qa.isSendBeaconSupported()&&navigator.sendBeacon(r)}))}},{key:"_setVolumeEvents",value:function(){this.currModel.on("change:volumeMuted",this._handleVolume.bind(this)),this.currModel.get("autoplaySoundOn")?(this._bindOnHoverListeners(),this.checkVolumeStatus()):this.createStateHandlers([{event:"autoplaySoundOn:true",funcName:"_bindOnHoverListeners",isListenOnce:!0},{event:"autoplaySoundOn:true",funcName:"checkVolumeStatus",isListenOnce:!0}])}},{key:"checkVolumeStatus",value:function(){this.currModel.get("autoplaySoundOn")&&"on"===this.currModel.get("volume")?(this.log.info("Unmute first video because volume=on"),this.currModel.set("volumeMuted",!1)):this.currModel.set("volumeMuted",!0)}},{key:"hide",value:function(){this.$el.hide()}},{key:"show",value:function(){this.$el.show()}},{key:"close",value:function(){this.model.set("closeState",ut().closeState.videoViewClosed)}},{key:"_customize",value:function(){var t=this.model.get("additionalCss");this.$el.css(qa.toCssObj(t))}},{key:"_rePosition",value:function(t,e){this.$el.css(e)}},{key:"_onLoadingClick",value:function(){this.ui.video[0].id=this.videoAdId,this.replayAd()}},{key:"replayAd",value:function(){this.model.get("isReplayAd")&&this.repeatingAd&&(this.activeAd=this.repeatingAd,this.activeAd.vpaidWrapper.restartAd(),this._resizeRepeatingAd(),this.activeAd.setToModel("adQState",ut().adQState.repeating,this.repeatingAd.adId),this.activeAd.setToModel("adState",ut().adState.repeating,this.repeatingAd.adId)),this.model.set("isAdClosedByTimer",!1)}},{key:"_onDisplayingFullNAS",value:function(){this.activeAd&&this.activeAd.onDisplayingFullNAS()}},{key:"_onDisplayingNASTitleOnly",value:function(){this.activeAd&&this.activeAd.onDisplayingNASTitleOnly()}},{key:"_setNasOppEvents",value:function(){this.model.listenTo(this.model,"displayingFullNAS",this._onDisplayingFullNAS.bind(this)),this.model.listenTo(this.model,"displayingNASTitleOnly",this._onDisplayingNASTitleOnly.bind(this))}},{key:"_handleVolume",value:function(){this.activeAd&&(this.currModel.get("volumeMuted")?this.activeAd.mute():this.activeAd.unmute())}},{key:"id",get:function(){return"_cm-css-reset"}},{key:"videoAdId",get:function(){return Ga}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=Qa},set:function(t){return this.UI=t}},{key:"_onMouseEnter",get:function(){return Ya}},{key:"_onMouseLeave",get:function(){return Ka}},{key:"onAdComplete",value:function(){this.setRepeatingAd(),this.activeAd=void 0,this.model.get("isMultiAd")?this.checkEligible():this.model.set("closeState",ut().closeState.terminate)}},{key:"checkEligible",value:function(){this.model.get("isInTab")&&this.isEligibleToPlay()?(this.activeAd||this.getReadyAd(),this.activeAd&&this.playAd()):this.activeAd&&this.activeAd.pause(e().PAUSE_REASONS.LOST_ELIGIBILITY)}},{key:"isEligibleToPlay",value:function(){return this.model.get("isEligibleToPlay")}},{key:"getReadyAd",value:function(){this.model.get("hasReadyAd")&&(this._onPostRepeatImpression(),this.model.get("volumeMuted")||this.model.get("wurfl.os.name")!==e().OS.IOS||this.model.set("volumeMuted",!0),this.activeAd=this.model.getNextAd(),this.activeAd&&-1===this.model.get("unitType").indexOf("RECO_REEL_WIDGET")&&this.model.set("aspectRatioNum",this.activeAd.getAspectRatioNum()),this.postGetAd())}},{key:"onGotRVAd",value:function(){this.currModel.get("hasReadyAd")&&this.currModel.get("isNextAdRV")&&!this.isCurrentAdRV&&(this.activeAd&&this.isEligibleToPlay()?this.swapToNewReadyAd():this.hadPossibleRV=!0)}},{key:"swapToNewReadyAd",value:function(){var t=this;this.isSwappedAd=!0,this.swappedAd=this.activeAd,this.swappedAd.onAdSwappedOut(),this.pauseAd(e().PAUSE_REASONS.AD_SWAPPED),this.getReadyAd(),this._swapNativeAdSettings(),setTimeout((function(){t.activeAd.onAdSwappedIn()}),0)}},{key:"_swapNativeAdSettings",value:function(){this.nativeAdSettings&&this.nativeAdSettings.onAdSwapped()}},{key:"hasReadyAdChangeSubUnit",value:function(){this.log.info("hasReadyAdChangeSubUnit",this.globalModel.get("hasReadyAd")),!this.isRepeatMode&&this.globalModel.get("hasReadyAd")&&this.isEligibleToPlay()&&this.getReadyAd()}},{key:"setRepeatMode",value:function(t){this.isRepeatMode=t}},{key:"postGetAd",value:function(){}},{key:"playAd",value:function(){this.log.info("@@play ad",this.model.get("unitType")),this.activeAd&&(this.log.info("Play Ad !!!!",this.activeAd),this.activeAd.play(),this.activeAd.isUsed||(this.activeAd.isUsed=!0),this.model.get("components.volume.isActive")&&setTimeout(this._fireVolumeStateCheck.bind(this),0),this.viewabiltyService=this._viewabilitySerivcesFactory.getViewabilityService({model:this.model,ad:this.activeAd,onViewabilityCallback:this._onViewability.bind(this)}),this.viewabiltyService.updateActiveAd(this.activeAd))}},{key:"pauseAd",value:function(t){this.activeAd&&this.activeAd.pause(t)}},{key:"_onViewability",value:function(){this.log.info("Viewability reached"),this.stickyViewCallback&&this.stickyViewCallback()}},{key:"_addDisclosureText",value:function(){(this.model.get("components.disclosureText.isActive")||this.model.get("detachToSlider.components.disclosureText.isActive"))&&(this.disclosureTextView=new ba({model:this.model,container:this.el}),this.disclosureTextView.render())}},{key:"_fireVolumeStateCheck",value:function(){this._startAnimationOnce(),this._handleVolume(),this.currModel.trigger("lastVolumeStateCheck")}},{key:"_setVolumeAnimationTrigger",value:function(){var t=this;this._startAnimationOnce=qa.once((function(){t.currModel.trigger("startVolumeAnimation")}))}},{key:"_unBindOnHoverListeners",value:function(){this.el.removeEventListener("mouseenter",this._onMouseEnter.bind(this)),this.el.removeEventListener("mouseleave",this._onMouseLeave.bind(this))}},{key:"_bindOnHoverListeners",value:function(){this.currModel.get("autoplaySoundOn")&&"onHover"===this.currModel.get("volume")&&!this.currModel.get("volumeUserInteraction")&&(this.el.addEventListener("mouseenter",this._onMouseEnter.bind(this)),this.el.addEventListener("mouseleave",this._onMouseLeave.bind(this)),this.currModel.on("change:volumeUserInteraction",this._unBindOnHoverListeners.bind(this)))}},{key:"setRepeatingAd",value:function(){this.model.get("isReplayAd")&&this.activeAd&&this.activeAd.vpaidWrapper.isReplayable?this.repeatingAd=this.activeAd:this.repeatingAd=null}},{key:"_bindBlockedByExternalUnitChange",value:function(){this.currModel.on("change:blockedByExternalUnit",this._onBlockedByExternalUnitChange.bind(this))}},{key:"_onBlockedByExternalUnitChange",value:function(){this.currModel.get("blockedByExternalUnit")?(this.pauseAd(e().PAUSE_REASONS.BLOCKED_BY_EXTERNAL_UNIT),this.activeAd&&this.activeAd.fireAdOppOnce("adPausedOtherUnitIsPlaying")):this.checkEligible()}},{key:"_resizeRepeatingAd",value:function(){var t=this;setTimeout((function(){var e=t.isDetached?t.model.get("detachToSlider.width"):t.model.get("width"),i=t.isDetached?t.model.get("detachToSlider.height"):t.model.get("height");t.activeAd.vpaidWrapper.resizeAd(e,i)}),0)}},{key:"_onPostRepeatImpression",value:function(){this.repeatingAd&&(this.repeatingAd.vpaidWrapper&&this.repeatingAd.vpaidWrapper.stop&&this.repeatingAd.vpaidWrapper.stop("post_repeat"),this.repeatingAd=null,this.activeAd=null)}}])&&Wa(i.prototype,n),o&&Wa(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.s),Xa=Za;function Ja(t){return Ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ja(t)}function tl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Ja(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Ja(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Ja(o)?o:String(o)),n)}var r,o}var el=i(1999),il=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.model=e,this.log=new r.Z({unitType:"Util",className:"AnimationUtil",version:this.model.get("version"),isDebug:this.model.get("isDebug")})}var e,i,n;return e=t,(i=[{key:"expand",value:function(t){t.$el.height()>=t.height?this.log.info("No expand needed"):this.aniamteHeight(t)}},{key:"collapse",value:function(t){t.$el.height()<=t.height?this.log.info("No collapse needed"):this.aniamteHeight(t)}},{key:"aniamteHeight",value:function(t){this.model.set("isAnimationRunning",!0);var e={transition:"height "+t.timeMS+"ms",height:t.height};requestAnimationFrame((function(){t.$el.css(e)})),this.oneAnimationEnd(t.$el,t.cb,t.timeMS)}},{key:"aniamteOpacity",value:function(t){this.model.set("isAnimationRunning",!0);var e={transition:"opacity "+t.timeMS+"ms",opacity:t.opacity};requestAnimationFrame((function(){t.$el.css(e)})),this.oneAnimationEnd(t.$el,t.cb,t.timeMS)}},{key:"attach",value:function(t){if(t.$el){var e={top:t.target.top,left:t.target.left};if(t.isAnimated){e.width=this.model.get("videoPlaceholderSize.width")+"px",e.height=this.model.get("videoPlaceholderSize.height")+"px";var i=t.$el.offset(),n={position:"absolute",top:i.top+"px",left:i.left+"px",width:i.width+"px",height:i.height+"px"};requestAnimationFrame((function(){t.$el.css(n),el.flushCss(t.$el[0])})),e.transition="all "+t.timeMS+"ms ease",e=_.default.extend(e,t.additionalCss),requestAnimationFrame(function(){t.$el.css(e)}.bind(this))}else{var r={position:"absolute",top:"auto",bottom:"auto",left:"auto",right:"auto"};e=_.default.extend(r,e),e=_.default.extend(r,t.additionalCss),t.$el.css(r),requestAnimationFrame((function(){el.flushCss(t.$el[0])}))}this.oneAnimationEnd(t.$el,t.cb,t.timeMS)}else this.log.warning("Called attach without an element!")}},{key:"detach",value:function(t){var e,i;if(this.model.get("nextUp.isActive")&&this.model.get("nextUp.selector")&&(e=document.querySelector(this.model.get("nextUp.selector")),i=getComputedStyle(e.parentElement).bottom),t.isAmp)this.detachSliderAmp(t);else{var n={position:"fixed",top:"auto",bottom:"auto",left:"auto",right:"auto"};if(t.isSlideIn)e?(n[t.sliderOptions.position.horizontal]=0,n[t.sliderOptions.position.vertical]=i):(n[t.sliderOptions.position.horizontal]=t.sliderOptions.position.horizontalOffset+"px",n[t.sliderOptions.position.vertical]=t.sliderOptions.position.verticalOffset+"px"),n.height=this.model.get("detachToSlider.height")+"px",t.isSlideVertically?n.height=0:n.width=0;else{var r=_.default.extend({},t.$el[0].getBoundingClientRect());r.right=window.innerWidth-r.left-r.width,r.bottom=window.innerHeight-r.bottom,n[t.sliderOptions.position.horizontal]=r[t.sliderOptions.position.horizontal]+"px",n[t.sliderOptions.position.vertical]=r[t.sliderOptions.position.vertical]+"px"}var o={transition:"all "+t.timeMS+"ms ease"};e?(o[t.sliderOptions.position.vertical]=i,o[t.sliderOptions.position.horizontal]=0):(o[t.sliderOptions.position.vertical]=t.sliderOptions.position.verticalOffset+"px",o[t.sliderOptions.position.horizontal]=t.sliderOptions.position.horizontalOffset+"px"),o.width=this.model.get("detachToSlider.width")+"px",o.height=this.model.get("detachToSlider.height")+"px",t.isAnimated?(t.$el.css(n),requestAnimationFrame((function(){t.$el.css(n),el.flushCss(t.$el[0])})),requestAnimationFrame(function(){t.$el.css(o)}.bind(this))):(t.$el.css(n),o.transition="none !important",t.$el.css(o)),this.oneAnimationEnd(t.$el,t.cb,t.timeMS+1)}}},{key:"detachSliderAmp",value:function(t){var e={position:"absolute",top:"auto",bottom:"auto",left:"auto",right:"auto"};t.isSlideIn?(e[t.sliderOptions.position.horizontal]=t.sliderOptions.position.horizontalOffset+"px",e.top=this._getSliderPositionVerticalAmp(t.sliderOptions),e.height=this.model.get("detachToSlider.height")+"px",t.isSlideVertically?e.height=0:e.width=0):(e[t.sliderOptions.position.horizontal]=t.sliderOptions.position.horizontalOffset+"px",e.top=this._getSliderPositionVerticalAmp(t.sliderOptions));var i={position:"absolute",top:"auto",bottom:"auto",left:"auto",right:"auto",transition:"all  ".concat(t.sliderOptions.detachAnimationTime," ").concat(t.sliderOptions.animationStyle)};i[t.sliderOptions.position.horizontal]=t.sliderOptions.position.horizontalOffset+"px",i.top=this._getSliderPositionVerticalAmp(t.sliderOptions),i.width=this.model.get("detachToSlider.width")+"px",i.height=this.model.get("detachToSlider.height")+"px",t.isSlideIn&&t.$el.css(e),requestAnimationFrame(function(){t.$el.css(i)}.bind(this)),setTimeout(function(){this.correctSliderDetachPosition({$el:t.$el,sliderOptions:t.sliderOptions,isSlideVertically:t.isStickyCardActive})}.bind(this),t.sliderOptions.animationTime+10),this.oneAnimationEnd(t.$el,t.cb,t.timeMS+1)}},{key:"detachAmpSticky",value:function(t){el.dispatchTRC("videoSliderOn",this.model),t.timeMS=150;var e={transition:"top "+t.timeMS+"ms ease-in-out",position:"absolute"};e[t.sliderOptions.position.horizontal]=t.sliderOptions.position.horizontalOffset+"px",e[t.sliderOptions.position.vertical]=t.sliderOptions.position.verticalOffset+"px",e.width=this.model.get("detachToSlider.width")+"px",e.height=this.model.get("detachToSlider.height")+"px",t.$el.css(e),this.oneAnimationEnd(t.$el,t.cb,t.timeMS+1)}},{key:"correctSliderDetachPosition",value:function(t){el.dispatchTRC("videoSliderOn",this.model);var e=t.sliderOptions.amp.correctionAnimationTime,i={transition:"top "+e+"ms ease-in-out",position:"absolute"};i.top=this._getSliderPositionVerticalAmp(t.sliderOptions),t.$el.css(i),this.oneAnimationEnd(t.$el,t.cb,e+1)}},{key:"slideOut",value:function(t){var e={transition:"all "+t.timeMS+"ms linear"};t.isVerticalSlideOut?(e[t.sliderOptions.position.horizontal]=t.sliderOptions.position.horizontalOffset+"px",e[t.sliderOptions.position.vertical]="-"+(t.sliderOptions.height+parseFloat(t.sliderOptions.position.verticalOffset))+"px"):(e[t.sliderOptions.position.horizontal]="-"+(t.sliderOptions.width+parseFloat(t.sliderOptions.position.horizontalOffset))+"px",e[t.sliderOptions.position.vertical]=t.sliderOptions.position.verticalOffset+"px"),requestAnimationFrame(function(){t.$el.css(e)}.bind(this)),this.oneAnimationEnd(t.$el,t.cb,t.timeMS)}},{key:"oneAnimationEnd",value:function(t,e,i){setTimeout(function(){this.model.set("isAnimationRunning",!1),t.css("transition","none"),e&&e()}.bind(this),i)}},{key:"PrefixedEvent",value:function(t,e,i,n){i=i.toLowerCase(),el.each(["webkit","moz","MS","o",""],(function(r){t[e](r+i,n)}))}},{key:"_getSliderPositionVerticalAmp",value:function(t){var e=0,i=this.model.get("ampPageTopLimit")||0,n=this.model.get("ampPageBottomLimit")||0;return"bottom"===t.position.vertical?(e=n-t.height-t.position.verticalOffset,e=Math.max(0,e)):e=i+t.position.verticalOffset,"".concat(e,"px")}},{key:"updateModel",value:function(t){this.model=t}}])&&tl(e.prototype,i),n&&tl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),nl=function(){var t;return function(e){return t||(t=new il(e)),t.updateModel(e),t}}(),rl=nl;function ol(t){return ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ol(t)}function sl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==ol(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==ol(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===ol(o)?o:String(o)),n)}var r,o}function al(){return al="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ul(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}},al.apply(this,arguments)}function ll(t,e){return ll=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ll(t,e)}function cl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ul(t);if(e){var r=ul(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===ol(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function ul(t){return ul=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ul(t)}var dl=i(1999),hl=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ll(t,e)}(s,e);var i,n,r,o=cl(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).$el.addClass("_cm-video"),e.template='<div class="_cm-video-ad"></div> ',e.container=t.container||"body",e.isFirstAttach=!0,e.animationUtil=rl(e.model),e.detachUtil=se(e.model),e.model.set("videoViewSize",{width:0,height:0}),e.isStickyCardActive=e.model.get("stickyCard.isActive"),e.copyPropertiesActive=e.model.get("copyProperties.isActive"),e.copyProprtiesSelector=document.querySelector(e.model.get("copyProperties.selector")),e.copyProprtiesMap=e.model.get("copyProperties.propertiesMap"),e.detachUtil.setStickParams(),e.render(),e}return i=s,n=[{key:"setNativeAdViewObj",value:function(t){this.nativeAdSettings=t}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"videoPlaceholderSize",funcName:"_onVideoPlaceholderSizeChange",withBind:!1},{event:"videoPlaceholderPosition",funcName:"_rePosition",withBind:!1},{event:["containerViewState:rendered","adState:playing"],funcName:"_startComponent",isListenOnce:!0},{event:"repeatState:clicked",funcName:"replayAd"},{event:"learnMoreWasClicked",funcName:"_onLearnMoreClick"},{event:"adState:repeating",funcName:"onHasReadyAd"},{event:"isEligibleToPlay",funcName:"checkEligible"},{event:"isInTab",funcName:"checkEligible"},{event:"videoViewState:detached",funcName:"checkEligible"},{event:"hasReadyAd:true",funcName:"onHasReadyAd"},{event:"adState:completed",funcName:"onAdComplete"},{event:"progressLoaderTimerReached:true",funcName:"hide",isListenOnce:!0},{event:"readMoreClicked:true",funcName:"playAd",isListenOnce:!0}]),this._setVolumeEvents(),w().on("window:scroll:change",this._onWindowScroll.bind(this));var t=this.model.get("isMultiAd")&&!this.model.get("isPlacementSingleAd");this.model.get("isForceSwapToRV")&&t&&(this.currModel.on("hasReadyAd:true",this.onGotRVAd.bind(this)),this.currModel.on("change:isNextAdRV",this.onGotRVAd.bind(this))),this.model.listenTo(this.model,"displayingFullNAS",this._onDisplayingFullNAS.bind(this)),this.model.listenTo(this.model,"displayingNASTitleOnly",this._onDisplayingNASTitleOnly.bind(this))}},{key:"render",value:function(){this.renderTemplate(),this._customize(),this.ui.video[0].id=this.videoAdId,this.$el.css({width:this.model.get("width"),height:"0px"}),(0,_.default)(this.container).append(this.el),this.model.set("videoViewContainer",this.ui.video[0]),this.model.set("targetId",this.videoAdId),this.model.set("videoViewState",ct.videoViewState.rendered),this._addDisclosureText(),dl.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoInitToRender".concat(this.model.get("perfUnitType")),t.TRC_PERFORMANCE_ACTIONS.STOP)}},{key:"_startComponent",value:function(){this.isStartComponent=!0,this.attach(!0)}},{key:"attach",value:function(e){this.log.info("attaching to placeholder"),this.model.set("videoViewState",ct.videoViewState.attached);var i=this.model.get("videoPlaceholderPosition");if(!isNaN(i.top)){var n=this.model.get("detachToSlider.animationTimes.attach"),r=!e&&this.model.get("detachToSlider").animation;this.attachedOnceToNewCard=!0,this.log.info("Attaching",this.$el),this.currentAnimation=t.ANIMATION_TYPE.attaching,this.isDetached=!1,this._resize(this.model,this.model.get("videoPlaceholderSize")),this.isFirstAttach&&this.$el.css({opacity:0}),this.isStickyCardActive&&(r=!1),this.model.set("floatingView",ct.floatingView.attach),this._attach(r,n),this.isFirstAttach&&this.aniamteOpacity(),this.isFirstAttach=!1}}},{key:"_attach",value:function(t,e){this._hasNAS()&&(this.model.set("oldVideoPlaceholderPosition.height",this.model.get("videoPlaceholderPosition.height")),this.model.set("videoPlaceholderPosition.height",this.model.get("containerHeight"))),this.animationUtil.attach({$el:this.$el,target:this.model.get("videoPlaceholderPosition"),isAnimated:t,timeMS:e,additionalCss:this.model.get("additionalCss"),cb:this.postAttach.bind(this)}),this._hasNAS()&&this.model.set("videoPlaceholderPosition.height",this.model.get("oldVideoPlaceholderPosition.height"))}},{key:"postAttach",value:function(){this.model.set("floatingView",ct.floatingView.postAttach),this.currentAnimation===t.ANIMATION_TYPE.attaching&&(this.currentAnimation=t.ANIMATION_TYPE.none,this._hasNAS()&&this._resize(this.model,this.sizeObject),this.model.get("isMultiAd")&&this.checkEligible())}},{key:"aniamteOpacity",value:function(){var e=this.model.get("animation.transitionAnimationTime");this.animationUtil.aniamteOpacity({$el:this.$el,timeMS:void 0===e?t.TIME_UNITS.SECOND:e,opacity:1,cb:null})}},{key:"detach",value:function(e,i){if(this.model.set("floatingView",ct.floatingView.detach),e||!this.isDetached){this.isDetached=!0,this.log.info("detaching"),this.currentAnimation=t.ANIMATION_TYPE.detaching;var n=i?0:this.model.get("detachToSlider.animationTimes.detach");this.isFirstDetach&&(n=this.model.get("animation.firstDetach")),this.detachUtil.setSliderSize();var r={width:this.model.get("detachToSlider.width"),height:this.model.get("detachToSlider.height")};this._resize(this.model,r),this.$el.css(this.model.get("additionalCss")),this._detach(n),this.model.set("videoViewState",ct.videoViewState.detached)}}},{key:"_detach",value:function(t){var e=_.default.extend(!0,{},this.detachToSlider);if(this._hasNAS()){var i=this.nativeAdSettings.getFloatingNASHeight();e.height+=i,this.model.set("detachToSlider.oldHeight",this.model.get("detachToSlider.height")),this.model.set("detachToSlider.height",this.model.get("detachToSlider.height")+i)}this.animationUtil.detach({$el:this.$el,timeMS:t,sliderOptions:e,isSlideIn:!1,cb:this.postDetach.bind(this)}),this._hasNAS()&&this.model.set("detachToSlider.height",this.model.get("detachToSlider.oldHeight"))}},{key:"_hasNAS",value:function(){return this.nativeAdSettings&&this.nativeAdSettings.hasNAS}},{key:"postDetach",value:function(){this.currentAnimation===t.ANIMATION_TYPE.detaching&&(this.currentAnimation=t.ANIMATION_TYPE.none)}},{key:"hide",value:function(){this.$el.css("height","0px")}},{key:"reShowUnit",value:function(){this.log.info("reopening unit"),this._rePosition(this.model,this.model.get("videoPlaceholderPosition")),this._resize(this.model,this.model.get("videoPlaceholderSize"))}},{key:"close",value:function(){this.hide(),Xa.prototype.close.call(this)}},{key:"_resize",value:function(t,e){if(e&&((this.model.get("animation.onTransitionOpen")||6===this.model.get("openingEffect"))&&this.model.get("isExpanded")&&(this.$el.addClass("none-transition"),setTimeout(function(){this.$el.removeClass("none-transition")}.bind(this),1e3)),this.isStartComponent)){this.sizeObject=e;var i=_.default.extend(!0,{},e);this._hasNAS()&&(i.height+=this.nativeAdSettings.detached?this.nativeAdSettings.getFloatingNASHeight():this.nativeAdSettings.getNASHeight()),this.$el.css(i),this.model.set("videoViewSize",e,{silent:!0}),this.model.trigger("change:videoViewSize",this.model,this.model.get("videoViewSize"))}}},{key:"onAdComplete",value:function(){this.setRepeatingAd(),this.activeAd=void 0;var t=this.model.get("unitType");if(this.model.get("isMultiAd")||this.model.get("isKeepViewOnMidroll")||this.repeatingAd||"WIDGET_ITEM"!==t){var e=!1;this.isDetached&&this.isStickyCardActive&&(e=!0,this.permanentAttach()),this.isSwappedAd&&!this.hadPossibleRV&&this.swapBackToSavedAd(e),this.model.get("isReplayAd")&&this._handleSingleAdCompletion(),this.model.get("isMultiAd")&&this.checkEligible(),this._handleNASOnAdChange(e),this.hadPossibleRV=!1}else this.model.set("closeState",ct.closeState.terminate)}},{key:"_onReplayAd",value:function(){this.limitRepeatByTimer=clearTimeout(this.limitRepeatByTimer),this._handleNasOnSingleAd(!1),this.model.listenTo(this.model,"change:isEligibleToPlay",this.checkEligible.bind(this)),this.model.listenTo(this.model,"change:isInTab",this.checkEligible.bind(this))}},{key:"_handleSingleAdCompletion",value:function(){var t=this;this.model.set("detachToSlider.isDetachToSlider",!1),this.activeAd=this.repeatingAd,this._handleNasOnSingleAd(!0),this.model.stopListening(this.model,"change:isEligibleToPlay"),this.model.stopListening(this.model,"change:isInTab"),this.createStateHandlers([{event:"adState:repeating",funcName:"_onReplayAd"}]),this.limitRepeatByTimer=setTimeout((function(){return t.permanentAttach()}),this.model.get("limitRepeatTimerBySec")||5e3)}},{key:"_handleNasOnSingleAd",value:function(t){this.isDetached&&this._hasNAS()&&(t?this.nativeAdSettings.hideFloatingNAS():this.nativeAdSettings.showFloatingNAS(),this._resize(this.model,this.isDetached?this.model.get("detachToSlider"):this.model.get("videoPlaceholderSize")))}},{key:"onHasReadyAd",value:function(){this.model.get("isAnimationRunning")?this.createStateHandlers([{event:"isAnimationRunning:false",funcName:"onHasReadyAd",isListenOnce:!0}]):(this.checkEligible(),this.activeAd&&this.model.get("videoViewState")===ct.videoViewState.detached&&this.activeAd.resize(this.sizeObject))}},{key:"checkEligible",value:function(){this._isEligibleToPlayChange(),this.model.get("isInTab")&&this.isEligibleToPlay()?(this.activeAd&&!this.model.get("postRepeatMode")||this.getReadyAd(),this.activeAd&&this.playAd()):this.isDetached||this.pauseAd(t.PAUSE_REASONS.LOST_ELIGIBILITY)}},{key:"pauseAd",value:function(t){this.activeAd&&(this.log.info("Pause Ad: adId:"+this.activeAd.adId),this.activeAd.pause(t))}},{key:"_isEligibleToPlayChange",value:function(){this.canAttach()?this.attach():this.canDetach()&&(this.detach(),this.isStickyCardActive&&this.model.get("stickyCard.restrictions.adPercent.percent")&&this._setStickySizeRestrication())}},{key:"_setStickySizeRestrication",value:function(){if(!this.rvTimerWasSet){var t=dl.getViewportHeight(this.model.get("scrollSelector"));this.model.get("height")/t*100>=this.model.get("stickyCard.restrictions.adPercent.percent")&&(this.rvTimerWasSet=!0,this.stickyTimer=new Wn(this.model,{startCondition:{stateToListen:"",state:""}},this._onStickyTimerEnd.bind(this,"Sticky timer subUnit end"),1e3*this.model.get("stickyCard.restrictions.adPercent.secondsToClose")),this.stickyTimer.start(this.model,"",null,!0))}}},{key:"isEligibleToPlay",value:function(){return!("pause"===this.model.get("onOutOfView")&&!this.model.get("isInTab")||(this.model.get("isInTab")?!this.model.get("isEligibleToPlay")&&this.model.get("videoViewState")!==ct.videoViewState.detached:this.model.get("videoViewState")!==ct.videoViewState.detached||"play"!==this.model.get("detachToSlider").onOutOfView))}},{key:"canAttach",value:function(){return!(this.isStickyCardActive&&this.model.get("isEligibleToStick")||!this.model.get("isEligibleToPlay")||this.model.get("videoViewState")!==ct.videoViewState.detached||!this.model.get("renderWasCalled"))}},{key:"canDetach",value:function(){if(this.detachToSlider=this.model.get("detachToSlider"),this.model.get("isUnitHidden"))return!1;if(this.isStickyCardActive){if(!this._isActiveAdCanStick()||!this.model.get("isEligibleToStick"))return!1}else if(this.model.get("isEligibleToPlay"))return!1;return!(this.model.get("videoViewState")!==ct.videoViewState.attached&&this.model.get("videoViewState")!==ct.videoViewState.rendered||this.model.get("videoViewState")===ct.videoViewState.rendered&&!this.detachToSlider.isStartFromSlider||!this.detachToSlider.isDetachToSlider||!this.model.get("isInTab")||!this._isDetachAvailable())}},{key:"_isActiveAdCanStick",value:function(){return("any"===this.model.get("stickyCard.restrictions.rv")||this.model.get("activeAdRV")===this.model.get("stickyCard.restrictions.rv"))&&this._getQueryFuncResult()}},{key:"_getQueryFuncResult",value:function(){var t=this.model.get("stickyCard.isActive.restrictions.queries.function");if(t){var e=this.model.get("activeAdData");if(!e)return!1;var i=t(this.model.attributes,e);return this.log.info("query language function results for sticky.isActive",{activeAd:this.model.get("activeAdData"),function:t,result:i}),i}return!0}},{key:"_isDetachAvailable",value:function(){return this.el.getBoundingClientRect().top>0?this.model.get("detachToSlider.isDetachAbove"):this.model.get("detachToSlider.isDetachBelow")}},{key:"_rePosition",value:function(t,e){this.isDetached||al(ul(s.prototype),"_rePosition",this).call(this,t,e)}},{key:"_onVideoPlaceholderSizeChange",value:function(t,e){this.isDetached||(this.detachUtil.setSliderSize(),this._resize(t,this.model.get("videoPlaceholderSize")))}},{key:"postGetAd",value:function(){this.model.set("aspectRatioNum",this.activeAd.aspectRatioNum),this.isDetached&&this._resize(this.model,this.sizeObject)}},{key:"permanentAttach",value:function(){var t=this;this.activeAd&&this.isDetached&&this.activeAd.onSliderClose(),this.model.set("detachToSlider.isDetachToSlider",!1),this.model.set("floatingView",ct.floatingView.permanentClosed),this.isDetached&&this._slideOut((function(){t.attach(!0)}))}},{key:"_slideOut",value:function(t){if(this.isDetached){var e=this.model.get("animation.slideOut"),i=this.isStickyCardActive;this.animationUtil.slideOut({$el:this.$el,timeMS:e,sliderOptions:this.detachToSlider,isVerticalSlideOut:i,cb:t}),this.isDetached=!1}}},{key:"playAd",value:function(){al(ul(s.prototype),"playAd",this).call(this),this._handleVolume(),this.createStateHandlers([{event:"isSliderEligibleToPlay",funcName:"_onSliderEligibilityChange"}])}},{key:"_onSliderEligibilityChange",value:function(){this.isDetached&&!this.isPermanentAttachCalled&&this.activeAd&&(this.model.get("isSliderEligibleToPlay")?this.activeAd.play():this.activeAd.pause(t.PAUSE_REASONS.SLIDER_LOST_ELIGIBILITY))}},{key:"_onWindowScroll",value:function(){this.model.get("stickyCard.isActive")&&this._checkDetachToStickyOnScroll(),this.copyPropertiesActive&&this._copyPropertiesOnScroll()}},{key:"_copyPropertiesOnScroll",value:function(){if(this.copyProprtiesSelector)for(var t in this.copyProprtiesMap){var e=t,i=this.copyProprtiesMap[t];this.copyProprtiesSelector.style[e]&&(this.$el[0].style[i]=this.copyProprtiesSelector.style[e])}}},{key:"_checkDetachToStickyOnScroll",value:function(){if(this.isDetached&&this.isStickyCardActive){var t=(0,_.default)(".trc_rbox_container").has("#_cm-video-unit");if(t.length>0){var e=t.offset().top,i=e+t.height(),n=this.$el.offset().top;(i<n+this.$el.offset().height||n<e)&&(this.log.info("Unstick Sticky Ad"),this.permanentAttach())}else this.permanentAttach(),this.log.warning("there is no valid placement. cant sticky")}}},{key:"_onStickyTimerEnd",value:function(t){this.log.info(t),this.model.get("stickyCard.restrictions.adPercent.keepUntilScroll")?(this.log.info("Sticky wait for scroll"),w().once("window:scroll:change",this._attachSticky.bind(this))):this._attachSticky()}},{key:"_attachSticky",value:function(){this.log.info("Sticky attach"),this.permanentAttach(),this.rvTimerWasSet=!1}},{key:"onGotRVAd",value:function(){var t=this.currModel.get("isNextAdRV");this.currModel.set("isNextAdRV",null,{silent:!0}),this.activeAd&&t&&(this.isCurrentAdRV=this.activeAd.adData.requiredViewability,this.isCurrentAdRV&&t||!this.isEligibleToPlay()?this.hadPossibleRV=!0:this.swapToNewReadyAd())}},{key:"swapToNewReadyAd",value:function(){var e=this;this.isSwappedAd=!0,this.swappedAd=this.activeAd,this.swappedAd.onAdSwappedOut(),this.pauseAd(t.PAUSE_REASONS.AD_SWAPPED),this.swappedAd._bringToBack(),this.currModel.set("hasReadyAd",!0,{silent:!0}),this.getReadyAd(),this.onHasReadyAd(),this._handleNASOnAdChange(),setTimeout((function(){return e.activeAd.onAdSwappedIn()}),0)}},{key:"swapBackToSavedAd",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.model.set("swappedAdHasEnded",!0),this.activeAd=this.swappedAd,this.swappedAd=void 0,this.isSwappedAd=!1,this._handleNASOnAdChange(t),this.postGetAd()}},{key:"_handleNASOnAdChange",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.nativeAdSettings&&this.nativeAdSettings.shouldFitToSize&&(this._isActiveAdHasNativeAdSettings()?(this.model.set("adNativeSettings",this.activeAd.vpaidData.adNativeSettings),t&&this.nativeAdSettings.hide()):(this.model.set("adNativeSettings",{}),this.isDetached?this.nativeAdSettings.hideFloatingNAS():this.nativeAdSettings.hide()),this._resize(this.model,this.isDetached?this.model.get("detachToSlider"):this.model.get("videoPlaceholderSize")))}},{key:"_isActiveAdHasNativeAdSettings",value:function(){return this.activeAd&&this.activeAd.vpaidData&&this.activeAd.vpaidData.adNativeSettings}},{key:"setRepeatingAd",value:function(){this.repeatingAd=null,this.model.get("isReplayAd")&&this.activeAd&&this.activeAd.vpaidWrapper.isReplayable&&(this.repeatingAd=this.activeAd)}}],n&&sl(i.prototype,n),r&&sl(i,r),Object.defineProperty(i,"prototype",{writable:!1}),s}(Xa),fl=hl,pl=(w().View.extend({className:"_cm-poster",id:"_cm-css-reset",initialize:function(t){this.log=new r.Z({unitType:"Component",className:"PosterView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=t.container,this.render()},render:function(){this.staticBanner=document.createElement("img"),this.staticBanner.addEventListener("error",this._onError.bind(this));var t=this.model.get("components.PosterView.imageLocation");this.staticBanner.src=t,this.staticBanner.height=this.model.get("height"),this.staticBanner.width=this.model.get("width"),this.staticBanner.onclick=this._onClick.bind(this),this.$el.hide(),this.$el.append(this.staticBanner),this.container.prepend(this.$el)},_onError:function(){w().trigger("error",this.staticBanner,"imageLoadError"),this.$el.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_onClick:function(t){this.trigger("cm:banner:click")}}),i(9288)),ml=i(1999),yl=(pl.View.extend({className:"_cm-brand-logo",events:{"click ":"_onClick"},initialize:function(t){this.model=t.model,this.log=new r.Z({unitType:t.unitType,className:"branLogoView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=t.container,this.options=this.model.get("components.BrandLogo")||{},this.options.imageSrc=this.model.get("components.BrandLogo.imageSrc"),this.openUrl=this._getOpenUrl(),this.render(),this.componentsVisibilityListener=t.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.template=ml.template('<a href="javascript:void(0);"> <img src="{{imageSrc}}"/> </a> '),this.$el.append(this.template(this.options)),this.options.style&&this.$el.css(this.options.style),this.options.imageStyle&&this.$el.find("a>img").css(this.options.imageStyle),this.container.appendChild(this.el)},_onClick:function(){window.open(this.openUrl,"_blank")},_getOpenUrl:function(){var t=this.model.get("clickUrl"),e=this.options.logoLander,i=this.options.fallBackClickUrl,n=this._getClickUrlQueryStrings(e);return t&&t.length>0&&-1===t.indexOf("_#")?decodeURIComponent(t)+encodeURIComponent(i)+n:i+n},_getClickUrlQueryStrings:function(t){return"?ttype=1&cipid="+this.model.get("cipid")+"&ttype=1&crid="+this.model.get("creativeId")+"&dast="+this.model.get("dast")+"&tgtf="+encodeURIComponent(t)},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),w().View.extend({className:"_cm-click-through",initialize:function(t){this.log=new r.Z({unitType:"Component",className:"ClickThrough",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=t.container,this.link=t.link,this.render()},render:function(){this.$el.click(this.onClick.bind(this)),this.container.appendChild(this.el)},onClick:function(){this.link&&window.open(this.link,"_blank")},hide:function(){this.$el.hide()},show:function(){this.$el.show()},updateLink:function(t){this.link=t}}),'<?xml version="1.0" encoding="utf-8"?> <svg version="1.1" id="_x2014_ÎÓÈ_x5F_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 99 99" xml:space="preserve"> <style>.st0{fill:#fff}</style> <g> <g stroke="null" id="svg_1"> <g stroke="null" id="svg_2"> <path stroke="null" id="svg_3" d="m82.77256,91.4817c-1.64243,0 -3.25444,-0.644 -4.50148,-1.9964l-65.57555,-69.42328c-2.49406,-2.6404 -2.49406,-6.92301 0,-9.56341c2.49406,-2.6404 6.53931,-2.6404 9.03337,0l65.57555,69.45548c2.49406,2.6404 2.49406,6.92301 0,9.56341c-1.24703,1.3202 -2.88946,1.9642 -4.53189,1.9642z" class="st0"/> </g> <g stroke="null" id="svg_4"> <path stroke="null" id="svg_5" d="m17.19702,91.4817c-1.64243,0 -3.25444,-0.644 -4.50148,-1.9964c-2.49406,-2.6404 -2.49406,-6.92301 0,-9.56341l65.57555,-69.42328c2.49406,-2.6404 6.53931,-2.6404 9.03337,0c2.49406,2.6404 2.49406,6.92301 0,9.56341l-65.57555,69.45548c-1.24703,1.3202 -2.88946,1.9642 -4.53189,1.9642z" class="st0"/> </g> </g> </g> </svg> '),gl=i(9288),vl=i(1999),bl=i(9831),_l=gl.View.extend({className:"_cm-close-area",id:"_cm-close-area",events:{"click ":"_onClick"},initialize:function(t){this.log=new r.Z({unitType:t.unitType,className:"closeButtonView",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),this.container=t.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=ga.L,this.componentsVisibilityListener=t.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){if(!this._rendered){this._rendered=!0;var t=yl;this.model.get("closeButton.uncoverVideo")&&(t='<svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M0 0 0 0L10 10" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M10 0 10 0L0 10" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path> </svg> ',this._addUncoverVideoCloseButtonCSS()),this.$el.append(t);var i=this.model.get("wurfl.browser.name").toLowerCase();-1===i.indexOf(e().BROWSER.FIREFOX.toLowerCase())&&-1===i.indexOf(e().BROWSER.IE.toLowerCase())&&-1===i.indexOf(e().BROWSER.EDGE.toLowerCase())||this.$el.addClass("_cm-close-ie-fix"),this.container=vl.isArray(this.container)?this.container[0]:this.container,this.container.appendChild(this.el),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&("detached"===this.model.get("videoViewState")?this.show():this.hide())}},_addUncoverVideoCloseButtonCSS:function(){var t=this.model.get("closeButton.uncoverVideoButtonSize"),e=t.width,i=t.height,n=this.model.get("detachToSlider.position"),r=n.horizontal,o=n.horizontalOffset,s={width:e,height:i,"margin-top":-1*i};if(o&&(s[r]=o),"left"===r){var a=this.container?$(this.container).width()-e:0;s.left||(s.left=0),s.left+=a}for(var l in s)"string"==typeof l&&-1!==l.indexOf("px")||(l+="px");this.$el.css(s),this.$el.addClass("_cm-uncover-close-area"),this.$el.removeClass("_cm-close-area")},_bindEvents:function(){this.model.get("vForce.isActive")?this.listenTo(this.model,"change:adState",this._onStateChange):this.listenTo(this.model,"change:state",this._onStateChange),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onPlaying:function(){var t=this.model.get("components.CloseButtonView.delay");this.renderTimeout=setTimeout(this.render.bind(this),t)},_onClick:function(t){t.stopPropagation(),this.model.get("onClose")||"OMNI_TAG"==this.model.get("unitType")||vl.firePixel(this.model.getPixel("pixels.close"),"close (user clicked the close button)"),this.model.set("state",this.model.STATE.STOPPED_BY_USER),gl.trigger("Ad:stoppedByUser"),this.model.trigger("ad:stoppedByUser",bl.closeState.terminate)},_onStateChange:function(t,e){e!==t.STATE.PLAYING&&e!==bl.adState.playing||this._onPlaying()},_onVideoViewStateChange:function(t,e){switch(e){case"detached":this.show();break;case"attached":this.hide()}},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),Sl=i(9288),wl=i(1999),Tl=i(9831),Pl=(Sl.View.extend({className:"_cm-close-area",id:"_cm-close-area",closeButtonRenderd:!1,events:{"click ":"_onClick"},initialize:function(t){this.log=new r.Z({unitType:t.unitType,className:"closeButtonView",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),this.container=t.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=ga.L,this.render(),this.hide()},render:function(){this._rendered||(this._rendered=!0,this.isInDelay=!1,this.$el.append(yl),this.container.appendChild(this.el))},_bindEvents:function(){this.listenTo(this.model,"change:state",this._onStateChange),this.listenTo(this.model,"change:adState",this._onStateChange),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.model.get("detachToSlider.hasCloseButton")&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onPlaying:function(){this.model.get("videoViewState")!==Tl.videoViewState.attached||this.model.get("hasCloseButton")?this._startRender():this.isInDelay&&(this.closeButtonRenderd=!1,clearTimeout(this.delayTimeout))},_startRender:function(){if(this.closeButtonRenderd)this.show();else{this.closeButtonRenderd=!0;var t=this.model.get("components.CloseButtonView.delay");this.isInDelay=!0,this.delayTimeout=setTimeout(this.render.bind(this),t)}},_onClick:function(){this.model.get("onClose")||"OMNI_TAG"==this.model.get("unitType")||wl.firePixel(this.model.getPixel("pixels.close"),"close (user clicked the close button)"),this.model.set("state",this.model.STATE.STOPPED_BY_USER),Sl.trigger("Ad:stoppedByUser"),this.model.trigger("ad:stoppedByUser")},_onStateChange:function(t,e){if("playing"===e)this._onPlaying()},_onVideoViewStateChange:function(t,e){"detached"===e&&!this.closeButtonRenderd&&this.model.get("detachToSlider.hasCloseButton")&&this._startRender(),"attached"!==e||this.model.get("hasCloseButton")||this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),i(9288)),Al=i(1999),El=(Pl.View.extend({className:"_cm-d2d-fallback",initialize:function(t){this.model=t.model,this.log=new r.Z({unitType:t.unitType,className:"D2dFallbackView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=t.container,this.isTrusted=!0,this.pubId=t.pubId?t.pubId:this.model.get("components.D2DFallbackView.pubId"),this.pubTagId=t.pubTagId?t.pubTagId:this.model.get("components.D2DFallbackView.pubTagId"),this.render(),this.componentsVisibilityListener=t.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.$el.append('<iframe style="width:100%;height:100%" frameborder="0" border="0" padding="0" scrolling="no" marginwidth="0" marginheight="0"></iframe> '),this._customize(),(0,_.default)(this.container).append(this.$el),this.iframe=this.$el.find("iframe")[0],this.iframe.contentWindow?this._writeIframe():this.iframe.onload=this._writeIframe.bind(this),Al.firePixel(this.model.getPixel("pixels.D2DFallback"),"D2DFallback")},_writeIframe:function(){this.iframe.onload=this.iFrameOnLoad.bind(this);var t=this.iframe.contentWindow.document;t.open(),t.write('<script type="text/javascript" src="'.concat(this.buildFallbackURL(),'"><\/script>')),t.close(),t.onclick=this._onClick.bind(this)},iFrameOnLoad:function(){var t=(0,_.default)(this.iframe.contentWindow.document.body);(0,_.default)("div",t).length>0&&this.model.set("d2dLoaded",!0)},buildFallbackURL:function(){return"".concat(this.model.get("components.D2DFallbackView.location"),"?")+"oid=15"+"&width=".concat(this.model.get("components.D2DFallbackView.width"))+"&height=".concat(this.model.get("components.D2DFallbackView.height"))+"&pubid=".concat(this.pubId)+"&tagid=".concat(this.pubTagId)+"&pstn=".concat(this.model.get("components.D2DFallbackView.pstn"))+"&cirf=".concat(this.model.get("referrer"))+"&noaop=1&revmod=INSERT_CONTENT_TYPE&encoded=1&cb=INSERT_CACHEBUSTER&keywords=INSERT_COMMA_SEPARATED_KEYWORDS&urlonly=1&callback=document.write"},hide:function(t){this.log.info("D2D hide:",t),t?this.$el.css({display:"none"}):this.$el.css({display:"block"})},show:function(){this.$el.css({display:"block"})},_onClick:function(t){this.isTrusted=!0,t.isTrusted?window.setTimeout(this._onTimeoutEnd.bind(this),1e3*this.model.get("clickTestSeconds")):Al.firePixel(this.model.getPixel("pixels.D2DClickSuspicious"),"Suspicious D2DClick")},_onTimeoutEnd:function(){Vr(this.model)?Al.firePixel(this.model.getPixel("pixels.D2DClickSuspicious"),"Suspicious D2DClick"):Al.firePixel(this.model.getPixel("pixels.D2DClick"),"D2DClick")},_customize:function(){var t=this.model.get("components.D2DFallbackView.additionalCss");this.$el.css(Al.toCssObj(t))},updateD2D:function(t,e){this.iframe&&this.pubId!=t&&this.pubTagId!=e&&(this.pubId=t,this.pubTagId=e,this._writeIframe())},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide(!0)},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide(!0)}}),i(9836),'<div id="_cm-css-reset" class="_cm-repeat-div"> <div class="_cm-repeat-view-wrapper"> <div class="_cm-repeat-buttons-wrapper"> <img class="_cm-repeat-button"/> <img class="_cm-repeat-button-hover"/> </div> <div class="_cm-learn-more-buttons-wrapper"> <img class="_cm-learn-more-button"/> <img class="_cm-learn-more-button-hover"/> </div> </div> </div> '),Ol=i(2384),Cl=w().View.extend({className:"_cm-loading",id:"_cm-css-reset",initialize:function(t){this.log=new r.Z({unitType:"Component",className:"LoadingView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),t.globalModel&&(this.globalModel=t.globalModel),this.container=t.container,this.isShowReplayScreen=t.isStartWithReplay,this.isReplayable=t.isReplayable,this._createStatesAction(),this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(this.model,"change:adQState",this._onAdStateChange.bind(this,this.adStateActions)),this.listenTo(this.model,"change:adManagerState",this._onAdStateChange.bind(this,this.getAdStateActions)),this.model.on("change:viewTopComponent",this._toggleLoadingVisibility,this),this.model.on("change:repeatState",this._onReplayAdShowing,this),this.globalModel&&this.listenTo(this.globalModel,"change:adManagerState",this._onGlobalModelAdStateChange.bind(this,this.getAdStateActions))},_createStatesAction:function(){this.adStateActions={q0:this._onAdPlaying.bind(this),completed:this._onVideoComplete.bind(this),stopped:this._stop.bind(this)},this.getAdStateActions={stopped:this._stop.bind(this)}},_onGlobalModelAdStateChange:function(t,e,i){if(i==ct.adManagerState.stopped){var n=t[i];n&&n()}},_onAdStateChange:function(t,e,i){var n=t[i];n&&n()},render:function(){this.$el.append('<div class="_cm-loading-div"></div> '),this.loadingDiv=this.$el.find("._cm-loading-div"),"css"==this.model.get("components.Loading.type")?this.loadCss():"img"==this.model.get("components.Loading.type")&&this.loadImage(),this._applyAdditionalCss(),this.isShowReplayScreen&&this.$el.css("background","transparent"),this.$el.hide(),this.container.appendChild(this.el),this._renderReapet(),this.currentActiveImage=this.innerDisplay},_renderReapet:function(){this.repeatEl=(0,_.default)(El),this._setBackground(),this._setRepeatIcon(),this.learnMoreWrapper=this.repeatEl.find("._cm-learn-more-buttons-wrapper"),this.learnMoreWrapper.hide(),this.model.get("renderLearnMore")&&this._setLearnMoreIcon(),this.repeatEl.hide(),this.loadingDiv.append(this.repeatEl)},_setRepeatIcon:function(){this.repeatViewWrapper=this.repeatEl.find("._cm-repeat-view-wrapper"),this.repeatButtonsWrapper=this.repeatEl.find("._cm-repeat-buttons-wrapper");var t,e,i=this.repeatEl.find("._cm-repeat-button"),n=this.repeatEl.find("._cm-repeat-button-hover");this._isTranslationExist()?(t=this.model.get("components.Repeat.replayIconByLang"),e=this.model.get("components.Repeat.replayHoverIconByLang")):(t=this.model.get("components.Repeat.replayIcon"),e=this.model.get("components.Repeat.replayHoverIcon")),this._setButtonSrc(i,n,t,e)},_setLearnMoreIcon:function(){var t,e,i=this.repeatEl.find("._cm-learn-more-button"),n=this.repeatEl.find("._cm-learn-more-button-hover");this._isTranslationExist()?(t=this.model.get("components.Repeat.learnMoreIconByLang"),e=this.model.get("components.Repeat.learnMoreHoverIconByLang")):(t=this.model.get("components.Repeat.learnMoreIcon"),e=this.model.get("components.Repeat.learnMoreHoverIcon")),this._setButtonSrc(i,n,t,e),this.model.get("adClickThroughUrl")?this.repeatEl.click(this._onLearnMoreClick.bind(this)):this.listenTo(this.model,"change:adClickThroughUrl",this._updateLearnMoreUrl)},_isTranslationExist:function(){return this.model.get("components.Repeat.isTranslateText")&&this.model.get("language")&&Ol[this.model.get("language").toUpperCase()]},_setButtonSrc:function(t,e,i,n){t.attr("src",i),e.attr("src",n)},_setBackground:function(){var t=this.model.get("components.Repeat.backgroundImage");this.repeatEl.css("background-image",'url("'+t+'") !important')},loadCss:function(){var t=document.createElement("div");t.className="_cm-loading-icon",this.loadingDiv.append(t),this.innerDisplay=(0,_.default)(t)},loadImage:function(){var t=document.createElement("img");t.src=this.model.get("components.Loading.imgUrl"),t.className="_cm_loader_img",this.loadingDiv.append(t),this.innerDisplay=(0,_.default)(t)},hide:function(){this.isRepeatShowing=!1,this.$el.hide(),this._setModel("loadingViewState",ct.loadingViewState.hiding)},show:function(){this.isShowReplayScreen&&this._showRe(),this.$el.show(),this._setLoadingViewSize(this.currentActiveImage.width(),this.currentActiveImage.height()),this._setModel("loadingViewState",ct.loadingViewState.showing)},showRepeat:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._stop(t),this.globalModel.increaseCounter("repeatShown")},_onRepeatClick:function(t){t.stopPropagation(),this.log.info("User click"),this.clickEventRegistered=!1,this._setModel("loadingViewState",ct.loadingViewState.clicked),this.repeatEl.hide(),this.innerDisplay.show(),this.currentActiveImage=this.innerDisplay,this._setLoadingViewSize(this.currentActiveImage.width(),this.currentActiveImage.height())},_onLearnMoreClick:function(t){ri().clickThru.call(this,this.model.get("adClickThroughUrl")),this._triggerModel("change:learnMoreClick",this.learnMoreWrapper),this.model.increaseCounter("learnMoreWasClicked",!0)},_onAdPlaying:function(){this.hide()},_onVideoComplete:function(){var t=this.model.get("activeAdData");this.model.get("displayFiller.betweenAds")!==e().DISPLAY_FILLER.BETWEEN_ADS.CONTENT&&t&&!t.singleAd&&this.show()},_stop:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.model.get("isAdClosedByTimer")||this.model.get("closeState")||(this.clickEventRegistered||(this.repeatButtonsWrapper.one("click",this._onRepeatClick.bind(this)),this.clickEventRegistered=!0),this.show(),this.innerDisplay.hide(),this.currentActiveImage=this.repeatEl,this._setLoadingViewSize("auto","auto"),this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.isReplayable||this.repeatButtonsWrapper.hide(),t&&this.repeatViewWrapper.addClass("_cm-repeat-view-wrapper-detached"),this.repeatEl.show())},_showRe:function(){this.isRepeatShowing||(this.innerDisplay.hide(),this.clickEventRegistered||(this.repeatButtonsWrapper.one("click",this._onRepeatClick.bind(this)),this.clickEventRegistered=!0),this.currentActiveImage=this.repeatEl,this._setLoadingViewSize("auto","auto"),this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.isReplayable||this.repeatButtonsWrapper.hide(),this.repeatEl.show(),this.isRepeatShowing=!0)},_setLoadingViewSize:function(t,e){this.loadingDiv.css({width:t,height:e})},_setModel:function(t,e){this.globalModel&&this.globalModel.set(t,e),this.model.set(t,e)},_triggerModel:function(t,e){this.globalModel&&this.globalModel.trigger(t,e),this.model.trigger(t,e)},_applyAdditionalCss:function(){var t=this.model.get("additionalCss");t&&((t["z-index"]||t.zIndex)&&this.$el.css({"z-index":t["z-index"]}))},_updateLearnMoreUrl:function(){this.model.get("adClickThroughUrl")&&(this.repeatEl.click(this._onLearnMoreClick.bind(this)),this.learnMoreWrapper.show())},_toggleLoadingVisibility:function(){var t=this.model.get("viewTopComponent");this.log.info("_onTopComponentChange",t),t===e().FLOATING_VIEW_TOP_COMPONENT.loading?this.show():this.hide()},_onReplayAdShowing:function(){this.model.get("repeatState")===ct.repeatState.showing&&this.hide()},resize:function(t){this._isLoadingViewDisplayed()&&this.loadingDiv.css(t)},onAttach:function(){this._isLoadingViewDisplayed()&&this.repeatViewWrapper.removeClass("_cm-repeat-view-wrapper-detached")},_isLoadingViewDisplayed:function(){return this.model.get("loadingViewState")===ct.loadingViewState.showing}}),kl=i(9288),Il=i(1999),Rl=i(9831),Dl=(kl.View.extend({events:{"click ._cm-opt-button":"toggleDialog","click ._cm-cancel":"hideDialog","click ._cm-submit":"submitDialog"},id:"_cm-opt-out-view",className:"_cm-opt-out-view",initialize:function(t){this.log=new r.Z({unitType:t.unitType,className:"optOut",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),this.container=t.container,this.render(),this.componentsVisibilityListener=t.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.$el.append('<div class="_cm-opt-out"> <div class="_cm-opt-button"></div> <div class="_cm-opt-dialog"> <div id="" class="_cm-opt-message">Never show me Video ads</div> <textarea class="_cm-opt-text" placeholder="What was the problem with this ad?"></textarea> <div> <button type="button" class="_cm-cancel">Cancel</button> <button type="button" class="_cm-submit">Send</button> </div> </div> </div> '),(0,_.default)(this.container).prepend(this.$el),this.ui={},this.ui.Dialog=this.$el.find("._cm-opt-dialog"),this.hideDialog()},toggleDialog:function(){"none"===this.ui.Dialog.get(0).style.display?this.showDialog():this.hideDialog()},showDialog:function(){this.$el.trigger("cm:optout:dialog:show"),this.ui.Dialog.show()},hideDialog:function(){this.$el.trigger("cm:optout:dialog:hide"),this.ui.Dialog.hide()},submitDialog:function(){var t=this.el.querySelector("._cm-opt-text").value,e=this.model.getPixel("pixels.optOutNever")+"&userComplaint="+t;Il.firePixel(e,"Never OptOut"),this.hideDialog(),this.model.set("state",this.model.STATE.OPT_OUT),this.model.set("closeState",Rl.closeState.terminate),this.$el.trigger("cm:optout:submit")},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()}}),i(9288)),Vl=i(1999),Nl=Dl.View.extend({errorCount:0,events:{"click ._cm-playlist-item":"_onItemClick"},initialize:function(t){this.model=t.model,this.log=new r.Z({unitType:"playlist-item",className:"PlayListView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=t.container,this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(this.model,"change:active",this.setActive)},render:function(){var t={image:this.model.get("image"),title:this.model.get("title")},e=Vl.template('<li class="_cm-playlist-item"> <img class="_cm-playlist-img" src="{{image}}"/> <span class="_cm-playlist-text">{{title}}</span> </li> ')(t);this.$el.append(e),(0,_.default)(this.container).append(this.$el),this._item=this.$el.find("._cm-playlist-item")},_onItemClick:function(t){this.model.set("clicked",!0)},setActive:function(t,e){e?this._item.addClass("active"):this._item.removeClass("active")}}),xl=i(6042),jl=i.n(xl),Ml=(i(9306),i(1999),w().View.extend({errorCount:0,className:"_cm-playlist",initialize:function(t){this.log=new r.Z({unitType:"playlist",className:"PlayListView"}),this.playListCollection=new(jl()),this.container=t.container,this._playlist=t.playlist,this._height=t.height||350,this._itemCount=parseInt(this._height/74),this._itemCount=Math.min(this._playlist.length,this._itemCount),this._playlist=this._playlist.slice(0,this._itemCount),this._height=Math.min(this._height,74*this._itemCount),this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(w(),"change:player:content",this._onContentChanged),this.listenTo(this.model,"change:state",this._onStateChange),this.listenToOnce(this.playListCollection,"change:clicked",this._itemSelected)},render:function(){this.$el.append('<ul class="_cm-playlist-list"></ul> '),(0,_.default)(this.container).append(this.$el),this._playlist_list=this.$el.find("._cm-playlist-list"),this.$el.css({height:parseInt(this._height)})},_setPlayList:function(){this.playListCollection.length>0||(this.playListCollection.add(this._playlist),this.playListCollection.forEach((function(t){new Nl({model:t,container:this._playlist_list})}),this),this.playListCollection.first().set("active",!0))},_onStateChange:function(t,e){if(e===t.STATE.PLAYER_READY)this._setPlayList()},_itemSelected:function(t){t.set("clicked",!1),this._playItem(t),this.listenToOnce(this.playListCollection,"change:clicked",this._itemSelected)},_playItem:function(t){if(!this._playlist_list.hasClass("unclickable")){var e=this.playListCollection.findWhere({active:!0});e&&e.set("active",!1),t.set("active",!0),this.$el.trigger("_cm-unit-play",t.attributes)}},_onContentChanged:function(t){this.log.important("On content changed",t);var e=this.playListCollection.findWhere({active:!0});e&&e.set("active",!1),(e=this.playListCollection.findWhere({id:t.id}))&&e.set("active",!0)},playNext:function(){var t=this.playListCollection.findWhere({active:!0}),e=this.playListCollection.indexOf(t)+1;e>=this._itemCount&&(e=0),this._playItem(this.playListCollection.at(e))},setUnclickable:function(t){t?this._playlist_list.addClass("unclickable"):this._playlist_list.removeClass("unclickable")}}),i(1999)),Ll=i(2384),Bl=w().View.extend({className:"_cm-repeat",id:"_cm-css-reset",initialize:function(t){this.log=new r.Z({unitType:"Component",className:"RepeatView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=t.container,this.active=!1,this._createStatesAction(),this._bindEvents(),this._render()},_render:function(){this.repeatEl=(0,_.default)(El),this._setRepeatIcon(),this.learnMoreWrapper=this.repeatEl.find("._cm-learn-more-buttons-wrapper"),this.learnMoreWrapper.hide(),this.model.get("renderLearnMore")&&this._setLearnMoreIcon(),this._setBackground(),this.$el.hide(),this.$el.append(this.repeatEl),this.container.appendChild(this.el)},_setRepeatIcon:function(){this.repeatWrapper=this.repeatEl.find("._cm-repeat-buttons-wrapper");var t,e,i=this.repeatEl.find("._cm-repeat-button"),n=this.repeatEl.find("._cm-repeat-button-hover");this._isTranslationExist()?(t=this.model.get("components.Repeat.replayIconByLang"),e=this.model.get("components.Repeat.replayHoverIconByLang")):(t=this.model.get("components.Repeat.replayIcon"),e=this.model.get("components.Repeat.replayHoverIcon")),this._setButtonSrc(i,n,t,e),this.repeatWrapper.click(this._onClick.bind(this))},_setLearnMoreIcon:function(){var t,e,i=this.repeatEl.find("._cm-learn-more-button"),n=this.repeatEl.find("._cm-learn-more-button-hover");this._isTranslationExist()?(t=this.model.get("components.Repeat.learnMoreIconByLang"),e=this.model.get("components.Repeat.learnMoreHoverIconByLang")):(t=this.model.get("components.Repeat.learnMoreIcon"),e=this.model.get("components.Repeat.learnMoreHoverIcon")),this._setButtonSrc(i,n,t,e),this.model.get("adClickThroughUrl")?this.learnMoreWrapper.click(this._onLearnMoreClick.bind(this)):this.listenTo(this.model,"change:adClickThroughUrl",this._updateLearnMoreUrl)},_isTranslationExist:function(){return this.model.get("components.Repeat.isTranslateText")&&this.model.get("language")&&Ll[this.model.get("language").toUpperCase()]},_setButtonSrc:function(t,e,i,n){t.attr("src",i),e.attr("src",n)},_setBackground:function(){var t=this.model.get("components.Repeat.backgroundImage");this.repeatEl.css("background-image",'url("'+t+'") !important')},hide:function(){this.$el.hide(),this.active=!1,this.isSpinning=!1,this.model.set("repeatState",ct.repeatState.hiding)},show:function(){this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.repeatWrapper&&this.model.get("dontRenderRepeatButton")&&this.repeatWrapper.hide(),this.$el.show(),this.active=!0,this.model.set("repeatState",ct.repeatState.showing)},_bindEvents:function(){this.listenTo(this.model,"change:adQState",this._onAdStateChange)},_onClick:function(t){t.stopPropagation(),this.isSpinning||this.model.getPixel&&Ml.firePixel(this.model.getPixel("pixels.repeatClick"),"repeat click Pixel"),this.model.set("repeatState",ct.repeatState.clicked),this.trigger("cm:repeat:click")},_createStatesAction:function(){this.adStateActions={q0:this._onAdPlaying.bind(this),completed:this._onVideoComplete.bind(this),repeating:this._onAdPlaying.bind(this)}},_onAdStateChange:function(t,e){var i=this.adStateActions[e];i&&i()},_onAdPlaying:function(){var t=this;setTimeout((function(){t.hide()}),100)},_onVideoComplete:function(){this.model.get("isReplayAd")&&this.show()},_onLearnMoreClick:function(t){Ml.clickThru.call(this,this.model.get("adClickThroughUrl")),this.model.increaseCounter("learnMoreWasClicked",!0)},_updateLearnMoreUrl:function(){this.model.get("adClickThroughUrl")&&(this.learnMoreWrapper.click(this._onLearnMoreClick.bind(this)),this.learnMoreWrapper.show())},addAdditionalCss:function(t){(0,_.default)(this.repeatEl).addClass(t)}}),Fl=i(9288),Ul=(i(1999),i(2023)),Wl=(Fl.View.extend({className:"_cm-timer",initialize:function(t){this.log=new r.Z({unitType:t.unitType,className:"timerView",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),this.container=t.container,this._time=Number(t.time)||Number(this.model.get("components.TimerView.time")),this._isHide=t.isHide,this._stepTime=1,this.render()},render:function(){this.$el.append(Ul),this.hide(),this.container.appendChild(this.el),this.$el.find("._cm-timer-circle ._cm-timer-mask, ._cm-timer-circle ._cm-timer-fill").css("transition","transform "+this._stepTime+"s linear"),this._innerText=this.$el.find("._cm-timer-inset>span")},startTimer:function(){this.log.info("Timer start"),0!==this._time?(this._currentTimer=this._stepTime,this._innerText.text(parseInt(this._time)),this._setDegree(180/this._time*this._currentTimer),window.setTimeout(this._timerUpdate.bind(this),1e3*this._stepTime)):this._finish()},_timerUpdate:function(){if(this._innerText.text(parseInt(this._time-this._currentTimer)),this._currentTimer+=this._stepTime,this._currentTimer>this._time)this._finish();else{var t=180/this._time*this._currentTimer;this._setDegree(t),window.setTimeout(this._timerUpdate.bind(this),1e3*this._stepTime)}},_setDegree:function(t){this.$el.find("._cm-timer-circle ._cm-timer-fill, ._cm-timer-circle ._cm-timer-mask._cm-timer-full").css("transform","rotate("+t+"deg)"),this.$el.find("._cm-timer-circle ._cm-timer-fill._cm-timer-fix").css("transform","rotate("+2*t+"deg)")},_finish:function(){this._isHide&&this.hide(),this.$el.trigger("cm:timer:finish")},hide:function(){this.$el.hide()}}),i(1999)),Hl="._cm-branding-view-title-text",$l="._cm-branding-view-branding-text",zl=w().View.extend({className:"_cm-branding-title",id:"_cm-css-reset",events:{},initialize:function(t){this.log=new r.Z({unitType:"Component",className:"BrandingTitleView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=t.container,this.render(),this.bindEvents()},bindEvents:function(){this.model.listenTo(this.model,"change:customization.titleContainer.branding",this._customize.bind(this)),this.model.listenTo(this.model,"change:customization.titleContainer.branding.displayState",this._onDisplayStateChange.bind(this))},render:function(){this.template=Wl.template('<span class="_cm-branding-view-title-text">{{titleContainer.titleText}}</span> <span class="_cm-branding-view-branding-text">{{titleContainer.BrandingText}}</span> '),this.$el.append(this.template(this.model.attributes)),this.ui={title:this.$el.find(Hl),branding:this.$el.find($l)},this._customize(),this.container.appendChild(this.el),this.model.get("isFitToSize")&&this._fitToSize()},_customize:function(){var t=this.model.get("customization.titleContainer.title"),e=this.model.get("customization.titleContainer.branding");t&&((t=Wl.toCssObj(t)).height="auto",this.ui.title.css(t)),e&&((e=Wl.toCssObj(e)).height="auto",this.ui.branding.css(e))},_fitToSize:function(){var t=(0,_.default)(this.container).height(),e=this.model.get("videoPlaceholderSize");t&&e&&(Number(e.height)+this.$el.height()>=t?Number(e.height)+this.ui.title.height()<t?this._hideDescription():this._hide():this._show())},_hide:function(){this.$el.hide()},_show:function(){this.$el.show()},_onDisplayStateChange:function(t){t===ct.brandingDisplayState.show?this._showAndFitToSize():this._hide()},_showAndFitToSize:function(){this._show(),this._fitToSize()},_hideDescription:function(){this.ui.branding.hide()}}),ql=i(9288),Gl=i(1999),Yl=i(3474),Kl=ql.View.extend({events:{click:"_openAdChoice"},className:"_cm-ad-choice",initialize:function(e){this.log=new r.Z({unitType:this.model.get("unitType"),className:"AdChoice",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.log.info("Ad Choice ".concat(e.type," initialized.")),this.container=e.container,this.parentPlaceholder=e.parent,this.placementType=e.type,this.shouldHandelDetachAttach=t.UNIT_TYPES[this.model.get("unitType")]===t.UNIT_TYPES.FEED_MANAGER&&this.placementType!==t.AD_CHOICE_TYPE.TITLE,this.placementModel=this._getAdChoicePlacementModel(e.type),this.titlePosition=this.model.get("components.adChoice.position"),this.icon=this.model.get("components.adChoice.icon"),this._translateText(),this._bindEvents(),this.render(),this._firstVideoViewStateHandle(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},forceShowAdChoice:function(){this._show()},render:function(){this.template=Gl.template('<a class="_cm-ad-choice-text" target="_blank">{{text}}</a> <a class="_cm-ad-choice-logo" target="_blank"></a> '),this.$el.append(this.template(this.placementModel)),this.$el.children("._cm-ad-choice-logo").css({background:"url("+this.icon+") no-repeat"}),this.placementModel.isActive&&(this.placementModel.adViewStyle&&this.$el.css(Gl.toCssObj(this.placementModel.adViewStyle)),this.$el.find("._cm-ad-choice-text").css(Gl.toCssObj(this.placementModel.style)),this.$el.find("._cm-ad-choice-logo").css(Gl.toCssObj(this.placementModel.logoStyle))),this._setAdChoiceUrl(),this._alignTitle(),(0,_.default)(this.container).append(this.el)},_bindEvents:function(){this.shouldHandelDetachAttach&&(this.log.info("Ad Choice ".concat(this.placementType," is listening to videoViewState")),this.listenTo(this.model,"change:videoViewState",this._handleVideoViewState.bind(this))),this.listenTo(this.model,"change:adPlayingWithAdChoice",this._onAdPlayingWithAdChoiceChange.bind(this)),this.listenTo(this.model,"change:content.isContentPlay",this._onAdPlayingWithAdChoiceChange.bind(this)),this.listenTo(this.model,"change:adjustWideFeed",this._onAdjustWideFeed.bind(this));var e=this.model.get("wurfl.browser.name");e!==t.BROWSER.IE&&e!==t.BROWSER.EDGE||this.listenTo(this.model,"change:isExpandEnded",this._onExpandEnded.bind(this))},_onExpandEnded:function(){this.log.info("onExpandEnded - IE or Edge detected");var t=this;this.$el.hide(),window.setTimeout((function(){t.$el.show()}),0)},_getAdChoicePlacementModel:function(e){var i;switch(e){case t.AD_CHOICE_TYPE.TITLE:i=this.model.get("components.adChoice.title");break;case t.AD_CHOICE_TYPE.VIDEO_AD:i=this.model.get("components.adChoice.videoAd");break;case t.AD_CHOICE_TYPE.SLIDER:i=this.model.get("components.adChoice.slider");break;default:i={text:"",style:{},logoStyle:{}}}return i},_getSCardSelector:function(){var e;switch(t.UNIT_TYPES[this.model.get("unitType")]){case t.UNIT_TYPES.WIDGET_ITEM:e='*[data-placement-name="'+this.model.get("placement")+'"]';break;case t.UNIT_TYPES.FEED_MANAGER:e=".tbl-feed-container .trc-content-sponsored";break;case t.UNIT_TYPES.INLINE_INSTREAM:case t.UNIT_TYPES.INLINE:case t.UNIT_TYPES.SLIDER_INSTREAM:e=".trc_rbox_container .trc-content-sponsored";break;default:e=""}return e},_setAdChoiceUrl:function(){this._selector=this._getSCardSelector();var t=this._extractUrl(this._selector);(0,_.default)("._cm-ad-choice-text",this.$el).attr("href",t),(0,_.default)("._cm-ad-choice-logo",this.$el).attr("href",t)},_extractUrl:function(t){var e,i,n=(0,_.default)(t)[0];n?((0,_.default)(window).width()<=768||this.model.get("isMobile")?(e=(0,_.default)(n).find("a.trc_mobile_adc_link"),this._isOpenNewTab=!0):e=(0,_.default)(n).find("a.trc_desktop_adc_link"),i=e.length>0?(0,_.default)(e[0]).attr("href").replace(/(Card)(\D*)(\d+)/,"Card "+this.model.get("cardNumber")):this.model.get("components.adChoice.fallbackUrl")):(((0,_.default)(window).width()<=768||this.model.get("isMobile"))&&(this._isOpenNewTab=!0),i=this.model.get("components.adChoice.fallbackUrl"));return i},_alignTitle:function(){if(this.placementType===t.AD_CHOICE_TYPE.TITLE&&this._selector){var e=getComputedStyle((0,_.default)(this._selector)[0]);e&&"rtl"===e.direction&&(0,_.default)(this.container).css("text-align","left !important")}},_firstVideoViewStateHandle:function(){t.UNIT_TYPES[this.model.get("unitType")]===t.UNIT_TYPES.FEED_MANAGER&&this.placementType!==t.AD_CHOICE_TYPE.TITLE&&this._handleVideoViewState()},_handleVideoViewState:function(){switch(this.model.get("videoViewState")){case ct.videoViewState.attached:this._onAttach();break;case ct.videoViewState.detached:this._onDetach()}},_onAttach:function(){switch(this.placementType){case t.AD_CHOICE_TYPE.VIDEO_AD:this._show();break;case t.AD_CHOICE_TYPE.SLIDER:this._hide()}},_onDetach:function(){switch(this.placementType){case t.AD_CHOICE_TYPE.VIDEO_AD:this._hide();break;case t.AD_CHOICE_TYPE.SLIDER:this._show()}this._updateAdChoicesVisibility()},_openAdChoice:function(t){this._firePixel("pixels.adChoice","adChoice click pixel."),window.TRC&&(this._isOpenNewTab||window.TRC.aboutUs&&window.TRC.aboutUs.open&&window.TRC.aboutUs.open(t))},_firePixel:function(t,e){var i=this.model.getPixel(t);Gl.firePixel(i,e)},_show:function(){this.placementModel.isActive&&!this.model.get("adPlayingWithAdChoice")&&this.$el.show(),this._validateComponentVisibilityStatus(!0)},_hide:function(){this.placementModel.isActive&&this.$el.hide(),this._validateComponentVisibilityStatus(!1)},_validateComponentVisibilityStatus:function(t){var e=this.componentsVisibilityListener&&this.model.get(this.componentsVisibilityListener);void 0!==e&&t!==e&&this.model.set(this.componentsVisibilityListener,t)},_updateAdChoicesVisibility:function(){this.model.get("adPlayingWithAdChoice")&&this.placementType!==t.AD_CHOICE_TYPE.TITLE?this._hide():this._show()},_onAdPlayingWithAdChoiceChange:function(){this.model.get("content.isContentPlay")&&!this.model.get("components.adChoice.isActiveOnContent")?this._hide():this.shouldHandelDetachAttach?this._handleVideoViewState():this._updateAdChoicesVisibility()},_onAdjustWideFeed:function(){var e=this.model.get("adjustWideFeed");this.titlePosition===t.TITLE_POSITION.BELOW&&(e?(0,_.default)(this.parentPlaceholder).addClass("_cm-wide-feed-title-below"):(0,_.default)(this.parentPlaceholder).removeClass("_cm-wide-feed-title-below"))},_translateText:function(){this.model.get("components.adChoice.isTranslateText")&&this.model.get("language")&&this.model.set("components.adChoice.videoAd.text",Yl[this.model.get("language").toUpperCase()])},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this._hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this._show():this._hide()}});i(9288);var Ql=i(9288),Zl=i(1999),Xl={display:"inline !important"},Jl={display:"none !important"},tc={transition:"width 2000ms !important",width:"32px !important"},ec={width:"32px !important"},ic=Ql.View.extend({className:"_cm-volume-area",id:"_cm-css-reset",events:{click:"_toggleVolume"},initialize:function(t){this._setInitialParameters(t),this._isHandleDetach(),this._hasCloseButton(),this._initVolumeState(),this._createStatesAction(),this._setMinimizeOnClickCallback(),this._bindEvents(),this.render(),this.log.info("Volume Button initialized.")},_bindEvents:function(){this.listenTo(this.currModel,"change:volumeMuted",this._onVolumeChange.bind(this)),this.listenTo(this.currModel,"startVolumeAnimation",this._minimizeAfterRender.bind(this)),this._handleDetach&&this.listenTo(this.model,"change:videoViewState",this._handleVideoViewState.bind(this)),this.currModel.on("lastVolumeStateCheck",this._onLastVolumeStateCheck,this),this.model.on("change:viewTopComponent",this.setButtonVisible,this),this.listenTo(this.model,"change:adQState",this._onAdStateChange),this.model.on("showVolumeButtonOnBackFromSwap",this.show,this)},_setComponentsVisibilityListener:function(){this.model.on("change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange,this),this.model.get(this.componentsVisibilityListener)||this.hide()},render:function(){this._initTemplate(),this._setPosition(),this._styleCustomization(),this._checkIfMinimized(),this._renderComponent()},_initTemplate:function(){var t=Zl.template('<div class="_cm-volume-border"> <svg class="_cm-volume-mute" data-name="—ÎÓÈ_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 351.22 266.75"> <defs> <style>.cls-1{fill:#fff}</style> </defs> <g id="_Group_" data-name="&lt;Group&gt;"> <g id="_Group_2" data-name="&lt;Group&gt;"> <path class="cls-1" d="M338,185.84c-.48-3.15-1.39-6.11-5.31-7.4H330c-3.63.93-6.33,3-8.93,5.29L249.59,246H170.26c-7.93,0-14.35,5.59-14.35,12.5V370.1c0,6.9,6.42,12.5,14.35,12.5h85.1l66.91,58.27a19,19,0,0,0,6,3.71c3.92,1.44,7.13.29,8.73-3.12a14.33,14.33,0,0,0,1.22-6.29V189.22A22.39,22.39,0,0,0,338,185.84Z" transform="translate(-155.91 -178.44)"/> </g> </g> <path class="cls-1" d="M486.13,381.62a20.93,20.93,0,0,1-14.85-6.15l-97.62-97.62a21,21,0,1,1,29.69-29.7L501,345.77a21,21,0,0,1-14.85,35.85Z" transform="translate(-155.91 -178.44)"/> <path class="cls-1" d="M388.5,381.62a21,21,0,0,1-14.84-35.85l97.62-97.62a21,21,0,1,1,29.7,29.7l-97.63,97.62A20.93,20.93,0,0,1,388.5,381.62Z" transform="translate(-155.91 -178.44)"/> </svg> <svg class="_cm-volume-unmute" data-name="—ÎÓÈ_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 311.81 266.75"> <defs> <style>.cls-1{fill:#fff}</style> </defs> <g id="_Group_" data-name="&lt;Group&gt;"> <path id="_Path_" data-name="&lt;Path&gt;" class="cls-1" d="M465.85,290.12A124.1,124.1,0,0,0,453.19,253a127.55,127.55,0,0,0-21.66-29.51c-3.38-3.47-7.4-5.23-12.25-4.6a13.27,13.27,0,0,0-11.5,9.27c-1.87,5.38-.66,10.26,3.23,14.43,1,1.05,2,2,2.95,3.1a96.67,96.67,0,0,1,25.09,55.19,95.28,95.28,0,0,1-1.17,29.52,96.57,96.57,0,0,1-26.52,50.23,13.74,13.74,0,0,0-4.23,12.12,13.25,13.25,0,0,0,9.2,11.27c5.3,1.85,10.15.74,14.31-3.08.82-.74,1.57-1.56,2.33-2.36a125,125,0,0,0,34.74-87.88A131.18,131.18,0,0,0,465.85,290.12Z" transform="translate(-155.91 -178.44)"/> <path id="_Path_2" data-name="&lt;Path&gt;" class="cls-1" d="M420.23,307.35a87,87,0,0,0-6.32-28.82A88,88,0,0,0,395,249.69a14,14,0,0,0-24.29,11.22,16.39,16.39,0,0,0,4.73,8.92c13.86,14.79,19.22,32.3,16.05,52.27a58.5,58.5,0,0,1-16.83,32.54A14,14,0,0,0,388.48,378c3.13-.88,5.44-2.88,7.6-5.18,16.05-17.16,23.94-37.57,24.15-61C420.23,310.31,420.29,308.83,420.23,307.35Z" transform="translate(-155.91 -178.44)"/> <path id="_Path_3" data-name="&lt;Path&gt;" class="cls-1" d="M338,185.84c-.48-3.15-1.39-6.11-5.31-7.4H330c-3.63.93-6.33,3-8.93,5.29L249.59,246H170.26c-7.93,0-14.35,5.59-14.35,12.5V370.1c0,6.9,6.42,12.5,14.35,12.5h85.1l66.91,58.27a19,19,0,0,0,6,3.71c3.92,1.44,7.13.29,8.73-3.12a14.33,14.33,0,0,0,1.22-6.29V189.22A22.39,22.39,0,0,0,338,185.84Z" transform="translate(-155.91 -178.44)"/> </g> </svg> <div class="_cm-volume-text">{{expandedText}}</div> </div> ')(this._settings);this.$el.append(t)},_renderComponent:function(){var e=this,i=this.model.get("wurfl.browser.name");i===t.BROWSER.IE||i===t.BROWSER.EDGE?setTimeout((function(){(0,_.default)(e.container).append(e.el)}),200):(0,_.default)(this.container).append(this.el)},_setInitialParameters:function(e){this.log=new r.Z({unitType:this.model.get("unitType"),className:"volumeButtonView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.currModel=e.globalModel?e.globalModel:this.model,this._settings=this.model.get("components.volume"),this._isMuted=!0,this._unitType=t.UNIT_TYPES[this.model.get("unitType")],this._isAlwaysBottom=this.model.get("components.volume.isAlwaysBottom"),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},_initVolumeState:function(){void 0===this.currModel.get("volumeMuted")&&this.currModel.set("volumeMuted",!0)},_setMinimizeOnClickCallback:function(){this._minimizeOnClick=Zl.once(this._minimize.bind(this,tc))},_onLastVolumeStateCheck:function(){this._onVolumeChange()},_toggleVolume:function(){this._isMuted?(this._unMute(),this._fireUnmute()):(this._mute(),this._fireMute()),this._minimizeOnClick(),this.currModel.set("volumeUserInteraction",!0)},_mute:function(){this._showMute(),this._hideUnmute(),this._isMuted=!0},_unMute:function(){this._hideMute(),this._showUnmute(),this._isMuted=!1},_fireMute:function(){this.currModel.set("volumeMuted",!0),this.currModel.set("onUnMuteClicked",!1)},_fireUnmute:function(){this.currModel.set("volumeMuted",!1),this.currModel.set("onUnMuteClicked",!0)},_onVolumeChange:function(){this.currModel.get("volumeMuted")?this._mute():this._unMute()},_minimizeAfterRender:function(){this.currModel.get("volumeMustBeMinimized")?this._minimize(ec):setTimeout(function(){this._isMinimized||this._minimize(tc)}.bind(this),this._settings.timeToMinimize)},_minimize:function(t){(0,_.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border").css(t),this._isMinimized=!0,this.currModel.set("volumeMustBeMinimized",!0)},_hideMute:function(){(0,_.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(Jl)},_showMute:function(){(0,_.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(Xl)},_hideUnmute:function(){(0,_.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(Jl)},_showUnmute:function(){(0,_.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(Xl)},_setPosition:function(){this.hasCloseButton||this._isAlwaysBottom?this.$el.addClass("_cm-volume-area-bottom"):this.$el.addClass("_cm-volume-area-top"),this._handleDetach&&this._handleVideoViewState()},_isHandleDetach:function(){this._handleDetach=!1,this._unitType===t.UNIT_TYPES.FEED_MANAGER&&!1===this.model.get("hasCloseButton")&&!0===this.model.get("detachToSlider.hasCloseButton")&&(this._handleDetach=!0)},_hasCloseButton:function(){this._unitType!==t.UNIT_TYPES.FEED_MANAGER&&this._unitType!==t.UNIT_TYPES.INLINE_INSTREAM&&this._unitType!==t.UNIT_TYPES.MSN_WIDGET||(this.hasCloseButton=this.model.get("closeButton.hasCloseButton")),this._unitType!==t.UNIT_TYPES.WIDGET_ITEM&&this._unitType!==t.UNIT_TYPES.EXPANDABLE&&this._unitType!==t.UNIT_TYPES.EXPANDABLE_MOBILE||(this.hasCloseButton=this.model.get("components.CloseButtonView.hasCloseButton")),this._unitType,t.UNIT_TYPES.SLIDER_INSTREAM,this._unitType,t.UNIT_TYPES.EXPANDABLE},_handleVideoViewState:function(){if(!this._isAlwaysBottom){var t=this.model.get("videoViewState");t===ct.videoViewState.attached&&(this.$el.addClass("_cm-volume-area-top"),this.$el.removeClass("_cm-volume-area-bottom")),t===ct.videoViewState.detached&&this.hasCloseButton&&(this.$el.addClass("_cm-volume-area-bottom"),this.$el.removeClass("_cm-volume-area-top"))}},_styleCustomization:function(){this._settings.style&&(Zl.isEmpty(this._settings.style.border)||(0,_.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border").css(this._settings.style.border),Zl.isEmpty(this._settings.style.mute)||(0,_.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(this._settings.style.mute),Zl.isEmpty(this._settings.style.unmute)||(0,_.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(this._settings.style.unmute),Zl.isEmpty(this._settings.style.text)||(0,_.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-text").css(this._settings.style.text))},_checkIfMinimized:function(){this._unitType===t.UNIT_TYPES.FEED_MANAGER&&this.currModel.get("volumeMinimized")&&this._minimize(ec)},setButtonVisible:function(){this.log.info("_onTopComponentChange",this.model.get("viewTopComponent")),this.model.get("viewTopComponent")===t.FLOATING_VIEW_TOP_COMPONENT.video?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_createStatesAction:function(){this.adStateActions={q0:this.show.bind(this),completed:this.hide.bind(this),repeating:this.show.bind(this)}},_onAdStateChange:function(t,e){var i=this.adStateActions[e];i&&i()},_onComponentsVisibilityChange:function(){this.currModel.get(this.componentsVisibilityListener)?this.show():this.hide()}}),nc='<div class="_cm-ad-loading-progress-container"> <div class="_cm-ad-loading-progress-bar-container"> <div class="_cm-ad-loading-progress-title"> <span class="_cm-ad-loading-progress_title_span"></span> <span class="_cm-ad-loading-progress_percent_span">0%</span> </div> <div class="_cm-ad-loading-progress-bar"> <div class="_cm-ad-loading-progress-bar-loaded"></div> </div> </div> </div> ',rc=i(9288),oc=i(1999);rc.View.extend({className:"_cm-ad-loading-progress",id:"_cm-css-reset",initialize:function(t){this.model.set("progressLoaderInit",!0),this._setInitialParameters(t),this._bindEvents(),this.currModel.get("isFirstAdLoaded")&&(this._startWatchingViewPort(),this._show()),this.render(),this.log.info("ad-loading-progress initialize")},_bindEvents:function(){this.log.info("ad-loading-progress _bindEvents"),this.listenTo(this.currModel,"change:isFirstAdLoaded",this._onFirstAdLoaded.bind(this)),this.listenToOnce(this.currModel,"change:hasReadyAd",this._onAdImpression.bind(this)),this.listenTo(this.currModel,"ProgressLoaderRepositioned",this._restart.bind(this))},_setInitialParameters:function(t){this.log=new r.Z({unitType:this.model.get("unitType"),className:"adLoadingProgressView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.currModel=t.globalModel?t.globalModel:this.model,this.$el=(0,_.default)(this.el),this.viewPercent=this.currModel.get("components.adLoadingProgress.inViewPortEligibility")||100,this.loadingTimerTime=Number(this.currModel.get("components.adLoadingProgress.maxProgressTime"))||5e3,this.count=1,this.currModel.set("loaderCurrCount",this.count),this.progressTik=this.loadingTimerTime/50,this.showProgress=this.currModel.get("components.adLoadingProgress.showProgressBar")},render:function(){this._initTemplate(),this._customize(),this.model.get("eligiblePlaceholder")?this._renderComponent():this.model.once("change:eligiblePlaceholder",this._renderComponent.bind(this))},_renderComponent:function(){this.container=this.model.get("eligiblePlaceholder");var t={width:this.model.get("width")+3+"px",height:this.model.get("height")+2+"px"};this.$el.css(t),this.$el.css(this._getPosition(this.model.get("eligiblePlaceholder"))),(0,_.default)("body").append(this.el),this.$el.css(),(0,_.default)("._cm-ad-loading-progress_title_span").text(this.currModel.get("components.adLoadingProgress.title")),this.showProgress&&(0,_.default)("._cm-ad-loading-progress-container").css({display:"block"})},_initTemplate:function(){var t=oc.template(nc)(this._settings);this.$el.append(t),this.$loadingPercentElement=(0,_.default)("._cm-ad-loading-progress_percent_span")},_onFirstAdLoaded:function(){this.log.info("FirstAd _onFirstAdLoaded loaded"),this.currModel.get("isFirstAdLoaded")&&(this._startWatchingViewPort(),this._show())},_startWatchingViewPort:function(){this.listenTo(rc,"window:scroll:change",this._calculateViewPortIntersection.bind(this,!1));var t=this.$el.parent().height();this.$el.parent().height(t+1)},_calculateViewPortIntersection:function(){if(!this.stopWatchingViewPort){var t=oc.getViewPercent(this.el,this.$el.width(),this.$el.height(),this.currModel.get("scrollSelector"));this.log.info("currViewPercent: ",t||0),this.viewPercent<=t&&(this._startLoadingTimer(),this.stopWatchingViewPort=!0)}},_onAdImpression:function(){this.model.get("progressLoaderTimerReached")&&this.model.set("eligiblePlaceholder",!1),this.close()},_startLoadingTimer:function(){this.loadingTimer=window.setTimeout(function(){this.log.info("Loading timer progress reached"),this.currModel.set("progressLoaderTimerReached",!0),window.clearInterval(this.calculationInterval),this.calculationInterval=null}.bind(this),this.loadingTimerTime),this._startCalculation()},_startCalculation:function(){this.calculationInterval=window.setInterval(function(){this._calculateLoadingProgress(),(0,_.default)("._cm-ad-loading-progress-bar-loaded").css({width:"100%",transition:"width "+this.loadingTimerTime+"ms","transition-timing-function":"linear"})}.bind(this),this.progressTik)},_calculateLoadingProgress:function(){(0,_.default)("._cm-ad-loading-progress_percent_span").text(this.count+"%"),this.count<100&&(this.count+=2,this.currModel.set("loaderCurrCount",this.count))},_restart:function(){this.container=this.model.get("eligiblePlaceholder"),this._renderComponent(),this._hide(),this.currModel.set("progressLoaderTimerReached",!1),(0,_.default)("._cm-ad-loading-progress_percent_span").text("1%"),this.count=1,(0,_.default)("._cm-ad-loading-progress-bar-loaded").css({transition:"none",width:"0%"}),this.stopWatchingViewPort=!1,this._show()},_show:function(){this.$el.css({display:"flex"})},_hide:function(){this.$el.css({display:"none"})},close:function(){this.model.set("progressLoaderViewClosed",!0),this._hide(),window.clearInterval(this.calculationInterval),this.calculationInterval=null,this.loadingTimer&&(window.clearTimeout(this.loadingTimer),this.loadingTimer=null),this.stopListening(rc,"window:scroll:change"),this.model.set("components.adLoadingProgress.isActive".false)},_customize:function(){var t=this.model.get("components.adLoadingProgress.additionalCss");this.$el.css(oc.toCssObj(t))},_getPosition:function(t){var e=t.getBoundingClientRect(),i=document.body.getBoundingClientRect();return{top:e.top-i.top-1+"px",left:e.left+"px"}}});i(1999);i(1999);var sc=i(9288),ac=i(1999),lc=(sc.View.extend({events:{"click ":"_onClick"},initialize:function(t){this.log=new r.Z({unitType:t.unitType,className:"SkipAdButtonView",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),this.container=t.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=ga.L,this.componentsVisibilityListener=t.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){if(!this._rendered){if(this._rendered=!0,this._settings=this.model.get("components.skipAdButton"),this.model.get("components.skipAdButton.newDesign"))this.el.classList.add("_cm-skip-ad-vid-reel"),this.$el.append('Skip <svg style="display:inline-block" width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M0 10L7.08333 5L0 0V10ZM8.33333 0V10H10V0H8.33333Z" fill="white"/> </svg> ');else{var t=ac.template('<div class="_cm-skip-ad-border"> <div class="_cm-skip-ad-text">{{skipAdText}}</div> <div class="_cm-skip-ad-icon"> <svg width="14" height="12" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 200"> <line x1="2" y1="2" x2="98" y2="110" style="stroke:#fffefd;stroke-width:40"/> <line x1="2" y1="198" x2="98" y2="90" style="stroke:#fffefd;stroke-width:40"/> Sorry, your browser does not support inline SVG. </svg> </div> </div> ')(this._settings);this.$el.append(t),this.el.classList.add("_cm-skip-ad-area"),this.el.id="_cm-skip-ad-area"}this.container.appendChild(this.el)}},_bindEvents:function(){},_onClick:function(t){t.stopPropagation(),this.model.increaseCounter("skipButtonClicked")},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),i(9288)),cc=(i(1999),lc.View.extend({className:"video_controls show",id:"video_controls",initialize:function(t){this.log=new r.Z({unitType:t.unitType,className:"progressBarView",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),this.model=t.model,this.container=t.container,this.video=t.video,this._bindEvents(),this.render()},_bindEvents:function(){this.video.addEventListener("ended",this.resetProgress.bind(this)),this.model.listenTo(this.model,"change:mute",this.muteChanged.bind(this)),this.model.listenTo(this.model,"change:content.startProgressBar",this.ManageProgressBarInterval.bind(this))},render:function(){this.container.appendChild(this.el),this.$el.append('<div class="video_controls video_controls_main_area"> <div class="cm_video_controls_progressbar_area"> <div class="cm_video_controls_progressbar_bg white_bg"></div> <div class="cm_video_controls_progressbar blue_bg"></div> </div> <div class="cm_video_controls_mute interactive"> <div class="cm_video_controls_volume display_mute"></div> <div class="cm_video_controls_volume display_unmute"></div> </div> <div class="cm_video_controls_playpause interactive show"> <div class="pause show"></div> <div class="play hide"></div> </div> </div> '),this.setControls(),this.show()},setControls:function(){this.setProgressBarComponent(),this.setPlayPauseButton(),this.setMuteButton()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},setProgressPercent:function(t){this.progressDiv.style.width=t+"%"},resetProgress:function(){this.progressDiv.classList.add("init_bg"),this.setProgressPercent(0)},playClicked:function(){this.model.set("content.playClicked",!0),this.model.set("content.pauseClicked",!1),this.pauseButton.classList.add("show"),this.pauseButton.classList.remove("hide"),this.playButton.classList.remove("show"),this.playButton.classList.add("hide")},pauseClicked:function(){this.model.set("content.pauseClicked",!0),this.playButton.classList.add("show"),this.playButton.classList.remove("hide"),this.pauseButton.classList.remove("show"),this.pauseButton.classList.add("hide")},muteClicked:function(){this.model.get("mute")?this.unMute():this.mute()},muteChanged:function(){this.model.get("mute")?this.setMuteClasses():this.setUnMuteClasses()},mute:function(){this.model.set("mute",!0),this.setMuteClasses()},unMute:function(){this.model.set("mute",!1),this.setUnMuteClasses()},setMuteClasses:function(){this.muteImg.style.display="block",this.unmuteImg.style.display="none"},setUnMuteClasses:function(){this.muteImg.style.display="none",this.unmuteImg.style.display="block"},setProgressBarComponent:function(){this.progressDiv=this.$el.find(".blue_bg")[0],this.progressComponentDiv=this.$el.find(".cm_video_controls_progressbar_area")[0],this.model.get("components.contentVideo.hideProgressBar")&&(this.progressComponentDiv.style.display="none"),this.resetProgress()},setMuteButton:function(){this.muteButton=this.$el.find(".cm_video_controls_mute").get(0),this.model.get("components.contentVideo.hideMuteButton")&&(this.muteButton.style.display="none"),this.muteImg=this.$el.find(".cm_video_controls_mute .display_mute").get(0),this.unmuteImg=this.$el.find(".cm_video_controls_mute .display_unmute").get(0),this.muteImg.style.backgroundImage='url("'.concat(this.model.get("components.contentVideo.muteImgUrl"),'")'),this.unmuteImg.style.backgroundImage='url("'.concat(this.model.get("components.contentVideo.unmuteImgUrl"),'")'),this.muteButton.onclick=this.muteClicked.bind(this),this.muteChanged()},setPlayPauseButton:function(){this.playButton=this.$el.find(".play")[0],this.pauseButton=this.$el.find(".pause")[0],this.pauseButton.style.backgroundImage='url("'.concat(this.model.get("components.contentVideo.pauseImgUrl"),'")'),this.model.get("components.contentVideo.hidePlayButton")&&(this.pauseButton.classList.remove("show"),this.pauseButton.classList.add("hide")),this.playButton.onclick=this.playClicked.bind(this),this.pauseButton.onclick=this.pauseClicked.bind(this)},ManageProgressBarInterval:function(){this.model.get("content.startProgressBar")?this.progressInterval=setInterval(this.setProgress.bind(this),100):this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=null)},setProgress:function(){this.setProgressPercent(this.video.currentTime/this.video.duration*100)}}),i(9288)),uc=i(1999),dc=cc.View.extend({className:"_cm-ad-loading-progress",id:"_cm-css-reset",initialize:function(t){t.isActive&&(this.model=t.model,this.container=t.container,this._setInitialParameters(t),this._bindEvents(),this.render(),this._startWatchingViewPort(),this.log.info("ad-loading-progress initialize"))},_bindEvents:function(){this.log.info("ad-loading-progress _bindEvents"),this.listenToOnce(this.model,"change:hasReadyAd",this.close.bind(this)),this.listenTo(this.model,"change:ProgressLoaderRepositioned",this._restart.bind(this))},_setInitialParameters:function(t){this.log=new r.Z({unitType:this.model.get("unitType"),className:"adLoadingProgressView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.globalModel=t.globalModel||this.model,this.globalModel.set("progressLoaderInit",!0),this.$el=(0,_.default)(this.el),this.viewPercent=this.model.get("components.adLoadingProgress.inViewPortEligibility")||100,this.loadingTimerTime=Number(this.model.get("components.adLoadingProgress.maxProgressTime"))||5e3,this.count=1,this.globalModel.set("loaderCurrCount",this.count),this.progressTik=this.loadingTimerTime/100,this.showProgress=this.model.get("components.adLoadingProgress.showProgressBar")},render:function(){this._initTemplate(),this._customize(),this._renderComponent(),this._show()},_initTemplate:function(){var t=uc.template(nc)(this._settings);this.$el.append(t),this.$loadingPercentElement=(0,_.default)("._cm-ad-loading-progress_percent_span")},_customize:function(){var t=this.model.get("components.adLoadingProgress.additionalCss");this.$el.css(uc.toCssObj(t))},_renderComponent:function(){var t={width:this.model.get("width")+"px",height:this.model.get("height")+"px"};this.$el.css(t),(0,_.default)(this.container).append(this.el),(0,_.default)("._cm-ad-loading-progress_title_span").text(this.model.get("components.adLoadingProgress.title")),this.showProgress&&(0,_.default)("._cm-ad-loading-progress-container").css({display:"block"})},_startWatchingViewPort:function(){this.listenTo(cc,"window:scroll:change",this._calculateViewPortIntersection.bind(this,!1)),this._calculateViewPortIntersection()},_calculateViewPortIntersection:function(){var t=uc.getViewPercent(this.el,this.$el.width(),this.$el.height(),this.model.get("scrollSelector"));!this.calculationRunning&&this.viewPercent<=t&&this._startLoadingTimer(),this.calculationRunning&&!t&&this.el.getBoundingClientRect().top<0&&this._stopCalculation()},_startLoadingTimer:function(){this.loadingTimer=window.setTimeout(function(){this._stopCalculation()}.bind(this),this.loadingTimerTime),this._startCalculation()},_startCalculation:function(){this.calculationRunning=!0,this.calculationInterval=window.setInterval(function(){this._calculateLoadingProgress()}.bind(this),this.progressTik),(0,_.default)("._cm-ad-loading-progress-bar-loaded").css({width:"100%",transition:"width "+this.loadingTimerTime+"ms","transition-timing-function":"linear"})},_stopLoadingTimer:function(){this.loadingTimer&&clearTimeout(this.loadingTimer)},_stopCalculation:function(){this.calculationRunning=!1,this.globalModel.set("progressLoaderTimerReached",!0),window.clearInterval(this.calculationInterval),this.calculationInterval=null},_calculateLoadingProgress:function(){(0,_.default)("._cm-ad-loading-progress_percent_span").text(this.count+"%"),this.count<100&&(this.count+=1,this.globalModel.set("loaderCurrCount",this.count))},_restart:function(){this._stopLoadingTimer(),this.globalModel.set("progressLoaderTimerReached",!1),this.model.get("ProgressLoaderRepositioned")&&((0,_.default)("._cm-ad-loading-progress_percent_span").text("1%"),this.count=1,(0,_.default)("._cm-ad-loading-progress-bar-loaded").css({transition:"none",width:"0%"}),this.calculationRunning=!1,this.model.set("ProgressLoaderRepositioned",!1))},_show:function(){this.$el.css({display:"flex"}),this.model.set("isProgressLoaderViewRunning",!0)},_hide:function(){this.$el.css({display:"none"})},close:function(){this.log.info("close loader"),this.model.set("isProgressLoaderViewRunning",!1),this.globalModel.set("progressLoaderViewClosed",!0),this._hide(),window.clearInterval(this.calculationInterval),this.calculationInterval=null,this.loadingTimer&&(window.clearTimeout(this.loadingTimer),this.loadingTimer=null),this.stopListening(cc,"window:scroll:change"),this.model.set("components.adLoadingProgress.isActive",!1)}}),hc=i(9288),fc=i(1999);hc.View.extend({className:"_cm-click-blocker-container",initialize:function(t){this.options=t,this.model=t.model,this.log=new r.Z({unitType:t.unitType,className:"clickBlockerView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=t.container,this.render()},render:function(){this.template=fc.template('<div class="_cm-click-blocker _cm-click-blocker-top"></div> <div class="_cm-click-blocker _cm-click-blocker-bottom"></div> <div class="_cm-click-blocker _cm-click-blocker-left"></div> <div class="_cm-click-blocker _cm-click-blocker-right"></div> '),this.$el.append(this.template(this.options)),this.SetClickBlockerDivStyle(),this.options.style&&this.$el.css(this.options.style),this.container.appendChild(this.el)},SetClickBlockerDivStyle:function(){var t=this;this.containerDimentions=this.container.getBoundingClientRect();var e=this.$el.children();e.forEach((function(e){return t.setBasicBlockerDivStyle(e)}));var i=this.model.get("components.ClickBlocker.blockPercent.vertical"),n=this.model.get("components.ClickBlocker.blockPercent.horizontal");e[0].style.height=this.containerDimentions.height*i+"px",e[1].style.height=this.containerDimentions.height*i+"px",e[2].style.width=this.containerDimentions.width*n+"px",e[3].style.width=this.containerDimentions.width*n+"px"},setBasicBlockerDivStyle:function(t){t.style.width=this.containerDimentions.width+"px",t.style.height=this.containerDimentions.height+"px"}});function pc(t){return pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pc(t)}function mc(t,e,i){return(e=gc(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function yc(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gc(n.key),n)}}function gc(t){var e=function(t,e){if("object"!==pc(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==pc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===pc(e)?e:String(e)}function vc(t,e){return vc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},vc(t,e)}function bc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=_c(t);if(e){var r=_c(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===pc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function _c(t){return _c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_c(t)}var Sc=i(1999),wc="_cm-native-ad",Tc={title:"._cm-native-ad-title",ctaButtone:"._cm-native-ad-cta-button",description:"._cm-native-ad-description",icon:"._cm-native-ad-icon",branding:"._cm-native-ad-branding",adChoice:"._cm-ad-choice",placeholder:"._cm-feed-manager-video-placeHolder",wrapper:"._cm-native-ad-bottom"},Pc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vc(t,e)}(a,t);var i,n,o,s=bc(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t)).model=t.model,e.globalModel=t.globalModel,e.shouldHideBrandingText=t.shouldHideBrandingText||!1,e.shouldFitToSize=t.shouldFitToSize||!1,e.sendNasOpp=t.sendNasOpp||!1,e.elasticLogger=e.model.get("elasticLogger"),e.isMultiFloatingNASElements=t.isMultiFloatingNASElements||!1,t.additionalCss&&e._addAdditionalCss(t.additionalCss),e.log=new r.Z({unitType:e.model.get("unitType"),className:constructor.name,version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.template=e._isTitleOnTop()?'<div class="_cm-native-ad-top"> <div class="_cm-native-ad-title" data-click-name="adTitleClick"></div> <div class="_cm-native-ad-cta-wrapper"> <div class="_cm-native-ad-cta-button" data-click-name="adCtaButtonClick"></div> </div> <div class="_cm-native-ad-description" data-click-name="adDescriptionClick"></div> <div class="_cm-native-ad-icon"></div> <div class="_cm-native-ad-branding" data-click-name="adBrandingClick"></div> <div class="_cm-ad-choice"></div> </div> ':'<div class="_cm-native-ad-bottom"> <div class="_cm-native-ad-title" data-click-name="adTitleClick"></div> <div class="_cm-native-ad-cta-wrapper"> <div class="_cm-native-ad-cta-button" data-click-name="adCtaButtonClick"></div> </div> <div class="_cm-native-ad-description" data-click-name="adDescriptionClick"></div> <div class="_cm-native-ad-icon"></div> <div class="_cm-native-ad-branding" data-click-name="adBrandingClick"></div> <div class="_cm-ad-choice"></div> </div> ',e.container=(0,_.default)(t.container),e.nativeAdMapping=e.globalModel.get("nativeAdMapping"),(e.model.get("stickyCard.isActive")||!e.model.get("detachToSlider.isStartFromSlider")&&!e.model.get("detachToSlider.isDetachToSlider"))&&(e.isSticky=!0,e._setToModel("floatingNAS.isActive",!1)),e.model.get("isPreviewAdSettings")&&(window.setPreviewAdSettings=function(t){var i,n=t.title,r=t.description,o=t.branding;e.model.set("adNativeSettings",(mc(i={},e.nativeAdMapping.title,n),mc(i,e.nativeAdMapping.description,r),mc(i,e.nativeAdMapping.branding,o),i)),e._updateAdData()}),e.bindEvents(),e}return i=a,n=[{key:"_setToModel",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.model.set(t,e,i),this.globalModel&&this.globalModel.set(t,e,i)}},{key:"_render",value:function(){this.renderTemplate(),this._adjustRTL(),this._adjustToDarkMode(),this.$el.addClass(wc),this.container.append(this.$el),this._addAdChoiceTitle(),this.rendered=!0}},{key:"_adjustRTL",value:function(){var t=this._getCssFromSelector(this.model.get("rboxCssSelectors.title"));t&&"rtl"===t.direction&&(this.ui.wrapper.css({"flex-direction":"row-reverse",direction:"ltr"}),this.ui.icon.addClass("_cm-native-ad-icon-rtl").removeClass("_cm-native-ad-icon"))}},{key:"_adjustToDarkMode",value:function(){this.model.get("adjustToDarkMode.isActive")&&(this._logToElasticLogger("adjust to dark mode"),this.ui.wrapper.css({"background-color":"unset !important"}))}},{key:"_logToElasticLogger",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mn,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.elasticLogger&&t&&this.elasticLogger.log({message:t,severity:e,extraData:i})}},{key:"bindEvents",value:function(){this.createStateHandlers([{event:"adNativeSettings",funcName:"_updateAdData"},{event:"repeatState:".concat(ct.repeatState.hiding),funcName:"show"},{event:"loadingViewState:".concat(ct.loadingViewState.hiding),funcName:"show"},{event:"floatingView:".concat(ct.floatingView.detach),funcName:"detach"},{event:"floatingView:".concat(ct.floatingView.attach),funcName:"attach"},{event:"floatingView:".concat(ct.floatingView.postAttach),funcName:"postAttach"},{event:"floatingView:".concat(ct.floatingView.permanentClosed),funcName:"permanentClosed"}])}},{key:"_updateAdData",value:function(){this.rendered||this._render(),this.adNativeSettings=this.model.get("adNativeSettings"),this._displayTitleOnTop(),this._setRandomTitle(),this._handleBranding(),this.isClickable=this.adNativeSettings.isClickable;var t=this.model.get("rboxCssSelectors.title");this._updateContainerViewTitleVisibility(),this._adjustDescFontToTitleFont(t),this._updateTitleContainerEl(this.ui.ctaButtone,this.adNativeSettings[this.nativeAdMapping.ctaButtone],"",this.model.get("customization.cta")),this._updateTitleContainerEl(this.ui.title,this.adNativeSettings[this.nativeAdMapping.title],t,this.model.get("customization.title")),this._updateTitleContainerEl(this.ui.description,this.adNativeSettings[this.nativeAdMapping.description],this.model.get("rboxCssSelectors.description"),this.model.get("customization.description")),this._updateTitleContainerEl(this.ui.branding,this.adNativeSettings[this.nativeAdMapping.branding],this.model.get("rboxCssSelectors.branding"),this.model.get("customization.branding")),this._updateIcon(this.adNativeSettings[this.nativeAdMapping.icon]),this._createFloatingNAS(),this._adjustRTLByLanguage(),this._isSuperSlider()?this.hide():this.show(),this._fitToSize(),this._checkSendNasOpp(),this.adDataUpdated=!0,this.model.trigger("nativeAdSettingsUpdated")}},{key:"_adjustRTLByLanguage",value:function(){if(Sc.isLanguageRTL(this.model)){var t={"text-align":"right",direction:"rtl"};this.ui.title.css(t),this.ui.description.css(t),this.ui.branding.css(t),this.ui.wrapper.css(t)}}},{key:"_checkSendNasOpp",value:function(){this.sendNasOpp&&(this.detached?this.model.trigger("displayingNASTitleOnly"):this.model.trigger("displayingFullNAS"))}},{key:"_setRandomTitle",value:function(){this.model.get("getRandomNativeAdTitle")&&!this.adNativeSettings[this.nativeAdMapping.title]&&(this.adNativeSettings[this.nativeAdMapping.title]=Sc.getRandomFromList(this.model.get("randomTitlesList")))}},{key:"_displayTitleOnTop",value:function(){var t=this;this._isTitleOnTop()&&(this.model.set("isTitleOnTop",!0),this.model.set("getRandomNativeAdTitle",!1),this._displayTitleOnly(),(0,_.default)(this.ui.title).css({"max-width":"340px"}),setTimeout((function(){return(0,_.default)(t.ui.title).css({"max-width":"225px"})}),2e3))}},{key:"_isTitleOnTop",value:function(){return this.model.get("unitType").indexOf("RECO_REEL_WIDGET")>-1&&this.model.get("frameType")===e().FRAME_TYPE.amp&&this.model.get("showTitleOnTop")}},{key:"_handleBranding",value:function(){this.shouldHideBrandingText&&(this.containerHeight=this.containerHeight||(0,_.default)("._cm-widget-item").height(),this.model.trigger("change:customization.titleContainer.branding.displayState",this._hasNASTitle()?ct.brandingDisplayState.hide:ct.brandingDisplayState.show))}},{key:"_fitToSize",value:function(){if(this.shouldFitToSize)if(this.hasNAS=this._hasNASTitle(),this.hasNAS){if(!this.detached){this.fitToSizeDisplaying=e().NATIVE_AD.FIT_TO_SIZE.NONE;var t=this.model.get("videoPlaceholderSize");this.containerHeight&&t&&(this._canFitTitleAndDescription(t)?this._canFitTitleOnly(t)?(this.fitToSizeDisplaying=e().NATIVE_AD.FIT_TO_SIZE.TITLE,this._displayTitleOnly(),this.model.trigger("displayingNASTitleOnly")):this.hide():(this.fitToSizeDisplaying=e().NATIVE_AD.FIT_TO_SIZE.FULL,this.show(),this.model.trigger("displayingFullNAS")))}}else this.hide()}},{key:"_canFitTitleAndDescription",value:function(t){return Number(t.height)+this.$el.height()>this.containerHeight}},{key:"_canFitTitleOnly",value:function(t){return Number(t.height)+this.ui.title.height()<this.containerHeight}},{key:"_displayTitleOnly",value:function(){this.ui.title.show(),this.ui.description.hide(),this.ui.ctaButtone.hide(),this.ui.branding.hide(),this.ui.icon.hide(),this.container.height(this.containerHeight)}},{key:"_isSuperSlider",value:function(){return this.model.get("detachToSlider.isStartFromSlider")&&this.model.get("detachToSlider.isDetachToSlider")&&-1===this.model.get("unitType").indexOf("MID_ARTICLE_SLIDER")}},{key:"_updateContainerViewTitleVisibility",value:function(){var t=this.adNativeSettings.title||this.adNativeSettings.ctatext||this.adNativeSettings.desc||this.adNativeSettings.sponsored,e=this.container.find("._cm-ad-title");t?(e.hide(),this.ui.adChoice.show()):(e.show(),this.ui.adChoice.hide())}},{key:"_adjustDescFontToTitleFont",value:function(t){var i=this.model.get("customization.description");if(!i)try{var n=parseInt(this._getCssFromSelector(t).fontSize);isNaN(n)||(i={},Sc.extend(i,{"font-size":n*e().NATIVE_AD.DESC_TITLE_FONT_RATIO+"px"}),this.model.set("customization.description",i))}catch(t){this.log.info("No title selector found - apply default values")}}},{key:"_updateTitleContainerEl",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;t.text(e),e?(this._applyCssFromSelector(t,i,n),t.show()):t===this.ui.ctaButtone&&t.hide(),this._updateTitleContainerClickability(t)}},{key:"_applyCssFromSelector",value:function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Sc.pick(this._getCssFromSelector(i),e().CSS_PROPERTIES_FROM_RBOX);Sc.extend(r,n),t.css(Sc.toCssObj(r))}},{key:"_getCssFromSelector",value:function(t){if(!t)return{};var e="string"==typeof t?document.querySelector(t):t;return e&&getComputedStyle(e)}},{key:"_updateTitleContainerClickability",value:function(t){this.isClickable?(t[0].onclick=this._onClick.bind(this),t.css({cursor:"pointer"}),t.attr("role","link")):(t[0].onclick=null,t.css({cursor:"default"}),t.removeAttr("role"))}},{key:"_onClick",value:function(t){var e=t.target.getAttribute("data-click-name");this.model.set("nativeAdClick",e,{silent:!0}),this.model.trigger("change:nativeAdClick",e)}},{key:"_updateIcon",value:function(t){t?(this.iconImg||this._createIconImg(),this.iconImg.src=t,this._updateTitleContainerClickability(this.ui.icon),this.ui.icon.show()):this.ui.icon.hide()}},{key:"_createIconImg",value:function(){this.iconImg=document.createElement("img"),this.iconImg.className="_cm-native-ad-icon-img",this.iconImg.setAttribute("data-click-name","adIconClick"),this.iconImg.addEventListener("error",this._onError.bind(this)),this.ui.icon.css(Sc.toCssObj(Sc.extend({},this.model.get("customization.icon")))),this.ui.icon.append(this.iconImg)}},{key:"_onError",value:function(){this.log.error("can't load native ad icon"),this.ui.icon.hide()}},{key:"_addAdChoiceTitle",value:function(){this.model.get("components.adChoice.isActive")&&this.model.get("components.adChoice.title.isActive")&&(this.adChoice=new Kl({model:this.model,container:this.ui.adChoice,parent:this.el,type:e().AD_CHOICE_TYPE.TITLE}))}},{key:"_addAdditionalCss",value:function(t){(0,_.default)(this.el).addClass(t)}},{key:"hide",value:function(){this.$el.hide()}},{key:"show",value:function(){this._isSuperSlider()||this.$el.show()}},{key:"_createFloatingNAS",value:function(){this.globalModel.get("floatingNAS.isActive")&&(this.hasNAS=this._hasNASTitle(),this.hasNAS&&(this.isMultiFloatingNASElements&&this._removePreviousFloatingNASElement(),this.ui.floatingNAS={},this._createFloatingNASWrapper(),this._createFloatingNASTitle(),this._appendFloatingNAS()))}},{key:"_removePreviousFloatingNASElement",value:function(){this.ui.floatingNAS&&this.ui.floatingNAS.wrapper&&this.ui.floatingNAS.wrapper.parentElement.removeChild(this.ui.floatingNAS.wrapper)}},{key:"_createFloatingNASWrapper",value:function(){this.ui.floatingNAS.wrapper=document.createElement("div"),this.ui.floatingNAS.wrapper.className="".concat(Tc.wrapper.replace(/^\./,"")," _cm-native-ad-bottom-floating"),this.shouldFitToSize&&!this.detached&&(0,_.default)(this.ui.floatingNAS.wrapper).addClass("hide"),this.ui.floatingNAS.wrapper.style.width=this.model.get("detachToSlider.width")+"px"}},{key:"_createFloatingNASTitle",value:function(){this.ui.floatingNAS.title=this.ui.title[0].cloneNode(!0),this.ui.floatingNAS.title.className+=" _cm-native-ad-title-floating"}},{key:"_appendFloatingNAS",value:function(){this.ui.floatingNAS.wrapper.appendChild(this.ui.floatingNAS.title),this._getActiveAd().appendChild(this.ui.floatingNAS.wrapper)}},{key:"_getActiveAd",value:function(){return document.getElementsByClassName("_cm-ad-active")[0]||this.container.get(0)}},{key:"_getFloatingView",value:function(){return document.getElementsByClassName("_cm-floating-view")[0]}},{key:"_hasNASTitle",value:function(){return"string"==typeof this.adNativeSettings[this.nativeAdMapping.title]}},{key:"detach",value:function(){this.isSticky||this.shouldFitToSize&&this.fitToSizeDisplaying===e().NATIVE_AD.FIT_TO_SIZE.NONE||(this.detached=!0,this.hasNAS&&(this.ui.floatingNAS.wrapper.style.width=this.model.get("detachToSlider.width")+"px",this.ui.floatingNAS.wrapper.className=this.ui.floatingNAS.wrapper.className.replace(" hide","")))}},{key:"attach",value:function(){this.isSticky||this.shouldFitToSize&&this.fitToSizeDisplaying===e().NATIVE_AD.FIT_TO_SIZE.NONE||this.hasNAS&&this.detached&&(this.ui.floatingNAS.wrapper.style.width=this.model.get("width")+"px")}},{key:"postAttach",value:function(){this.isSticky?this._displayFitToSizeNAS():this.shouldFitToSize&&this.fitToSizeDisplaying===e().NATIVE_AD.FIT_TO_SIZE.NONE||(this.hasNAS&&this.detached&&(this._handleActiveAdWithoutNAS(),this.ui.floatingNAS.wrapper.className+=" hide",this._displayFitToSizeNAS()),this.detached=!1)}},{key:"_displayFitToSizeNAS",value:function(){this.shouldFitToSize&&this.fitToSizeDisplaying!==e().NATIVE_AD.FIT_TO_SIZE.NONE&&(this.fitToSizeDisplaying===e().NATIVE_AD.FIT_TO_SIZE.TITLE?this._displayTitleOnly():this.fitToSizeDisplaying===e().NATIVE_AD.FIT_TO_SIZE.FULL&&this.show())}},{key:"triggerDetachIfRendered",value:function(){this.adDataUpdated&&this.model.trigger("nativeAdSettingsUpdated")}},{key:"getFloatingNASHeight",value:function(){return this.ui.floatingNAS&&this.ui.floatingNAS.wrapper?this.ui.floatingNAS.wrapper.getBoundingClientRect().height:0}},{key:"getNASHeight",value:function(){return this.shouldFitToSize&&this.fitToSizeDisplaying!==e().NATIVE_AD.FIT_TO_SIZE.NONE?this.fitToSizeDisplaying===e().NATIVE_AD.FIT_TO_SIZE.TITLE?this.ui.title.height():this.$el.height():0}},{key:"onAdComplete",value:function(){this.prevAdNAS=this.hasNAS,this.adDataUpdated=!1,this.hasNAS&&this.detached&&this._isSuperSlider()&&this._handleActiveAdWithoutNAS()}},{key:"onAdDisplayChange",value:function(){if(this.hasNAS&&this.detached){if(this.prevAdNAS&&this._isSuperSlider())return;this._handleFloatingViewWithNAS(),this._isSuperSlider()&&this._handleActiveAdWithNAS()}}},{key:"onAdSwapped",value:function(){this.hasNAS=this._hasNASTitle()||this._isActiveAdContainNAS(),this.detached&&this.hasNAS!==this.prevAdNAS&&(this.hasNAS?this._handleFloatingViewWithNAS():this._handleActiveAdWithNAS()),this.adDataUpdated=!0,this.prevAdNAS=this.hasNAS}},{key:"_handleFloatingViewWithNAS",value:function(){var t=this._getFloatingView();t&&(t.style.bottom=parseInt(t.style.bottom)+this.getFloatingNASHeight()+"px")}},{key:"_handleActiveAdWithNAS",value:function(){var t=this._getActiveAd();t&&(t.style.height=parseInt(t.style.height)+this.getFloatingNASHeight()+"px")}},{key:"_handleActiveAdWithoutNAS",value:function(){var t=this._getActiveAd();if(t){var e=parseInt(t.style.height);e>this.model.get("videoPlaceholderSize").height&&(t.style.height=e-this.getFloatingNASHeight()+"px")}}},{key:"_isActiveAdContainNAS",value:function(){var t=this._getActiveAd();return!!t&&t.getElementsByClassName("_cm-native-ad-bottom-floating").length>0}},{key:"permanentClosed",value:function(){this._isSuperSlider()&&this.hide()}},{key:"hideFloatingNAS",value:function(){this.detached&&this.ui.floatingNAS&&(0,_.default)(this.ui.floatingNAS.wrapper).addClass("hide")}},{key:"showFloatingNAS",value:function(){this.detached&&this.ui.floatingNAS&&(0,_.default)(this.ui.floatingNAS.wrapper).removeClass("hide")}},{key:"className",get:function(){return wc}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=Tc},set:function(t){return this.UI=t}}],n&&yc(i.prototype,n),o&&yc(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.s),Ac=Pc;i(1999);var Ec=i(9288),Oc=i(1999),Cc=Ec.View.extend({className:"_cm-content-carousel-item",events:{"click ":"_onClick"},initialize:function(t){this.model=t.model,this.log=new r.Z({unitType:t.unitType,className:"ContentCarouselItemView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.itemId=t.itemId,this.container=t.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=ga.L,(0,_.default)(this.container).append(this.$el),this._setInfo(),this.render()},render:function(){if(!this._rendered){var t=Oc.template('<img src="{{image}}" height="70" width="120" class="_cm-content-carousel-item-image"/> <div class="_cm-content-carousel-item-description {{selected}}">{{title}}</div> <div class="_cm-content-carousel-item-play-icon {{selected}}"> <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM6 12V4L11.5 8L6 12Z" fill="white"/> </svg> </div> <div class="_cm-content-carousel-item-playing-now {{selected}}"> {{playingNowString}} </div> ')(this.itemInfo);this.$el.append(t),this.imageNode=this.$el.find("._cm-content-carousel-item-image"),this.imageNode.css({"background-image":' url("'.concat(this.model.get("components.contentCarousel.backgroundImage"),'")')})}},_bindEvents:function(){},_onClick:function(){this.itemInfo.selected||this.model.set("playlistItemClicked",this.itemId)},_setInfo:function(){this.itemInfo=this.model.get("player.playlist")[this._getItemIndex()],this.itemInfo.description=this.itemInfo.title.replace(/-/g," "),this.itemInfo.playingNowString=this.model.get("playingNowString"),this.updateSelected()},updateSelected:function(){this.itemInfo.selected=this.model.get("player.playlist")[this._getItemIndex()].selected,(0,_.default)(this.$el).removeClass("true"),(0,_.default)(this.$el).removeClass("false"),(0,_.default)(this.$el).addClass(this.itemInfo.selected.toString())},_getItemIndex:function(){for(var t=this.model.get("player.playlist"),e=0,i=0;i<t.length;i++)if(t[i].id===this.itemId){e=i;break}return e}}),kc=i(9288);i(1999),kc.View.extend({className:"_cm-content-carousel-area",id:"_cm-content-carousel-area",initialize:function(t){this.log=new r.Z({unitType:t.unitType,className:"ContentCarouselView",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),this.container=t.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=ga.L,this.componentsVisibilityListener=t.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener(),(0,_.default)(this.container).append(this.$el)},render:function(){this._rendered?this.updatePlaylistItem():(this._rendered=!0,this.$el.append('<div class="_cm-content-carousel-items-container-wrapper"> <div class="_cm-content-carousel-items-container"></div> </div> <div class="_cm-content-carousel-arrows"> <div class="_cm-content-carousel-arrow _cm-content-carousel-arrow-left"> <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M0.999999 12L7 6.5L0.999999 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" transform="rotate(-180 4,6.5) "/> </svg> </div> <div class="_cm-content-carousel-arrow _cm-content-carousel-arrow-right"> <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M0.999999 12L7 6.5L0.999999 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/> </svg> </div> </div> <div class="_cm-content-carousel-blocker"></div> '),this.listContainer=this.$el.find("._cm-content-carousel-items-container"),this.blockDiv=this.$el.find("._cm-content-carousel-blocker"),this.scrollElement=document.querySelector("div._cm-content-carousel-items-container-wrapper"),this.listItemsArray=[],this.unBlockView(),this._createListItems(),this._setScrollButtons())},_createListItems:function(){for(var t=this.model.get("player.playlist"),e=0;e<t.length;e++)t[e].id=e,t[e].selected=!1;this.model.set("player.playlist",t);for(var i=0;i<t.length;i++){var n=new Cc({model:this.model,container:this.listContainer,itemId:i});this.listItemsArray.push(n)}},_bindEvents:function(){},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},_setScrollButtons:function(){var t=this.$el.find("._cm-content-carousel-arrow-left"),e=this.$el.find("._cm-content-carousel-arrow-right");t.on("click",this._scrollLeft.bind(this)),e.on("click",this._scrollRight.bind(this))},_scrollLeft:function(){this.scrollElement.scrollBy(-100,0)},_scrollRight:function(){this.scrollElement.scrollBy(100,0)},hide:function(){this.$el.hide()},show:function(){this.$el.show()},blockView:function(){this.blockDiv.css({display:"block"})},unBlockView:function(){this.blockDiv.css({display:"none"})},updatePlaylistItem:function(){for(var t=0;t<this.listItemsArray.length;t++)this.listItemsArray[t].updateSelected()}});function Ic(t){return Ic="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ic(t)}function Rc(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Ic(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Ic(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Ic(o)?o:String(o)),n)}var r,o}function Dc(t,e){return Dc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Dc(t,e)}function Vc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Nc(t);if(e){var r=Nc(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Ic(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Nc(t){return Nc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nc(t)}var xc=i(1999),jc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Dc(t,e)}(a,t);var i,n,o,s=Vc(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this)).model=t.model,e.log=new r.Z({unitType:e.model.get("unitType"),className:e.constructor.name,version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.components={},e.container=t.container,e.componentsConfig={},e.baseOptions={model:e.model,container:e.container},e.animationUtil=rl(e.model),e}return i=a,(n=[{key:"_bindEvents",value:function(){}},{key:"_initComponents",value:function(){var t=this._getActiveComponentsInitialVisibility();this._loadActiveComponents(t),this.model.set("componentVisibility",t)}},{key:"_loadActiveComponents",value:function(t){for(var e in t){var i={componentsVisibilityListener:"componentVisibility.".concat(e)},n=xc.extend(this.componentsConfig[e].options,i);this.components[e]=this._loadComponent(this.componentsConfig[e].module,n),this.componentsConfig[e].afterLoad&&this.componentsConfig[e].afterLoad()}}},{key:"_getActiveComponentsInitialVisibility",value:function(){var t={};for(var e in this.componentsConfig)this.componentsConfig[e].isActive&&(t[e]=this.componentsConfig[e].isVisibleOnLoad);return t}},{key:"_showActiveComponents",value:function(){for(var t in this.componentsConfig)this.componentsConfig[t].isActive&&this.model.set("componentVisibility.".concat(t),this.componentsConfig[t].isVisibleOnLoad)}},{key:"_hideActiveComponents",value:function(){for(var t in this.componentsConfig)this.componentsConfig[t].isActive&&this.model.set("componentVisibility.".concat(t),!1)}},{key:"_loadComponent",value:function(t,e){if(t)return new t(e);this.log.error("can't load component - component is undefined")}},{key:"detach",value:function(t,i){this.currentAnimation=e().ANIMATION_TYPE.detaching;var n=i?0:this.model.get("animation.detach");this.animationUtil.detach({$el:t,timeMS:n,sliderOptions:this.detachToSlider,isSlideIn:this.isFirstDetach,cb:this.postDetach.bind(this)}),t.css(this.model.get("additionalCss"))}},{key:"postDetach",value:function(){this.currentAnimation===e().ANIMATION_TYPE.detaching&&(this.currentAnimation=e().ANIMATION_TYPE.none)}},{key:"attach",value:function(t,i,n){var r=this.model.get("animation.attach"),o=!n&&this.model.get("detachToSlider").animation;this.currentAnimation=e().ANIMATION_TYPE.attaching,this.animationUtil.attach({$el:t,target:i,isAnimated:o,timeMS:r,additionalCss:this.model.get("additionalCss"),cb:this.postAttach.bind(this)})}},{key:"postAttach",value:function(){this.currentAnimation===e().ANIMATION_TYPE.attaching&&(this.currentAnimation=e().ANIMATION_TYPE.none)}},{key:"slideOut",value:function(t,e,i){var n=this.model.get("animation.slideOut");this.animationUtil.slideOut({$el:t,timeMS:n,sliderOptions:this.detachToSlider,isVerticalSlideOut:e,cb:i})}}])&&Rc(i.prototype,n),o&&Rc(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.O),Mc=jc;function Lc(t){return Lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lc(t)}function Bc(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==Lc(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Lc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Lc(o)?o:String(o)),n)}var r,o}function Fc(t,e){return Fc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Fc(t,e)}function Uc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Wc(t);if(e){var r=Wc(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===Lc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function Wc(t){return Wc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wc(t)}var Hc=i(1999),$c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fc(t,e)}(a,t);var i,n,o,s=Uc(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t)).model=t.model,e.log=new r.Z({unitType:e.model.get("unitType"),className:e.constructor.name,version:e.model.get("version"),isDebug:e.model.get("isDebug")}),e.init(),e._bindEvents(),e}return i=a,(n=[{key:"init",value:function(){this.componentsConfig=this._getComponentConfiguration(),this._initComponents()}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adState:playing",funcName:"initLoadingView",isListenOnce:!0},{event:"renderWasCalled:true",funcName:"initBrandingTitle",isListenOnce:!0},{event:"swappedAdHasEnded:true",funcName:"onSwappedAdHasEnded"}])}},{key:"_getComponentConfiguration",value:function(){return{CloseButtonView:{module:_l,options:this.baseOptions,isActive:this.isCloseButtonViewActive(),isVisibleOnLoad:!0},AdChoiceView:{module:Kl,options:Hc.extend({},this.baseOptions,{type:e().AD_CHOICE_TYPE.VIDEO_AD}),isActive:this.isAdChoiceActive(),isVisibleOnLoad:!0},VolumeButtonView:{module:ic,options:this.baseOptions,isActive:this.model.get("components.volume.isActive"),isVisibleOnLoad:!0},NativeAdView:{module:Ac,isActive:this.model.get("components.nativeAd.isActive"),options:{model:this.model,globalModel:this.model,container:"._cm-video",shouldHideBrandingText:!0,shouldFitToSize:!0,additionalCss:"_cm-native-ad-widget",isMultiFloatingNASElements:!0}}}}},{key:"isCloseButtonViewActive",value:function(){var t=Hc.parseBool(this.model.get("components.CloseButtonView.hasCloseButton")),e=Hc.parseBool(this.model.get("closeButton.hasCloseButton"));return t||e}},{key:"isAdChoiceActive",value:function(){return this.model.get("components.adChoice.isActive")&&this.model.get("components.adChoice.videoAd.isActive")}},{key:"initLoadingView",value:function(){this.model.get("isMultiAd")?this.loadingView=new Cl(Hc.extend({},this.baseOptions,{container:this.container.parentElement})):this.loadingView=new Bl(this.baseOptions)}},{key:"initLoaderView",value:function(){this.model.set("components.adLoadingProgress.additionalCss.top","0px"),this.model.set("components.adLoadingProgress.additionalCss.left","0px");var t=Hc.extend({},this.baseOptions,{isActive:this.model.get("isStartWithLoader"),container:this.model.get("containerViewPlaceHolder")});this.loaderView=new dc(t)}},{key:"initBrandingTitle",value:function(){var t=Hc.extend({},this.baseOptions,{isActive:!0,container:this.model.get("containerViewPlaceHolder").parentElement});this.brandingTitleView=new zl(t)}},{key:"onSwappedAdHasEnded",value:function(){var t=this;setTimeout((function(){return t.loadingView.hide()}),0),this.model.set("swappedAdHasEnded",!1,{silent:!0})}}])&&Bc(i.prototype,n),o&&Bc(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(Mc),zc=$c;function qc(t){return qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qc(t)}function Gc(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(t,e){if("object"!==qc(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==qc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===qc(o)?o:String(o)),n)}var r,o}function Yc(t,e){return Yc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yc(t,e)}function Kc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Zc(t);if(e){var r=Zc(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"===qc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Qc(t)}(this,i)}}function Qc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zc(t){return Zc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zc(t)}var Xc=i(1999),Jc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yc(t,e)}(o,t);var e,i,n,r=Kc(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).model.set("renderWasCalled",!1),e.createStateHandlers([{event:"playerState:ready",funcName:"_onPlayerStateReady"},{event:"playerState:restarted",funcName:"_onPlayerStateReady"},{event:["isEligibleToPlay:true","isHipMode:false"],funcName:"_dropAdjacentAds",isListenOnce:!0},{event:"hasReadyAd:true",funcName:"sendWidgetReadyEvent",isListenOnce:!0}]),e.windowEventManager=xs(),e.tabStatusService=new go(e.model),e.eligibilityService=new Ur(e.model),e.adService=new lo(e.model,e.eligibilityService),e.model.get("isHipMode")&&(e._bindHipEvents(),e._locAdjacMode()),e.seerService=new Ln({model:e.model,onPredictCallback:e.adService.adPredict.bind(e.adService)}),e.playerQueueSeeker=new rr(e.model),e._registerListeners(),e.playerLoader=new qr(e.model),e.containerView=new ya({model:e.model}),e.videoView=new fl({model:e.model,container:e.model.get("videoContainerSelector"),eligibilityService:e.eligibilityService}),e.playerService=new Sr(e.model),e.pixelsService=new Qn(e.model),e._initComponentsManager(),e._timeBetweenEvents=100;var i=e.model.get("observedContainerSelector");return i&&(0,_.default)(i)[0]&&e._setMutationObserver((0,_.default)(i)[0]),e._setSubUnitType(),TRC.listen("widgetTakeoverSizeChange",e.updateContainerSize.bind(Qc(e))),e.model.get("isHip")&&!e.model.get("isAdjacInFirstWF")&&(e.model.set("noAdjacInFirstWFs",!0),TRC.trcHipCloseUnit&&TRC.trcHipCloseUnit[e.model.get("rboxContainerId")]&&e.terminate(!1,"SC adjacency")),e}return e=o,(i=[{key:"play",value:function(t){this.model.get("renderWasCalled")||(this.containerView.render(t),this.log.info("play was called with container: "+t),this.model.set("renderWasCalled",!0))}},{key:"terminate",value:function(t,e){if(t&&this.model.get("videoViewState")===ct.videoViewState.detached)this.videoView.permanentAttach();else{if(this.log.info("Terminate reason: "+e),this._setTimerReason(e),this.model.get("isKeepUnitOnMidroll")&&"midrollCollapse"===e)return void this._doNotStopOnMidroll();this.model.set("closeState",ct.closeState.terminate)}}},{key:"pause",value:function(t){this._setTimerReason(t),this.adService&&this.adService.pauseGetAds()}},{key:"_setMutationObserver",value:function(t){var e=Xc.throttle(this._handleMutationCb.bind(this),this._timeBetweenEvents);new MutationObserver(e).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0,attributeOldValue:!0})}},{key:"_handleMutationCb",value:function(t){this._trigger("publisher:dom:change",{})}},{key:"_trigger",value:function(t,e){w().trigger(t,e)}},{key:"_doNotStopOnMidroll",value:function(){this.model.get("isKeepViewOnMidroll")||(this.model.set("isUnitHidden",!0),this.videoView.hide(),this.containerView.hideUnit(),this.createStateHandlers([{event:"hasReadyAd:true",funcName:"_reopenUnit",isListenOnce:!0}]))}},{key:"_reopenUnit",value:function(){this.log.info("!!! reopenUnit isAnimationRunning: ",this.model.get("isAnimationRunning")),this.model.set("isUnitHidden",!1),this.model.get("isAnimationRunning")?this.createStateHandlers([{event:"isAnimationRunning:false",funcName:"_reopenUnit",isListenOnce:!0}]):(this.containerView.show(),this.videoView.reShowUnit())}},{key:"_initComponentsManager",value:function(){this.componentManager=new zc({model:this.model,container:this.model.get("videoViewContainer")}),this.componentManager.components&&this.componentManager.components.NativeAdView&&this.videoView.setNativeAdViewObj(this.componentManager.components.NativeAdView)}},{key:"updateContainerSize",value:function(t){this.model.set("width",t.width),this.model.set("customization",t.customization)}},{key:"_onAdjacentAdLoaded",value:function(t){!this.model.get("isStartWithLoader")||this.model.get("isViewable")||this.model.get("hadReady")?this.log.info("Loader not active or div is viewable right now, will wait for impression",t):(this.adTypeTranslator=new en.default({model:this.model}),t.adTypeConfig={},t.adTypeConfig.adjacency=this.adTypeTranslator.getConfigForKey(Xn().adjacency.name),t.adTypeConfig.singleAd=this.adTypeTranslator.getConfigForKey(Xn().singleAd.name),this.sendWidgetReadyEvent(t),this.componentManager.initLoaderView(),this._bindLoaderEvens(),this.isSkipAdjacencyAdsDrop=!0)}},{key:"_registerListeners",value:function(){this.adjacentAdListener=this.playerQueueSeeker.registerToPlayerQueueStatusChange({type:Xn().adjacency.name,typeValue:!0,status:"adLoaded",cb:this._onAdjacentAdLoaded.bind(this),isListenOnce:!0})}},{key:"_bindLoaderEvens",value:function(){this.createStateHandlers([{event:"progressLoaderTimerReached:true",funcName:"onLoadingProgressEnd",isListenOnce:!0}])}},{key:"onLoadingProgressEnd",value:function(){this.isSkipAdjacencyAdsDrop=!1,this._dropAdjacentAds()}},{key:"_dropAdjacentAds",value:function(){this.isSkipAdjacencyAdsDrop||this.model.set("dropAds",Xn().adjacency.name)}},{key:"sendWidgetReadyEvent",value:function(t){if(!this.model.get("hadReady")){var e=t||this.model.peekNextAd(),i=this._prepareDataForRbox(e);w().trigger("ready",i),this.model.set("hadReady",!0)}}},{key:"_prepareDataForRbox",value:function(t){if(t&&t.adTypeConfig){var e=t.adTypeConfig.adjacency;if(void 0===e)return{};var i=this.model.get("rboxContainerRatio"),n=this.model.get("maxValidRatioForTakeover"),r=this.model.get("minValidRatioForTakeover");return this.log.debug("rBox container ratio",i),i&&i>r&&i<n&&(e.isContainerRatioValidForTakeOver=!0),e}}},{key:"_setSubUnitType",value:function(){var t={isSticky:this.model.get("stickyCard.isActive"),isDetachBelow:this.model.get("detachToSlider.isDetachBelow"),isDetachAbove:this.model.get("detachToSlider.isDetachAbove"),isStartFromSlider:this.model.get("detachToSlider.isStartFromSlider"),isDetachToSlider:this.model.get("detachToSlider.isDetachToSlider")};this.model.set("subUnitType",Xc.getSubUnitType(t))}},{key:"_bindHipEvents",value:function(){"undefined"!=typeof TRC&&TRC.listen&&TRC.listen("rBoxVisible",this._stopHipMode.bind(this))}},{key:"_stopHipMode",value:function(){TRC.trcHipContainersShowing&&TRC.trcHipContainersShowing[this.get("rboxContainerId")]&&(this.model.set("dropAdjacDueHIP",!0),this.model.setPredictorsToNonHIP(),this.log.info("Stop Hip Mode Update Predictors"),this.seerService._createRequestedPredictors())}},{key:"_locAdjacMode",value:function(){this.log.info("Loc Adjac Mode");var t=this.model.get("rboxContainerId").split("_"),e=(0,_.default)(".tbl-invisible"),i=null;e.forEach((function(e){(0,_.default)(".trc_wrapper_".concat(t[1]),e)&&(i=e)})),i.classList.remove("tbl-invisible"),document.querySelector("#outer_".concat(t[1])).classList.add("tbl-invisible"),this.shoingAdjacAd=!0}}])&&Gc(e.prototype,i),n&&Gc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(ra),tu=Jc;window.startCMTagMain=function(t,e){var n={model:t.isMobile?i(2363).Z:i(5867).Z};n.unitController=tu,Ks(t,e,n,!0)}}()}();